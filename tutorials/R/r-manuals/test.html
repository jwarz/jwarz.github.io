<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Joschka Schwarz - R Manuals :: An Introduction to R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Joschka Schwarz</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-science" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Data Science</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-science">    
        <li>
    <a class="dropdown-item" href="../../../content/R/index.qmd" rel="" target="">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../content/python/index.qmd" rel="" target="">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../content/sql/index.qmd" rel="" target="">
 <span class="dropdown-text">SQL</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../slides/index.html" rel="" target="">
 <span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resumes/index.html" rel="" target="">
 <span class="menu-text">Resumes</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jwarz/" rel="" target=""><i class="bi bi-github" role="img" aria-label="Quarto GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/j-schwarz" rel="" target=""><i class="bi bi-linkedin" role="img" aria-label="Quarto LinkedIn">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#an-introduction-to-r" id="toc-an-introduction-to-r" class="nav-link active" data-scroll-target="#an-introduction-to-r">An Introduction to R</a></li>
  <li><a href="#preface" id="toc-preface" class="nav-link" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#sec-introduction-and-preliminaries" id="toc-sec-introduction-and-preliminaries" class="nav-link" data-scroll-target="#sec-introduction-and-preliminaries"><span class="header-section-number">1</span> Introduction and preliminaries</a>
  <ul class="collapse">
  <li><a href="#sec-the-r-environment" id="toc-sec-the-r-environment" class="nav-link" data-scroll-target="#sec-the-r-environment"><span class="header-section-number">1.1</span> The R environment</a></li>
  <li><a href="#sec-related-software-and-documentation" id="toc-sec-related-software-and-documentation" class="nav-link" data-scroll-target="#sec-related-software-and-documentation"><span class="header-section-number">1.2</span> Related software and documentation</a></li>
  <li><a href="#sec-r-and-statistics" id="toc-sec-r-and-statistics" class="nav-link" data-scroll-target="#sec-r-and-statistics"><span class="header-section-number">1.3</span> R and statistics</a></li>
  <li><a href="#sec-r-and-the-window-system" id="toc-sec-r-and-the-window-system" class="nav-link" data-scroll-target="#sec-r-and-the-window-system"><span class="header-section-number">1.4</span> R and the window system</a></li>
  <li><a href="#sec-using-r-interactively" id="toc-sec-using-r-interactively" class="nav-link" data-scroll-target="#sec-using-r-interactively"><span class="header-section-number">1.5</span> Using R interactively</a></li>
  <li><a href="#sec-1.6-an-introductory-session" id="toc-sec-1.6-an-introductory-session" class="nav-link" data-scroll-target="#sec-1.6-an-introductory-session"><span class="header-section-number">1.6</span> 1.6 An introductory session</a></li>
  <li><a href="#sec-getting-help-with-functions-and-features" id="toc-sec-getting-help-with-functions-and-features" class="nav-link" data-scroll-target="#sec-getting-help-with-functions-and-features"><span class="header-section-number">1.7</span> Getting help with functions and features</a></li>
  <li><a href="#sec-r-commands-case-sensitivity-etc." id="toc-sec-r-commands-case-sensitivity-etc." class="nav-link" data-scroll-target="#sec-r-commands-case-sensitivity-etc."><span class="header-section-number">1.8</span> R commands, case sensitivity, etc.</a></li>
  <li><a href="#sec-recall-and-correction-of-previous-commands" id="toc-sec-recall-and-correction-of-previous-commands" class="nav-link" data-scroll-target="#sec-recall-and-correction-of-previous-commands"><span class="header-section-number">1.9</span> Recall and correction of previous commands</a></li>
  <li><a href="#sec-executing-commands-from-or-diverting-output-to-a-file" id="toc-sec-executing-commands-from-or-diverting-output-to-a-file" class="nav-link" data-scroll-target="#sec-executing-commands-from-or-diverting-output-to-a-file"><span class="header-section-number">1.10</span> Executing commands from or diverting output to a file</a></li>
  <li><a href="#sec-data-permanency-and-removing-objects" id="toc-sec-data-permanency-and-removing-objects" class="nav-link" data-scroll-target="#sec-data-permanency-and-removing-objects"><span class="header-section-number">1.11</span> Data permanency and removing objects</a></li>
  </ul></li>
  <li><a href="#sec-simple-manipulations-numbers-and-vectors" id="toc-sec-simple-manipulations-numbers-and-vectors" class="nav-link" data-scroll-target="#sec-simple-manipulations-numbers-and-vectors"><span class="header-section-number">2</span> Simple manipulations; numbers and vectors</a>
  <ul class="collapse">
  <li><a href="#sec-vectors-and-assignment" id="toc-sec-vectors-and-assignment" class="nav-link" data-scroll-target="#sec-vectors-and-assignment"><span class="header-section-number">2.1</span> Vectors and assignment</a></li>
  <li><a href="#sec-vector-arithmetic" id="toc-sec-vector-arithmetic" class="nav-link" data-scroll-target="#sec-vector-arithmetic"><span class="header-section-number">2.2</span> Vector arithmetic</a></li>
  <li><a href="#sec-generating-regular-sequences" id="toc-sec-generating-regular-sequences" class="nav-link" data-scroll-target="#sec-generating-regular-sequences"><span class="header-section-number">2.3</span> Generating regular sequences</a></li>
  <li><a href="#sec-logical-vectors" id="toc-sec-logical-vectors" class="nav-link" data-scroll-target="#sec-logical-vectors"><span class="header-section-number">2.4</span> Logical vectors</a></li>
  <li><a href="#sec-missing-values" id="toc-sec-missing-values" class="nav-link" data-scroll-target="#sec-missing-values"><span class="header-section-number">2.5</span> Missing values</a></li>
  <li><a href="#sec-character-vectors" id="toc-sec-character-vectors" class="nav-link" data-scroll-target="#sec-character-vectors"><span class="header-section-number">2.6</span> Character vectors</a></li>
  <li><a href="#sec-index-vectors-selecting-and-modifying-subsets-of-a-data-set" id="toc-sec-index-vectors-selecting-and-modifying-subsets-of-a-data-set" class="nav-link" data-scroll-target="#sec-index-vectors-selecting-and-modifying-subsets-of-a-data-set"><span class="header-section-number">2.7</span> Index vectors; selecting and modifying subsets of a data set</a></li>
  <li><a href="#sec-other-types-of-objects" id="toc-sec-other-types-of-objects" class="nav-link" data-scroll-target="#sec-other-types-of-objects"><span class="header-section-number">2.8</span> Other types of objects</a></li>
  </ul></li>
  <li><a href="#sec-objects-their-modes-and-attributes" id="toc-sec-objects-their-modes-and-attributes" class="nav-link" data-scroll-target="#sec-objects-their-modes-and-attributes"><span class="header-section-number">3</span> Objects, their modes and attributes</a>
  <ul class="collapse">
  <li><a href="#sec-intrinsic-attributes:-mode-and-length" id="toc-sec-intrinsic-attributes:-mode-and-length" class="nav-link" data-scroll-target="#sec-intrinsic-attributes\:-mode-and-length"><span class="header-section-number">3.1</span> Intrinsic attributes: mode and length</a></li>
  <li><a href="#sec-changing-the-length-of-an-object" id="toc-sec-changing-the-length-of-an-object" class="nav-link" data-scroll-target="#sec-changing-the-length-of-an-object"><span class="header-section-number">3.2</span> Changing the length of an object</a></li>
  <li><a href="#sec-getting-and-setting-attributes" id="toc-sec-getting-and-setting-attributes" class="nav-link" data-scroll-target="#sec-getting-and-setting-attributes"><span class="header-section-number">3.3</span> Getting and setting attributes</a></li>
  <li><a href="#sec-the-class-of-an-object" id="toc-sec-the-class-of-an-object" class="nav-link" data-scroll-target="#sec-the-class-of-an-object"><span class="header-section-number">3.4</span> The class of an object</a></li>
  </ul></li>
  <li><a href="#sec-ordered-and-unordered-factors" id="toc-sec-ordered-and-unordered-factors" class="nav-link" data-scroll-target="#sec-ordered-and-unordered-factors"><span class="header-section-number">4</span> Ordered and unordered factors</a>
  <ul class="collapse">
  <li><a href="#sec-4.1-a-specific-example" id="toc-sec-4.1-a-specific-example" class="nav-link" data-scroll-target="#sec-4.1-a-specific-example"><span class="header-section-number">4.1</span> 4.1 A specific example</a></li>
  <li><a href="#the-function-tapply-and-ragged-arrays-sec-the-function-tapply-and-ragged-arrays" id="toc-the-function-tapply-and-ragged-arrays-sec-the-function-tapply-and-ragged-arrays" class="nav-link" data-scroll-target="#the-function-tapply-and-ragged-arrays-sec-the-function-tapply-and-ragged-arrays"><span class="header-section-number">4.2</span> The function <code>tapply()</code> and ragged arrays {#sec-the-function-<code>tapply()</code>-and-ragged-arrays}</a></li>
  <li><a href="#sec-ordered-factors" id="toc-sec-ordered-factors" class="nav-link" data-scroll-target="#sec-ordered-factors"><span class="header-section-number">4.3</span> Ordered factors</a></li>
  </ul></li>
  <li><a href="#sec-arrays-and-matrices" id="toc-sec-arrays-and-matrices" class="nav-link" data-scroll-target="#sec-arrays-and-matrices"><span class="header-section-number">5</span> Arrays and matrices</a>
  <ul class="collapse">
  <li><a href="#sec-arrays" id="toc-sec-arrays" class="nav-link" data-scroll-target="#sec-arrays"><span class="header-section-number">5.1</span> Arrays</a></li>
  <li><a href="#sec-array-indexing.-subsections-of-an-array" id="toc-sec-array-indexing.-subsections-of-an-array" class="nav-link" data-scroll-target="#sec-array-indexing.-subsections-of-an-array"><span class="header-section-number">5.2</span> Array indexing. Subsections of an array</a></li>
  <li><a href="#sec-index-matrices" id="toc-sec-index-matrices" class="nav-link" data-scroll-target="#sec-index-matrices"><span class="header-section-number">5.3</span> Index matrices</a></li>
  <li><a href="#the-array-function-sec-the-array-function" id="toc-the-array-function-sec-the-array-function" class="nav-link" data-scroll-target="#the-array-function-sec-the-array-function"><span class="header-section-number">5.4</span> The <code>array()</code> function {#sec-the-<code>array()</code>-function}</a></li>
  <li><a href="#sec-the-outer-product-of-two-arrays" id="toc-sec-the-outer-product-of-two-arrays" class="nav-link" data-scroll-target="#sec-the-outer-product-of-two-arrays"><span class="header-section-number">5.5</span> The outer product of two arrays</a></li>
  <li><a href="#sec-generalized-transpose-of-an-array" id="toc-sec-generalized-transpose-of-an-array" class="nav-link" data-scroll-target="#sec-generalized-transpose-of-an-array"><span class="header-section-number">5.6</span> Generalized transpose of an array</a></li>
  <li><a href="#sec-matrix-facilities" id="toc-sec-matrix-facilities" class="nav-link" data-scroll-target="#sec-matrix-facilities"><span class="header-section-number">5.7</span> Matrix facilities</a></li>
  <li><a href="#forming-partitioned-matrices-cbind-and-rbind-sec-forming-partitioned-matrices-cbind-and-rbind" id="toc-forming-partitioned-matrices-cbind-and-rbind-sec-forming-partitioned-matrices-cbind-and-rbind" class="nav-link" data-scroll-target="#forming-partitioned-matrices-cbind-and-rbind-sec-forming-partitioned-matrices-cbind-and-rbind"><span class="header-section-number">5.8</span> Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code> {#sec-forming-partitioned-matrices-<code>cbind()</code>-and-<code>rbind()</code>}</a></li>
  <li><a href="#the-concatenation-function-c-with-arrays-sec-the-concatenation-function-c-with-arrays" id="toc-the-concatenation-function-c-with-arrays-sec-the-concatenation-function-c-with-arrays" class="nav-link" data-scroll-target="#the-concatenation-function-c-with-arrays-sec-the-concatenation-function-c-with-arrays"><span class="header-section-number">5.9</span> The concatenation function, <code>c()</code>, with arrays {#sec-the-concatenation-function-<code>c()</code>-with-arrays}</a></li>
  <li><a href="#sec-frequency-tables-from-factors" id="toc-sec-frequency-tables-from-factors" class="nav-link" data-scroll-target="#sec-frequency-tables-from-factors"><span class="header-section-number">5.10</span> Frequency tables from factors</a></li>
  </ul></li>
  <li><a href="#sec-lists-and-data-frames" id="toc-sec-lists-and-data-frames" class="nav-link" data-scroll-target="#sec-lists-and-data-frames"><span class="header-section-number">6</span> Lists and data frames</a>
  <ul class="collapse">
  <li><a href="#sec-lists" id="toc-sec-lists" class="nav-link" data-scroll-target="#sec-lists"><span class="header-section-number">6.1</span> Lists</a></li>
  <li><a href="#sec-constructing-and-modifying-lists" id="toc-sec-constructing-and-modifying-lists" class="nav-link" data-scroll-target="#sec-constructing-and-modifying-lists"><span class="header-section-number">6.2</span> Constructing and modifying lists</a></li>
  <li><a href="#sec-data-frames" id="toc-sec-data-frames" class="nav-link" data-scroll-target="#sec-data-frames"><span class="header-section-number">6.3</span> Data frames</a></li>
  </ul></li>
  <li><a href="#sec-reading-data-from-files" id="toc-sec-reading-data-from-files" class="nav-link" data-scroll-target="#sec-reading-data-from-files"><span class="header-section-number">7</span> Reading data from files</a>
  <ul class="collapse">
  <li><a href="#the-read.table-function-sec-the-read.table-function" id="toc-the-read.table-function-sec-the-read.table-function" class="nav-link" data-scroll-target="#the-read.table-function-sec-the-read.table-function"><span class="header-section-number">7.1</span> The <code>read.table()</code> function {#sec-the-<code>read.table()</code>-function}</a></li>
  <li><a href="#the-scan-function-sec-the-scan-function" id="toc-the-scan-function-sec-the-scan-function" class="nav-link" data-scroll-target="#the-scan-function-sec-the-scan-function"><span class="header-section-number">7.2</span> The <code>scan()</code> function {#sec-the-<code>scan()</code>-function}</a></li>
  <li><a href="#sec-accessing-builtin-datasets" id="toc-sec-accessing-builtin-datasets" class="nav-link" data-scroll-target="#sec-accessing-builtin-datasets"><span class="header-section-number">7.3</span> Accessing builtin datasets</a></li>
  <li><a href="#sec-editing-data" id="toc-sec-editing-data" class="nav-link" data-scroll-target="#sec-editing-data"><span class="header-section-number">7.4</span> Editing data</a></li>
  </ul></li>
  <li><a href="#sec-probability-distributions" id="toc-sec-probability-distributions" class="nav-link" data-scroll-target="#sec-probability-distributions"><span class="header-section-number">8</span> Probability distributions</a>
  <ul class="collapse">
  <li><a href="#sec-r-as-a-set-of-statistical-tables" id="toc-sec-r-as-a-set-of-statistical-tables" class="nav-link" data-scroll-target="#sec-r-as-a-set-of-statistical-tables"><span class="header-section-number">8.1</span> R as a set of statistical tables</a></li>
  <li><a href="#sec-examining-the-distribution-of-a-set-of-data" id="toc-sec-examining-the-distribution-of-a-set-of-data" class="nav-link" data-scroll-target="#sec-examining-the-distribution-of-a-set-of-data"><span class="header-section-number">8.2</span> Examining the distribution of a set of data</a></li>
  <li><a href="#sec-one--and-two-sample-tests" id="toc-sec-one--and-two-sample-tests" class="nav-link" data-scroll-target="#sec-one--and-two-sample-tests"><span class="header-section-number">8.3</span> One- and two-sample tests</a></li>
  </ul></li>
  <li><a href="#sec-grouping-loops-and-conditional-execution" id="toc-sec-grouping-loops-and-conditional-execution" class="nav-link" data-scroll-target="#sec-grouping-loops-and-conditional-execution"><span class="header-section-number">9</span> Grouping, loops and conditional execution</a>
  <ul class="collapse">
  <li><a href="#sec-grouped-expressions" id="toc-sec-grouped-expressions" class="nav-link" data-scroll-target="#sec-grouped-expressions"><span class="header-section-number">9.1</span> Grouped expressions</a></li>
  <li><a href="#sec-control-statements" id="toc-sec-control-statements" class="nav-link" data-scroll-target="#sec-control-statements"><span class="header-section-number">9.2</span> Control statements</a></li>
  </ul></li>
  <li><a href="#sec-writing-your-own-functions" id="toc-sec-writing-your-own-functions" class="nav-link" data-scroll-target="#sec-writing-your-own-functions"><span class="header-section-number">10</span> Writing your own functions</a>
  <ul class="collapse">
  <li><a href="#sec-simple-examples" id="toc-sec-simple-examples" class="nav-link" data-scroll-target="#sec-simple-examples"><span class="header-section-number">10.1</span> Simple examples</a></li>
  <li><a href="#sec-defining-new-binary-operators" id="toc-sec-defining-new-binary-operators" class="nav-link" data-scroll-target="#sec-defining-new-binary-operators"><span class="header-section-number">10.2</span> Defining new binary operators</a></li>
  <li><a href="#sec-named-arguments-and-defaults" id="toc-sec-named-arguments-and-defaults" class="nav-link" data-scroll-target="#sec-named-arguments-and-defaults"><span class="header-section-number">10.3</span> Named arguments and defaults</a></li>
  <li><a href="#the-sec-the--argument" id="toc-the-sec-the--argument" class="nav-link" data-scroll-target="#the-sec-the--argument"><span class="header-section-number">10.4</span> The ‘<code>…</code>{#sec-the-’<code>…</code>’-argument}</a></li>
  <li><a href="#sec-assignments-within-functions" id="toc-sec-assignments-within-functions" class="nav-link" data-scroll-target="#sec-assignments-within-functions"><span class="header-section-number">10.5</span> Assignments within functions</a></li>
  <li><a href="#sec-more-advanced-examples" id="toc-sec-more-advanced-examples" class="nav-link" data-scroll-target="#sec-more-advanced-examples"><span class="header-section-number">10.6</span> More advanced examples</a></li>
  <li><a href="#sec-scope" id="toc-sec-scope" class="nav-link" data-scroll-target="#sec-scope"><span class="header-section-number">10.7</span> Scope</a></li>
  <li><a href="#sec-customizing-the-environment" id="toc-sec-customizing-the-environment" class="nav-link" data-scroll-target="#sec-customizing-the-environment"><span class="header-section-number">10.8</span> Customizing the environment</a></li>
  <li><a href="#sec-classes-generic-functions-and-object-orientation" id="toc-sec-classes-generic-functions-and-object-orientation" class="nav-link" data-scroll-target="#sec-classes-generic-functions-and-object-orientation"><span class="header-section-number">10.9</span> Classes, generic functions and object orientation</a></li>
  </ul></li>
  <li><a href="#sec-statistical-models-in-r" id="toc-sec-statistical-models-in-r" class="nav-link" data-scroll-target="#sec-statistical-models-in-r"><span class="header-section-number">11</span> Statistical models in R</a>
  <ul class="collapse">
  <li><a href="#sec-defining-statistical-models-formulae" id="toc-sec-defining-statistical-models-formulae" class="nav-link" data-scroll-target="#sec-defining-statistical-models-formulae"><span class="header-section-number">11.1</span> Defining statistical models; formulae</a></li>
  <li><a href="#sec-linear-models" id="toc-sec-linear-models" class="nav-link" data-scroll-target="#sec-linear-models"><span class="header-section-number">11.2</span> Linear models</a></li>
  <li><a href="#sec-generic-functions-for-extracting-model-information" id="toc-sec-generic-functions-for-extracting-model-information" class="nav-link" data-scroll-target="#sec-generic-functions-for-extracting-model-information"><span class="header-section-number">11.3</span> Generic functions for extracting model information</a></li>
  <li><a href="#sec-analysis-of-variance-and-model-comparison" id="toc-sec-analysis-of-variance-and-model-comparison" class="nav-link" data-scroll-target="#sec-analysis-of-variance-and-model-comparison"><span class="header-section-number">11.4</span> Analysis of variance and model comparison</a></li>
  <li><a href="#sec-updating-fitted-models" id="toc-sec-updating-fitted-models" class="nav-link" data-scroll-target="#sec-updating-fitted-models"><span class="header-section-number">11.5</span> Updating fitted models</a></li>
  <li><a href="#sec-generalized-linear-models" id="toc-sec-generalized-linear-models" class="nav-link" data-scroll-target="#sec-generalized-linear-models"><span class="header-section-number">11.6</span> Generalized linear models</a></li>
  <li><a href="#sec-nonlinear-least-squares-and-maximum-likelihood-models" id="toc-sec-nonlinear-least-squares-and-maximum-likelihood-models" class="nav-link" data-scroll-target="#sec-nonlinear-least-squares-and-maximum-likelihood-models"><span class="header-section-number">11.7</span> Nonlinear least squares and maximum likelihood models</a></li>
  <li><a href="#sec-some-non-standard-models" id="toc-sec-some-non-standard-models" class="nav-link" data-scroll-target="#sec-some-non-standard-models"><span class="header-section-number">11.8</span> Some non-standard models</a></li>
  </ul></li>
  <li><a href="#sec-graphical-procedures" id="toc-sec-graphical-procedures" class="nav-link" data-scroll-target="#sec-graphical-procedures"><span class="header-section-number">12</span> Graphical procedures</a>
  <ul class="collapse">
  <li><a href="#sec-high-level-plotting-commands" id="toc-sec-high-level-plotting-commands" class="nav-link" data-scroll-target="#sec-high-level-plotting-commands"><span class="header-section-number">12.1</span> High-level plotting commands</a></li>
  <li><a href="#sec-low-level-plotting-commands" id="toc-sec-low-level-plotting-commands" class="nav-link" data-scroll-target="#sec-low-level-plotting-commands"><span class="header-section-number">12.2</span> Low-level plotting commands</a></li>
  <li><a href="#sec-interacting-with-graphics" id="toc-sec-interacting-with-graphics" class="nav-link" data-scroll-target="#sec-interacting-with-graphics"><span class="header-section-number">12.3</span> Interacting with graphics</a></li>
  <li><a href="#sec-using-graphics-parameters" id="toc-sec-using-graphics-parameters" class="nav-link" data-scroll-target="#sec-using-graphics-parameters"><span class="header-section-number">12.4</span> Using graphics parameters</a></li>
  <li><a href="#sec-graphics-parameters-list" id="toc-sec-graphics-parameters-list" class="nav-link" data-scroll-target="#sec-graphics-parameters-list"><span class="header-section-number">12.5</span> Graphics parameters list</a></li>
  <li><a href="#sec-device-drivers" id="toc-sec-device-drivers" class="nav-link" data-scroll-target="#sec-device-drivers"><span class="header-section-number">12.6</span> Device drivers</a></li>
  <li><a href="#sec-dynamic-graphics" id="toc-sec-dynamic-graphics" class="nav-link" data-scroll-target="#sec-dynamic-graphics"><span class="header-section-number">12.7</span> Dynamic graphics</a></li>
  </ul></li>
  <li><a href="#sec-packages" id="toc-sec-packages" class="nav-link" data-scroll-target="#sec-packages"><span class="header-section-number">13</span> Packages</a>
  <ul class="collapse">
  <li><a href="#sec-standard-packages" id="toc-sec-standard-packages" class="nav-link" data-scroll-target="#sec-standard-packages"><span class="header-section-number">13.1</span> Standard packages</a></li>
  <li><a href="#sec-contributed-packages-and-cran" id="toc-sec-contributed-packages-and-cran" class="nav-link" data-scroll-target="#sec-contributed-packages-and-cran"><span class="header-section-number">13.2</span> Contributed packages and CRAN</a></li>
  <li><a href="#sec-namespaces" id="toc-sec-namespaces" class="nav-link" data-scroll-target="#sec-namespaces"><span class="header-section-number">13.3</span> Namespaces</a></li>
  </ul></li>
  <li><a href="#sec-os-facilities" id="toc-sec-os-facilities" class="nav-link" data-scroll-target="#sec-os-facilities"><span class="header-section-number">14</span> OS facilities</a>
  <ul class="collapse">
  <li><a href="#sec-files-and-directories" id="toc-sec-files-and-directories" class="nav-link" data-scroll-target="#sec-files-and-directories"><span class="header-section-number">14.1</span> Files and directories</a></li>
  <li><a href="#sec-filepaths" id="toc-sec-filepaths" class="nav-link" data-scroll-target="#sec-filepaths"><span class="header-section-number">14.2</span> Filepaths</a></li>
  <li><a href="#sec-system-commands" id="toc-sec-system-commands" class="nav-link" data-scroll-target="#sec-system-commands"><span class="header-section-number">14.3</span> System commands</a></li>
  <li><a href="#sec-compression-and-archives" id="toc-sec-compression-and-archives" class="nav-link" data-scroll-target="#sec-compression-and-archives"><span class="header-section-number">14.4</span> Compression and Archives</a></li>
  <li><a href="#sec-b.1-invoking-r-from-the-command-line" id="toc-sec-b.1-invoking-r-from-the-command-line" class="nav-link" data-scroll-target="#sec-b.1-invoking-r-from-the-command-line"><span class="header-section-number">14.5</span> B.1 Invoking R from the command line</a></li>
  <li><a href="#sec-b.2-invoking-r-under-windows" id="toc-sec-b.2-invoking-r-under-windows" class="nav-link" data-scroll-target="#sec-b.2-invoking-r-under-windows"><span class="header-section-number">14.6</span> B.2 Invoking R under Windows</a></li>
  <li><a href="#sec-b.3-invoking-r-under-macos" id="toc-sec-b.3-invoking-r-under-macos" class="nav-link" data-scroll-target="#sec-b.3-invoking-r-under-macos"><span class="header-section-number">14.7</span> B.3 Invoking R under macOS</a></li>
  <li><a href="#sec-b.4-scripting-with-r" id="toc-sec-b.4-scripting-with-r" class="nav-link" data-scroll-target="#sec-b.4-scripting-with-r"><span class="header-section-number">14.8</span> B.4 Scripting with R</a></li>
  </ul></li>
  <li><a href="#sec-appendix-a-a-sample-session" id="toc-sec-appendix-a-a-sample-session" class="nav-link" data-scroll-target="#sec-appendix-a-a-sample-session"><span class="header-section-number">15</span> A sample session</a></li>
  <li><a href="#sec-appendix-b-invoking-r" id="toc-sec-appendix-b-invoking-r" class="nav-link" data-scroll-target="#sec-appendix-b-invoking-r"><span class="header-section-number">16</span> Invoking R</a></li>
  <li><a href="#sec-appendix-c-the-command-line-editor" id="toc-sec-appendix-c-the-command-line-editor" class="nav-link" data-scroll-target="#sec-appendix-c-the-command-line-editor"><span class="header-section-number">17</span> The command-line editor</a>
  <ul class="collapse">
  <li><a href="#sec-c.1-preliminaries" id="toc-sec-c.1-preliminaries" class="nav-link" data-scroll-target="#sec-c.1-preliminaries"><span class="header-section-number">17.1</span> Preliminaries</a></li>
  <li><a href="#sec-c.2-editing-actions" id="toc-sec-c.2-editing-actions" class="nav-link" data-scroll-target="#sec-c.2-editing-actions"><span class="header-section-number">17.2</span> Editing actions</a></li>
  <li><a href="#sec-c.3-command-line-editor-summary" id="toc-sec-c.3-command-line-editor-summary" class="nav-link" data-scroll-target="#sec-c.3-command-line-editor-summary"><span class="header-section-number">17.3</span> Command-line editor summary</a></li>
  </ul></li>
  <li><a href="#sec-appendix-d-function-and-variable-index" id="toc-sec-appendix-d-function-and-variable-index" class="nav-link" data-scroll-target="#sec-appendix-d-function-and-variable-index"><span class="header-section-number">18</span> Function and variable index</a></li>
  <li><a href="#sec-appendix-e-concept-index" id="toc-sec-appendix-e-concept-index" class="nav-link" data-scroll-target="#sec-appendix-e-concept-index"><span class="header-section-number">19</span> Concept index</a></li>
  <li><a href="#sec-appendix-f-references" id="toc-sec-appendix-f-references" class="nav-link" data-scroll-target="#sec-appendix-f-references"><span class="header-section-number">20</span> References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jwarz/jwarz.github.io/edit/main/tutorials/R/r-manuals/test.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jwarz/jwarz.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R Manuals :: An Introduction to R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="an-introduction-to-r" class="level1 unnumbered">
<h1 class="unnumbered">An Introduction to R</h1>
<p>This is an introduction to R (“GNU S”), a language and environment for statistical computing and graphics. R is similar to the award-winning<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> S system, which was developed at Bell Laboratories by John Chambers et al.&nbsp;It provides a wide variety of statistical and graphical techniques (linear and nonlinear modelling, statistical tests, time series analysis, classification, clustering, ...).</p>
<p>This manual provides information on data types, programming elements, statistical modelling and graphics.</p>
<p>This manual is for R, version 4.3.0 Under development.</p>
<p>Copyright © 1990 W. N. Venables<br>
Copyright © 1992 W. N. Venables &amp; D. M. Smith<br>
Copyright © 1997 R. Gentleman &amp; R. Ihaka<br>
Copyright © 1997, 1998 M. Maechler<br>
Copyright © 1999–2022 R Core Team</p>
<blockquote class="blockquote">
<p>Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies.</p>
<p>Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</p>
<p>Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions, except that this permission notice may be stated in a translation approved by the R Core Team.</p>
</blockquote>
</section>
<section id="preface" class="level1 unnumbered">
<h1 class="unnumbered">Preface</h1>
<p>This introduction to R is derived from an original set of notes describing the S and <span class="small">S-PLUS</span> environments written in 1990–2 by Bill Venables and David M. Smith when at the University of Adelaide. We have made a number of small changes to reflect differences between the R and S programs, and expanded some of the material.</p>
<p>We would like to extend warm thanks to Bill Venables (and David Smith) for granting permission to distribute this modified version of the notes in this way, and for being a supporter of R from way back.</p>
<p>Comments and corrections are always welcome. Please address email correspondence to <a href="mailto:R-help@R-project.org" class="email">R-help@R-project.org</a>.</p>
<section id="suggestions-to-the-reader" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="suggestions-to-the-reader">Suggestions to the reader</h3>
<p>Most R novices will start with the introductory session in Appendix A. This should give some familiarity with the style of R sessions and more importantly some instant feedback on what actually happens.</p>
<p>Many users will come to R mainly for its graphical facilities. See <a href="#sec-graphical-procedures">Section&nbsp;12</a>, which can be read at almost any time and need not wait until all the preceding sections have been digested.</p>
</section>
</section>
<section id="sec-introduction-and-preliminaries" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction and preliminaries</h1>
<section id="sec-the-r-environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-the-r-environment"><span class="header-section-number">1.1</span> The R environment</h2>
<p>R is an integrated suite of software facilities for data manipulation, calculation and graphical display. Among other things it has</p>
<ul>
<li>an effective data handling and storage facility,</li>
<li>a suite of operators for calculations on arrays, in particular matrices,</li>
<li>a large, coherent, integrated collection of intermediate tools for data analysis,</li>
<li>graphical facilities for data analysis and display either directly at the computer or on hardcopy, and</li>
<li>a well developed, simple and effective programming language (called ‘S’) which includes conditionals, loops, user defined recursive functions and input and output facilities. (Indeed most of the system supplied functions are themselves written in the S language.)</li>
</ul>
<p>The term “environment” is intended to characterize it as a fully planned and coherent system, rather than an incremental accretion of very specific and inflexible tools, as is frequently the case with other data analysis software.</p>
<p>R is very much a vehicle for newly developing methods of interactive data analysis. It has developed rapidly, and has been extended by a large collection of <em>packages</em>. However, most programs written in R are essentially ephemeral, written for a single piece of data analysis.</p>
</section>
<section id="sec-related-software-and-documentation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-related-software-and-documentation"><span class="header-section-number">1.2</span> Related software and documentation</h2>
<p>R can be regarded as an implementation of the S language which was developed at Bell Laboratories by Rick Becker, John Chambers and Allan Wilks, and also forms the basis of the <span class="small">S-PLUS</span> systems.</p>
<p>The evolution of the S language is characterized by four books by John Chambers and coauthors. For R, the basic reference is <em>The New S Language: A Programming Environment for Data Analysis and Graphics</em> by Richard A. Becker, John M. Chambers and Allan R. Wilks. The new features of the 1991 release of S are covered in <em>Statistical Models in S</em> edited by John M. Chambers and Trevor J. Hastie. The formal methods and classes of the <strong>methods</strong> package are based on those described in <em>Programming with Data</em> by John M. Chambers. See <a href="References.html">References</a>, for precise references.</p>
<p>There are now a number of books which describe how to use R for data analysis and statistics, and documentation for S/<span class="small">S-PLUS</span> can typically be used with R, keeping the differences between the S implementations in mind. See <a href="https://cran.r-project.org/doc/FAQ/R-FAQ.html#What-documentation-exists-for-R_003f">What documentation exists for R</a> in the R statistical system FAQ.</p>
</section>
<section id="sec-r-and-statistics" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sec-r-and-statistics"><span class="header-section-number">1.3</span> R and statistics</h2>
<p>Our introduction to the R environment did not mention <em>statistics</em>, yet many people use R as a statistics system. We prefer to think of it of an environment within which many classical and modern statistical techniques have been implemented. A few of these are built into the base R environment, but many are supplied as <em>packages</em>. There are about 25 packages supplied with R (called “standard” and “recommended” packages) and many more are available through the CRAN family of Internet sites (via <a href="https://CRAN.R-project.org" class="uri">https://CRAN.R-project.org</a>) and elsewhere. More details on packages are given later (see <a href="#sec-packages">Section&nbsp;13</a>).</p>
<p>Most classical statistics and much of the latest methodology is available for use with R, but users may need to be prepared to do a little work to find it.</p>
<p>There is an important difference in philosophy between S (and hence R) and the other main statistical systems. In S a statistical analysis is normally done as a series of steps, with intermediate results being stored in objects. Thus whereas SAS and SPSS will give copious output from a regression or discriminant analysis, R will give minimal output and store the results in a fit object for subsequent interrogation by further R functions.</p>
</section>
<section id="sec-r-and-the-window-system" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="sec-r-and-the-window-system"><span class="header-section-number">1.4</span> R and the window system</h2>
<p>The most convenient way to use R is at a graphics workstation running a windowing system. This guide is aimed at users who have this facility. In particular we will occasionally refer to the use of R on an X window system although the vast bulk of what is said applies generally to any implementation of the R environment.</p>
<p>Most users will find it necessary to interact directly with the operating system on their computer from time to time. In this guide, we mainly discuss interaction with the operating system on UNIX machines. If you are running R under Windows or macOS you will need to make some small adjustments.</p>
<p>Setting up a workstation to take full advantage of the customizable features of R is a straightforward if somewhat tedious procedure, and will not be considered further here. Users in difficulty should seek local expert help.</p>
</section>
<section id="sec-using-r-interactively" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sec-using-r-interactively"><span class="header-section-number">1.5</span> Using R interactively</h2>
<p>When you use the R program it issues a prompt when it expects input commands. The default prompt is <code>&gt;</code>, which on UNIX might be the same as the shell prompt, and so it may appear that nothing is happening. However, as we shall see, it is easy to change to a different R prompt if you wish. We will assume that the UNIX shell prompt is <code>$</code>.</p>
<p>In using R under UNIX the suggested procedure for the first occasion is as follows:</p>
<ol type="1">
<li><p>Create a separate sub-directory, say <code>work</code>, to hold data files on which you will use R for this problem. This will be the working directory whenever you use R for this particular problem. <code>R     $ mkdir work     $ cd work</code></p></li>
<li><p>Start the R program with the command <code>R     $ R</code></p></li>
<li><p>At this point R commands may be issued (see later).</p></li>
<li><p>To quit the R program the command is</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="sc">&gt;</span> <span class="fu">q</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>At this point you will be asked whether you want to save the data from your R session. On some systems this will bring up a dialog box, and on others you will receive a text prompt to which you can respond <kbd>yes</kbd>, <kbd>no</kbd> or <kbd>cancel</kbd> (a single letter abbreviation will do) to save the data before quitting, quit without saving, or return to the R session. Data which is saved will be available in future R sessions.</p></li>
</ol>
<p>Further R sessions are simple.</p>
<ol type="1">
<li>Make <code>work</code> the working directory and start the program as before: <code>R     $ cd work     $ R</code></li>
<li>Use the R program, terminating with the <code>q()</code> command at the end of the session.</li>
</ol>
<p>To use R under Windows the procedure to follow is basically the same. Create a folder as the working directory, and set that in the <code>Start In</code> field in your R shortcut. Then launch R by double clicking on the icon.</p>
</section>
<section id="sec-1.6-an-introductory-session" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="sec-1.6-an-introductory-session"><span class="header-section-number">1.6</span> 1.6 An introductory session</h2>
<p>Readers wishing to get a feel for R at a computer before proceeding are strongly advised to work through the introductory session given in <a href="#sec-appendix-a-a-sample-session">Section&nbsp;15</a>.</p>
</section>
<section id="sec-getting-help-with-functions-and-features" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="sec-getting-help-with-functions-and-features"><span class="header-section-number">1.7</span> Getting help with functions and features</h2>
<p>R has an inbuilt help facility similar to the <code>man</code> facility of UNIX. To get more information on any specific named function, for example <code>solve</code>, the command is</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(solve)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>An alternative is</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="sc">&gt;</span> ?solve</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For a feature specified by special characters, the argument must be enclosed in double or single quotes, making it a “character string”: This is also necessary for a few words with syntactic meaning including <code>if</code>, <code>for</code> and <code>function</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(<span class="st">"[["</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Either form of quote mark may be used to escape the other, as in the string <code>"It's important"</code>. Our convention is to use double quote marks for preference.</p>
<p>On most R installations help is available in HTML format by running</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="sc">&gt;</span> <span class="fu">help.start</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which will launch a Web browser that allows the help pages to be browsed with hyperlinks. On UNIX, subsequent help requests are sent to the HTML-based help system. The ‘Search Engine and Keywords’ link in the page loaded by <code>help.start()</code> is particularly useful as it is contains a high-level concept list which searches though available functions. It can be a great way to get your bearings quickly and to understand the breadth of what R has to offer.</p>
<p>The <code>help.search</code> command (alternatively <code>??</code>) allows searching for help in various ways. For example,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="sc">&gt;</span> ??solve</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Try <code>?help.search</code> for details and more examples.</p>
<p>The examples on a help topic can normally be run by</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="sc">&gt;</span> <span class="fu">example</span>(topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Windows versions of R have other optional help systems: use</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="sc">&gt;</span> ?help</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>for further details.</p>
</section>
<section id="sec-r-commands-case-sensitivity-etc." class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="sec-r-commands-case-sensitivity-etc."><span class="header-section-number">1.8</span> R commands, case sensitivity, etc.</h2>
<p>Technically R is an <em>expression language</em> with a very simple syntax. It is <em>case sensitive</em> as are most UNIX based packages, so <code>A</code> and <code>a</code> are different symbols and would refer to different variables. The set of symbols which can be used in R names depends on the operating system and country within which R is being run (technically on the <em>locale</em> in use). Normally all alphanumeric symbols are allowed<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (and in some countries this includes accented letters) plus <code>.</code> and <code>_</code>‘, with the restriction that a name must start with’<code>.</code> or a letter, and if it starts with <code>.</code> the second character must not be a digit. Names are effectively unlimited in length.</p>
<p>Elementary commands consist of either <em>expressions</em> or <em>assignments</em>. If an expression is given as a command, it is evaluated, printed (unless specifically made invisible), and the value is lost. An assignment also evaluates an expression and passes the value to a variable but the result is not automatically printed.</p>
<p>Commands are separated either by a semi-colon (<code>;</code>), or by a newline. Elementary commands can be grouped together into one compound expression by braces (<code>{</code>’ and ’<code>}</code>). <em>Comments</em> can be put almost<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> anywhere, starting with a hashmark (<code>#</code>), everything to the end of the line is a comment.</p>
<p>If a command is not complete at the end of a line, R will give a different prompt, by default</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="sc">+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>on second and subsequent lines and continue to read input until the command is syntactically complete. This prompt may be changed by the user. We will generally omit the continuation prompt and indicate continuation by simple indenting.</p>
<p>Command lines entered at the console are limited<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> to about 4095 bytes (not characters).</p>
</section>
<section id="sec-recall-and-correction-of-previous-commands" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="sec-recall-and-correction-of-previous-commands"><span class="header-section-number">1.9</span> Recall and correction of previous commands</h2>
<p>Under many versions of UNIX and on Windows, R provides a mechanism for recalling and re-executing previous commands. The vertical arrow keys on the keyboard can be used to scroll forward and backward through a <em>command history</em>. Once a command is located in this way, the cursor can be moved within the command using the horizontal arrow keys, and characters can be removed with the DEL key or added with the other keys. More details are provided later: see <a href="#sec-appendix-c-the-command-line-editor">Section&nbsp;17</a> .</p>
<p>The recall and editing capabilities under UNIX are highly customizable. You can find out how to do this by reading the manual entry for the <strong>readline</strong> library.</p>
<p>Alternatively, the Emacs text editor provides more general support mechanisms (via ESS, <em>Emacs Speaks Statistics</em>) for working interactively with R. See <a href="https://cran.r-project.org/doc/FAQ/R-FAQ.html#R-and-Emacs">R and Emacs</a> in The R statistical system FAQ.</p>
</section>
<section id="sec-executing-commands-from-or-diverting-output-to-a-file" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="sec-executing-commands-from-or-diverting-output-to-a-file"><span class="header-section-number">1.10</span> Executing commands from or diverting output to a file</h2>
<p>If commands<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> are stored in an external file, say <code>commands.R</code> in the working directory <code>work</code>, they may be executed at any time in an R session with the command</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="sc">&gt;</span> <span class="fu">source</span>(<span class="st">"commands.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For Windows <strong>Source</strong> is also available on the <strong>File</strong> menu. The function <code>sink</code>,</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="sc">&gt;</span> <span class="fu">sink</span>(<span class="st">"record.lis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will divert all subsequent output from the console to an external file, <code>record.lis</code>. The command</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="sc">&gt;</span> <span class="fu">sink</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>restores it to the console once again.</p>
</section>
<section id="sec-data-permanency-and-removing-objects" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="sec-data-permanency-and-removing-objects"><span class="header-section-number">1.11</span> Data permanency and removing objects</h2>
<p>The entities that R creates and manipulates are known as <em>objects</em>. These may be variables, arrays of numbers, character strings, functions, or more general structures built from such components.</p>
<p>During an R session, objects are created and stored by name (we discuss this process in the next section). The R command</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="sc">&gt;</span> <span class="fu">objects</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(alternatively, <code>ls()</code>) can be used to display the names of (most of) the objects which are currently stored within R. The collection of objects currently stored is called the <em>workspace</em>.</p>
<p>To remove objects the function <code>rm</code> is available:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="sc">&gt;</span> <span class="fu">rm</span>(x, y, z, ink, junk, temp, foo, bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All objects created during an R session can be stored permanently in a file for use in future R sessions. At the end of each R session you are given the opportunity to save all the currently available objects. If you indicate that you want to do this, the objects are written to a file called <code>.RData</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> in the current directory, and the command lines used in the session are saved to a file called <code>.Rhistory</code>.</p>
<p>When R is started at later time from the same directory it reloads the workspace from this file. At the same time the associated commands history is reloaded.</p>
<p>It is recommended that you should use separate working directories for analyses conducted with R. It is quite common for objects with names <code>x</code> and <code>y</code> to be created during an analysis. Names like this are often meaningful in the context of a single analysis, but it can be quite hard to decide what they might be when the several analyses have been conducted in the same directory.</p>
</section>
</section>
<section id="sec-simple-manipulations-numbers-and-vectors" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Simple manipulations; numbers and vectors</h1>
<section id="sec-vectors-and-assignment" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-vectors-and-assignment"><span class="header-section-number">2.1</span> Vectors and assignment</h2>
<p>R operates on named <em>data structures</em>. The simplest such structure is the numeric <em>vector</em>, which is a single entity consisting of an ordered collection of numbers. To set up a vector named <code>x</code>, say, consisting of five numbers, namely 10.4, 5.6, 3.1, 6.4 and 21.7, use the R command</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">10.4</span>, <span class="fl">5.6</span>, <span class="fl">3.1</span>, <span class="fl">6.4</span>, <span class="fl">21.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is an <em>assignment</em> statement using the <em>function</em> <code>c()</code> which in this context can take an arbitrary number of vector <em>arguments</em> and whose value is a vector got by concatenating its arguments end to end.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>A number occurring by itself in an expression is taken as a vector of length one.</p>
<p>Notice that the assignment operator (<code>&lt;-</code>), which consists of the two characters <code>&lt;</code>’ (“less than”) and ‘<code>-</code> (“minus”) occurring strictly side-by-side and it ’points’ to the object receiving the value of the expression. In most contexts the <code>=</code> operator can be used as an alternative.</p>
<p>Assignment can also be made using the function <code>assign()</code>. An equivalent way of making the same assignment as above is with:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="sc">&gt;</span> <span class="fu">assign</span>(<span class="st">"x"</span>, <span class="fu">c</span>(<span class="fl">10.4</span>, <span class="fl">5.6</span>, <span class="fl">3.1</span>, <span class="fl">6.4</span>, <span class="fl">21.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The usual operator, <code>&lt;-</code>, can be thought of as a syntactic short-cut to this.</p>
<p>Assignments can also be made in the other direction, using the obvious change in the assignment operator. So the same assignment could be made using</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="sc">&gt;</span> <span class="fu">c</span>(<span class="fl">10.4</span>, <span class="fl">5.6</span>, <span class="fl">3.1</span>, <span class="fl">6.4</span>, <span class="fl">21.7</span>) <span class="ot">-&gt;</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If an expression is used as a complete command, the value is printed <em>and lost</em><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. So now if we were to use the command</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">/</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>the reciprocals of the five values would be printed at the terminal (and the value of <code>x</code>, of course, unchanged).</p>
<p>The further assignment</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">0</span>, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would create a vector <code>y</code> with 11 entries consisting of two copies of <code>x</code> with a zero in the middle place.</p>
</section>
<section id="sec-vector-arithmetic" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-vector-arithmetic"><span class="header-section-number">2.2</span> Vector arithmetic</h2>
<p>Vectors can be used in arithmetic expressions, in which case the operations are performed element by element. Vectors occurring in the same expression need not all be of the same length. If they are not, the value of the expression is a vector with the same length as the longest vector which occurs in the expression. Shorter vectors in the expression are <em>recycled</em> as often as need be (perhaps fractionally) until they match the length of the longest vector. In particular a constant is simply repeated. So with the above assignments the command</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="sc">&gt;</span> v <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> y <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>generates a new vector <code>v</code> of length 11 constructed by adding together, element by element, <code>2*x</code> repeated 2.2 times, <code>y</code> repeated just once, and <code>1</code> repeated 11 times.</p>
<p>The elementary arithmetic operators are the usual <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>^</code> for raising to a power. In addition all of the common arithmetic functions are available. <code>log</code>, <code>exp</code>, <code>sin</code>, <code>cos</code>, <code>tan</code>, <code>sqrt</code>, and so on, all have their usual meaning. <code>max</code> and <code>min</code> select the largest and smallest elements of a vector respectively. <code>range</code> is a function whose value is a vector of length two, namely <code>c(min(x), max(x))</code>. <code>length(x)</code> is the number of elements in <code>x</code>, <code>sum(x)</code> gives the total of the elements in <code>x</code>, and <code>prod(x)</code> their product.</p>
<p>Two statistical functions are <code>mean(x)</code> which calculates the sample mean, which is the same as <code>sum(x)/length(x)</code>, and <code>var(x)</code> which gives</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">sum</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or sample variance. If the argument to <code>var()</code> is an <em>n</em>-by-<em>p</em> matrix the value is a <em>p</em>-by-<em>p</em> sample covariance matrix got by regarding the rows as independent <em>p</em>-variate sample vectors.</p>
<p><code>sort(x)</code> returns a vector of the same size as <code>x</code> with the elements arranged in increasing order; however there are other more flexible sorting facilities available (see <code>order()</code> or <code>sort.list()</code> which produce a permutation to do the sorting).</p>
<p>Note that <code>max</code> and <code>min</code> select the largest and smallest values in their arguments, even if they are given several vectors. The <em>parallel</em> maximum and minimum functions <code>pmax</code> and <code>pmin</code> return a vector (of length equal to their longest argument) that contains in each element the largest (smallest) element in that position in any of the input vectors.</p>
<p>For most purposes the user will not be concerned if the “numbers” in a numeric vector are integers, reals or even complex. Internally calculations are done as double precision real numbers, or double precision complex numbers if the input data are complex.</p>
<p>To work with complex numbers, supply an explicit complex part. Thus</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will give <code>NaN</code> and a warning, but</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">17</span><span class="sc">+</span>0i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will do the computations as complex numbers.</p>
</section>
<section id="sec-generating-regular-sequences" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sec-generating-regular-sequences"><span class="header-section-number">2.3</span> Generating regular sequences</h2>
<p>R has a number of facilities for generating commonly used sequences of numbers. For example <code>1:30</code> is the vector <code>c(1, 2, …, 29, 30)</code>. The colon operator has high priority within an expression, so, for example <code>2*1:15</code> is the vector <code>c(2, 4, …, 28, 30)</code>. Put <code>n &lt;- 10</code> and compare the sequences <code>1:n-1</code> and <code>1:(n-1)</code>.</p>
<p>The construction <code>30:1</code> may be used to generate a sequence backwards.</p>
<p>The function <code>seq()</code> is a more general facility for generating sequences. It has five arguments, only some of which may be specified in any one call. The first two arguments, if given, specify the beginning and end of the sequence, and if these are the only two arguments given the result is the same as the colon operator. That is <code>seq(2,10)</code> is the same vector as <code>2:10</code>.</p>
<p>Arguments to <code>seq()</code>, and to many other R functions, can also be given in named form, in which case the order in which they appear is irrelevant. The first two arguments may be named <var>from=``value</var> and <var>to=``value</var>; thus <code>seq(1,30)</code>, <code>seq(from=1, to=30)</code> and <code>seq(to=30, from=1)</code> are all the same as <code>1:30</code>. The next two arguments to <code>seq()</code> may be named <var>by=``value</var> and <var>length=``value</var>, which specify a step size and a length for the sequence respectively. If neither of these is given, the default <code>by=1</code> is assumed.</p>
<p>For example</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="sc">&gt;</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by=</span>.<span class="dv">2</span>) <span class="ot">-&gt;</span> s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>generates in <code>s3</code> the vector <code>c(-5.0, -4.8, -4.6, …, 4.6, 4.8, 5.0)</code>. Similarly</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="sc">&gt;</span> s4 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">length=</span><span class="dv">51</span>, <span class="at">from=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">by=</span>.<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>generates the same vector in <code>s4</code>.</p>
<p>The fifth argument may be named <var>along=``vector</var>, which is normally used as the only argument to create the sequence <var>1, 2, …, length(``vector</var><code>)</code>, or the empty sequence if the vector is empty (as it can be).</p>
<p>A related function is <code>rep()</code> which can be used for replicating an object in various complicated ways. The simplest form is</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="sc">&gt;</span> s5 <span class="ot">&lt;-</span> <span class="fu">rep</span>(x, <span class="at">times=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which will put five copies of <code>x</code> end-to-end in <code>s5</code>. Another useful version is</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="sc">&gt;</span> s6 <span class="ot">&lt;-</span> <span class="fu">rep</span>(x, <span class="at">each=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which repeats each element of <code>x</code> five times before moving on to the next.</p>
</section>
<section id="sec-logical-vectors" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sec-logical-vectors"><span class="header-section-number">2.4</span> Logical vectors</h2>
<p>As well as numerical vectors, R allows manipulation of logical quantities. The elements of a logical vector can have the values <code>TRUE</code>, <code>FALSE</code>, and <code>NA</code> (for “not available”, see below). The first two are often abbreviated as <code>T</code> and <code>F</code>, respectively. Note however that <code>T</code> and <code>F</code> are just variables which are set to <code>TRUE</code> and <code>FALSE</code> by default, but are not reserved words and hence can be overwritten by the user. Hence, you should always use <code>TRUE</code> and <code>FALSE</code>.</p>
<p>Logical vectors are generated by <em>conditions</em>. For example</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="sc">&gt;</span> temp <span class="ot">&lt;-</span> x <span class="sc">&gt;</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>sets <code>temp</code> as a vector of the same length as <code>x</code> with values <code>FALSE</code> corresponding to elements of <code>x</code> where the condition is <em>not</em> met and <code>TRUE</code> where it is.</p>
<p>The logical operators are <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code> for exact equality and <code>!=</code> for inequality. In addition if <code>c1</code> and <code>c2</code> are logical expressions, then <code>c1&nbsp;&amp;&nbsp;c2</code> is their intersection (<em>“and”</em>), <code>c1&nbsp;|&nbsp;c2</code> is their union (<em>“or”</em>), and <code>!c1</code> is the negation of <code>c1</code>.</p>
<p>Logical vectors may be used in ordinary arithmetic, in which case they are <em>coerced</em> into numeric vectors, <code>FALSE</code> becoming <code>0</code> and <code>TRUE</code> becoming <code>1</code>. However there are situations where logical vectors and their coerced numeric counterparts are not equivalent, for example see the next subsection.</p>
</section>
<section id="sec-missing-values" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="sec-missing-values"><span class="header-section-number">2.5</span> Missing values</h2>
<p>In some cases the components of a vector may not be completely known. When an element or value is “not available” or a “missing value” in the statistical sense, a place within a vector may be reserved for it by assigning it the special value <code>NA</code>. In general any operation on an <code>NA</code> becomes an <code>NA</code>. The motivation for this rule is simply that if the specification of an operation is incomplete, the result cannot be known and hence is not available.</p>
<p>The function <code>is.na(x)</code> gives a logical vector of the same size as <code>x</code> with value <code>TRUE</code> if and only if the corresponding element in <code>x</code> is <code>NA</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="sc">&gt;</span> z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="cn">NA</span>);  ind <span class="ot">&lt;-</span> <span class="fu">is.na</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that the logical expression <code>x == NA</code> is quite different from <code>is.na(x)</code> since <code>NA</code> is not really a value but a marker for a quantity that is not available. Thus <code>x == NA</code> is a vector of the same length as <code>x</code> <em>all</em> of whose values are <code>NA</code> as the logical expression itself is incomplete and hence undecidable.</p>
<p>Note that there is a second kind of “missing” values which are produced by numerical computation, the so-called <em>Not a Number</em>, <code>NaN</code>, values. Examples are</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="sc">&gt;</span> <span class="dv">0</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="sc">&gt;</span> <span class="cn">Inf</span> <span class="sc">-</span> <span class="cn">Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which both give <code>NaN</code> since the result cannot be defined sensibly.</p>
<p>In summary, <code>is.na(xx)</code> is <code>TRUE</code> <em>both</em> for <code>NA</code> and <code>NaN</code> values. To differentiate these, <code>is.nan(xx)</code> is only <code>TRUE</code> for <code>NaN</code>s.</p>
<p>Missing values are sometimes printed as <code>&lt;NA&gt;</code> when character vectors are printed without quotes.</p>
</section>
<section id="sec-character-vectors" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="sec-character-vectors"><span class="header-section-number">2.6</span> Character vectors</h2>
<p>Character quantities and character vectors are used frequently in R, for example as plot labels. Where needed they are denoted by a sequence of characters delimited by the double quote character, e.g., <code>"x-values"</code>, <code>"New iteration results"</code>.</p>
<p>Character strings are entered using either matching double (<code>"</code>) or single (<code>'</code>) quotes, but are printed using double quotes (or sometimes without quotes). They use C-style escape sequences, using <code>\</code> as the escape character, so <code>\</code> is entered and printed as <code>\\</code>, and inside double quotes <code>"</code> is entered as <code>\"</code>. Other useful escape sequences are <code>\n</code>, newline, <code>\t</code>, tab and <code>\b</code>, backspace—see <code>?Quotes</code> for a full list.</p>
<p>Character vectors may be concatenated into a vector by the <code>c()</code> function; examples of their use will emerge frequently.</p>
<p>The <code>paste()</code> function takes an arbitrary number of arguments and concatenates them one by one into character strings. Any numbers given among the arguments are coerced into character strings in the evident way, that is, in the same way they would be if they were printed. The arguments are by default separated in the result by a single blank character, but this can be changed by the named argument, <var>sep=``string</var>, which changes it to <var>string</var>, possibly empty.</p>
<p>For example</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="sc">&gt;</span> labs <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"Y"</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>makes <code>labs</code> into the character vector</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"Y2"</span>, <span class="st">"X3"</span>, <span class="st">"Y4"</span>, <span class="st">"X5"</span>, <span class="st">"Y6"</span>, <span class="st">"X7"</span>, <span class="st">"Y8"</span>, <span class="st">"X9"</span>, <span class="st">"Y10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note particularly that recycling of short lists takes place here too; thus <code>c("X", "Y")</code> is repeated 5 times to match the sequence <code>1:10</code>. <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</section>
<section id="sec-index-vectors-selecting-and-modifying-subsets-of-a-data-set" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="sec-index-vectors-selecting-and-modifying-subsets-of-a-data-set"><span class="header-section-number">2.7</span> Index vectors; selecting and modifying subsets of a data set</h2>
<p>Subsets of the elements of a vector may be selected by appending to the name of the vector an <em>index vector</em> in square brackets. More generally any expression that evaluates to a vector may have subsets of its elements similarly selected by appending an index vector in square brackets immediately after the expression.</p>
<p>Such index vectors can be any of four distinct types.</p>
<ol type="1">
<li><p><strong>A logical vector</strong>. In this case the index vector is recycled to the same length as the vector from which elements are to be selected. Values corresponding to <code>TRUE</code> in the index vector are selected and those corresponding to <code>FALSE</code> are omitted. For example</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>creates (or re-creates) an object <code>y</code> which will contain the non-missing values of <code>x</code>, in the same order. Note that if <code>x</code> has missing values, <code>y</code> will be shorter than <code>x</code>. Also</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="sc">&gt;</span> (x<span class="sc">+</span><span class="dv">1</span>)[(<span class="sc">!</span><span class="fu">is.na</span>(x)) <span class="sc">&amp;</span> x<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">-&gt;</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>creates an object <code>z</code> and places in it the values of the vector <code>x+1</code> for which the corresponding value in <code>x</code> was both non-missing and positive.</p></li>
<li><p><strong>A vector of positive integral quantities</strong>. In this case the values in the index vector must lie in the set {1, 2, …, <code>length(x)</code>}. The corresponding elements of the vector are selected and concatenated, <em>in that order</em>, in the result. The index vector can be of any length and the result is of the same length as the index vector. For example <code>x[6]</code> is the sixth component of <code>x</code> and</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="sc">&gt;</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>selects the first 10 elements of <code>x</code> (assuming <code>length(x)</code> is not less than 10). Also</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="sc">&gt;</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)[<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">times=</span><span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(an admittedly unlikely thing to do) produces a character vector of length 16 consisting of <code>"x", "y", "y", "x"</code> repeated four times.</p></li>
<li><p><strong>A vector of negative integral quantities</strong>. Such an index vector specifies the values to be <em>excluded</em> rather than included. Thus</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>gives <code>y</code> all but the first five elements of <code>x</code>.</p></li>
<li><p><strong>A vector of character strings</strong>. This possibility only applies where an object has a <code>names</code> attribute to identify its components. In this case a sub-vector of the names vector may be used in the same way as the positive integral labels in item 2 further above.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="sc">&gt;</span> fruit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="sc">&gt;</span> <span class="fu">names</span>(fruit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"banana"</span>, <span class="st">"apple"</span>, <span class="st">"peach"</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="sc">&gt;</span> lunch <span class="ot">&lt;-</span> fruit[<span class="fu">c</span>(<span class="st">"apple"</span>,<span class="st">"orange"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The advantage is that alphanumeric <em>names</em> are often easier to remember than <em>numeric indices</em>. This option is particularly useful in connection with data frames, as we shall see later.</p></li>
</ol>
<p>An indexed expression can also appear on the receiving end of an assignment, in which case the assignment operation is performed <em>only on those elements of the vector</em>. The expression must be of the form <var>vector[``index_vector</var><code>]</code> as having an arbitrary expression in place of the vector name does not make much sense here.</p>
<p>For example</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="sc">&gt;</span> x[<span class="fu">is.na</span>(x)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>replaces any missing values in <code>x</code> by zeros and</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="sc">&gt;</span> y[y <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>y[y <span class="sc">&lt;</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>has the same effect as</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">abs</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-other-types-of-objects" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="sec-other-types-of-objects"><span class="header-section-number">2.8</span> Other types of objects</h2>
<p>Vectors are the most important type of object in R, but there are several others which we will meet more formally in later sections.</p>
<ul>
<li><em>matrices</em> or more generally <em>arrays</em> are multi-dimensional generalizations of vectors. In fact, they <em>are</em> vectors that can be indexed by two or more indices and will be printed in special ways. @#sec-arrays-and-matrices.</li>
<li><em>factors</em> provide compact ways to handle categorical data. See
<ol class="example" type="1">
<li></li>
</ol></li>
<li><em>lists</em> are a general form of vector in which the various elements need not be of the same type, and are often themselves vectors or lists. Lists provide a convenient way to return the results of a statistical computation. See <a href="#sec-lists">Section&nbsp;6.1</a>.</li>
<li><em>data frames</em> are matrix-like structures, in which the columns can be of different types. Think of data frames as ‘data matrices’ with one row per observational unit but with (possibly) both numerical and categorical variables. Many experiments are best described by data frames: the treatments are categorical but the response is numeric. See <a href="#sec-data-frames">Section&nbsp;6.3</a>.</li>
<li><em>functions</em> are themselves objects in R which can be stored in the project’s workspace. This provides a simple and convenient way to extend R. See <a href="#sec-writing-your-own-functions">Section&nbsp;10</a> .</li>
</ul>
</section>
</section>
<section id="sec-objects-their-modes-and-attributes" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Objects, their modes and attributes</h1>
<section id="sec-intrinsic-attributes:-mode-and-length" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec-intrinsic-attributes:-mode-and-length"><span class="header-section-number">3.1</span> Intrinsic attributes: mode and length</h2>
<p>The entities R operates on are technically known as <em>objects</em>. Examples are vectors of numeric (real) or complex values, vectors of logical values and vectors of character strings. These are known as “atomic” structures since their components are all of the same type, or <em>mode</em>, namely <em>numeric</em><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>, <em>complex</em>, <em>logical</em>, <em>character</em> and <em>raw</em>.</p>
<p>Vectors must have their values <em>all of the same mode</em>. Thus any given vector must be unambiguously either <em>logical</em>, <em>numeric</em>, <em>complex</em>, <em>character</em> or <em>raw</em>. (The only apparent exception to this rule is the special “value” listed as <code>NA</code> for quantities not available, but in fact there are several types of <code>NA</code>). Note that a vector can be empty and still have a mode. For example the empty character string vector is listed as <code>character(0)</code> and the empty numeric vector as <code>numeric(0)</code>.</p>
<p>R also operates on objects called <em>lists</em>, which are of mode <em>list</em>. These are ordered sequences of objects which individually can be of any mode. <em>lists</em> are known as “recursive” rather than atomic structures since their components can themselves be lists in their own right.</p>
<p>The other recursive structures are those of mode <em>function</em> and <em>expression</em>. Functions are the objects that form part of the R system along with similar user written functions, which we discuss in some detail later. Expressions as objects form an advanced part of R which will not be discussed in this guide, except indirectly when we discuss <em>formulae</em> used with modeling in R.</p>
<p>By the <em>mode</em> of an object we mean the basic type of its fundamental constituents. This is a special case of a “property” of an object. Another property of every object is its <em>length</em>. The functions <var>mode(``object</var><code>)</code> and <var>length(``object</var><code>)</code> can be used to find out the mode and length of any defined structure <a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
<p>Further properties of an object are usually provided by <var>attributes(``object</var><code>)</code>, see <a href="Getting-and-setting-attributes.html">Getting and setting attributes</a>. Because of this, <em>mode</em> and <em>length</em> are also called “intrinsic attributes” of an object.</p>
<p>For example, if <code>z</code> is a complex vector of length 100, then in an expression <code>mode(z)</code> is the character string <code>"complex"</code> and <code>length(z)</code> is <code>100</code>.</p>
<p>R caters for changes of mode almost anywhere it could be considered sensible to do so, (and a few where it might not be). For example with</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="sc">&gt;</span> z <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>we could put</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="sc">&gt;</span> digits <span class="ot">&lt;-</span> <span class="fu">as.character</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>after which <code>digits</code> is the character vector <code>c("0", "1", "2", …, "9")</code>. A further <em>coercion</em>, or change of mode, reconstructs the numerical vector again:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb45-1"><a href="#cb45-1"></a><span class="op">&gt;</span> d <span class="op">&lt;-</span> as<span class="op">.</span>integer<span class="op">(</span>digits<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now <code>d</code> and <code>z</code> are the same.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> There is a large collection of functions of the form <var>as.``something</var><code>()</code> for either coercion from one mode to another, or for investing an object with some other attribute it may not already possess. The reader should consult the different help files to become familiar with them.</p>
</section>
<section id="sec-changing-the-length-of-an-object" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-changing-the-length-of-an-object"><span class="header-section-number">3.2</span> Changing the length of an object</h2>
<p>An “empty” object may still have a mode. For example</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="sc">&gt;</span> e <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>makes <code>e</code> an empty vector structure of mode numeric. Similarly <code>character()</code> is a empty character vector, and so on. Once an object of any size has been created, new components may be added to it simply by giving it an index value outside its previous range. Thus</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="sc">&gt;</span> e[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>now makes <code>e</code> a vector of length 3, (the first two components of which are at this point both <code>NA</code>). This applies to any structure at all, provided the mode of the additional component(s) agrees with the mode of the object in the first place.</p>
<p>This automatic adjustment of lengths of an object is used often, for example in the <code>scan()</code> function for input. (see <a href="The-scan_0028_0029-function.html">The scan() function</a>.)</p>
<p>Conversely to truncate the size of an object requires only an assignment to do so. Hence if <code>alpha</code> is an object of length 10, then</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="sc">&gt;</span> alpha <span class="ot">&lt;-</span> alpha[<span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>makes it an object of length 5 consisting of just the former components with even index. (The old indices are not retained, of course.) We can then retain just the first three values by</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="sc">&gt;</span> <span class="fu">length</span>(alpha) <span class="ot">&lt;-</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and vectors can be extended (by missing values) in the same way.</p>
</section>
<section id="sec-getting-and-setting-attributes" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-getting-and-setting-attributes"><span class="header-section-number">3.3</span> Getting and setting attributes</h2>
<p>The function <var>attributes(``object</var><code>)</code> returns a list of all the non-intrinsic attributes currently defined for that object. The function <var>attr(``object</var><var>, ``name</var><code>)</code> can be used to select a specific attribute. These functions are rarely used, except in rather special circumstances when some new attribute is being created for some particular purpose, for example to associate a creation date or an operator with an R object. The concept, however, is very important.</p>
<p>Some care should be exercised when assigning or deleting attributes since they are an integral part of the object system used in R.</p>
<p>When it is used on the left hand side of an assignment it can be used either to associate a new attribute with <var>object</var> or to change an existing one. For example</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="sc">&gt;</span> <span class="fu">attr</span>(z, <span class="st">"dim"</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>allows R to treat <code>z</code> as if it were a 10-by-10 matrix.</p>
</section>
<section id="sec-the-class-of-an-object" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sec-the-class-of-an-object"><span class="header-section-number">3.4</span> The class of an object</h2>
<p>All objects in R have a <em>class</em>, reported by the function <code>class</code>. For simple vectors this is just the mode, for example <code>"numeric"</code>, <code>"logical"</code>, <code>"character"</code> or <code>"list"</code>, but <code>"matrix"</code>, <code>"array"</code>, <code>"factor"</code> and <code>"data.frame"</code> are other possible values.</p>
<p>A special attribute known as the <em>class</em> of the object is used to allow for an object-oriented style<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> of programming in R. For example if an object has class <code>"data.frame"</code>, it will be printed in a certain way, the <code>plot()</code> function will display it graphically in a certain way, and other so-called generic functions such as <code>summary()</code> will react to it as an argument in a way sensitive to its class.</p>
<p>To remove temporarily the effects of class, use the function <code>unclass()</code>. For example if <code>winter</code> has the class <code>"data.frame"</code> then</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb51-1"><a href="#cb51-1"></a><span class="op">&gt;</span> winter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will print it in data frame form, which is rather like a matrix, whereas</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb52-1"><a href="#cb52-1"></a><span class="op">&gt;</span> unclass<span class="op">(</span>winter<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will print it as an ordinary list. Only in rather special situations do you need to use this facility, but one is when you are learning to come to terms with the idea of class and generic functions.</p>
<p>Generic functions and classes will be discussed further in <a href="Object-orientation.html">Object orientation</a>, but only briefly.</p>
</section>
</section>
<section id="sec-ordered-and-unordered-factors" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Ordered and unordered factors</h1>
<p>A <em>factor</em> is a vector object used to specify a discrete classification (grouping) of the components of other vectors of the same length. R provides both <em>ordered</em> and <em>unordered</em> factors. While the “real” application of factors is with model formulae (see <a href="Contrasts.html">Contrasts</a>), we here look at a specific example.</p>
<section id="sec-4.1-a-specific-example" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-4.1-a-specific-example"><span class="header-section-number">4.1</span> 4.1 A specific example</h2>
<p>Suppose, for example, we have a sample of 30 tax accountants from all the states and territories of Australia<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> and their individual state of origin is specified by a character vector of state mnemonics as</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="sc">&gt;</span> state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tas"</span>, <span class="st">"sa"</span>,  <span class="st">"qld"</span>, <span class="st">"nsw"</span>, <span class="st">"nsw"</span>, <span class="st">"nt"</span>,  <span class="st">"wa"</span>,  <span class="st">"wa"</span>,</span>
<span id="cb53-2"><a href="#cb53-2"></a>             <span class="st">"qld"</span>, <span class="st">"vic"</span>, <span class="st">"nsw"</span>, <span class="st">"vic"</span>, <span class="st">"qld"</span>, <span class="st">"qld"</span>, <span class="st">"sa"</span>,  <span class="st">"tas"</span>,</span>
<span id="cb53-3"><a href="#cb53-3"></a>             <span class="st">"sa"</span>,  <span class="st">"nt"</span>,  <span class="st">"wa"</span>,  <span class="st">"vic"</span>, <span class="st">"qld"</span>, <span class="st">"nsw"</span>, <span class="st">"nsw"</span>, <span class="st">"wa"</span>,</span>
<span id="cb53-4"><a href="#cb53-4"></a>             <span class="st">"sa"</span>,  <span class="st">"act"</span>, <span class="st">"nsw"</span>, <span class="st">"vic"</span>, <span class="st">"vic"</span>, <span class="st">"act"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that in the case of a character vector, “sorted” means sorted in alphabetical order.</p>
<p>A <em>factor</em> is similarly created using the <code>factor()</code> function:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="sc">&gt;</span> statef <span class="ot">&lt;-</span> <span class="fu">factor</span>(state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>print()</code> function handles factors slightly differently from other objects:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="sc">&gt;</span> statef</span>
<span id="cb55-2"><a href="#cb55-2"></a> [<span class="dv">1</span>] tas sa  qld nsw nsw nt  wa  wa  qld vic nsw vic qld qld sa</span>
<span id="cb55-3"><a href="#cb55-3"></a>[<span class="dv">16</span>] tas sa  nt  wa  vic qld nsw nsw wa  sa  act nsw vic vic act</span>
<span id="cb55-4"><a href="#cb55-4"></a>Levels<span class="sc">:</span>  act nsw nt qld sa tas vic wa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To find out the levels of a factor the function <code>levels()</code> can be used.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="sc">&gt;</span> <span class="fu">levels</span>(statef)</span>
<span id="cb56-2"><a href="#cb56-2"></a>[<span class="dv">1</span>] <span class="st">"act"</span> <span class="st">"nsw"</span> <span class="st">"nt"</span>  <span class="st">"qld"</span> <span class="st">"sa"</span>  <span class="st">"tas"</span> <span class="st">"vic"</span> <span class="st">"wa"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">• <a href="The-function-tapply_0028_0029-and-ragged-arrays.html" accesskey="1">The function tapply() and ragged arrays</a></td>
<td style="text-align: left;">&nbsp;&nbsp;</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left;">• <a href="Ordered-factors.html" accesskey="2">Ordered factors</a></td>
<td style="text-align: left;">&nbsp;&nbsp;</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="the-function-tapply-and-ragged-arrays-sec-the-function-tapply-and-ragged-arrays" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-function-tapply-and-ragged-arrays-sec-the-function-tapply-and-ragged-arrays"><span class="header-section-number">4.2</span> The function <code>tapply()</code> and ragged arrays {#sec-the-function-<code>tapply()</code>-and-ragged-arrays}</h2>
<p>To continue the previous example, suppose we have the incomes of the same tax accountants in another vector (in suitably large units of money)</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="sc">&gt;</span> incomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">49</span>, <span class="dv">40</span>, <span class="dv">61</span>, <span class="dv">64</span>, <span class="dv">60</span>, <span class="dv">59</span>, <span class="dv">54</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">42</span>, <span class="dv">56</span>,</span>
<span id="cb57-2"><a href="#cb57-2"></a>               <span class="dv">61</span>, <span class="dv">61</span>, <span class="dv">61</span>, <span class="dv">58</span>, <span class="dv">51</span>, <span class="dv">48</span>, <span class="dv">65</span>, <span class="dv">49</span>, <span class="dv">49</span>, <span class="dv">41</span>, <span class="dv">48</span>, <span class="dv">52</span>, <span class="dv">46</span>,</span>
<span id="cb57-3"><a href="#cb57-3"></a>               <span class="dv">59</span>, <span class="dv">46</span>, <span class="dv">58</span>, <span class="dv">43</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To calculate the sample mean income for each state we can now use the special function <code>tapply()</code>:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="sc">&gt;</span> incmeans <span class="ot">&lt;-</span> <span class="fu">tapply</span>(incomes, statef, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>giving a means vector with the components labelled by the levels</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>   act    nsw     nt    qld     sa    tas    vic     wa</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fl">44.500</span> <span class="fl">57.333</span> <span class="fl">55.500</span> <span class="fl">53.600</span> <span class="fl">55.000</span> <span class="fl">60.500</span> <span class="fl">56.000</span> <span class="fl">52.250</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The function <code>tapply()</code> is used to apply a function, here <code>mean()</code>, to each group of components of the first argument, here <code>incomes</code>, defined by the levels of the second component, here <code>statef</code><a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>, as if they were separate vector structures. The result is a structure of the same length as the levels attribute of the factor containing the results. The reader should consult the help document for more details.</p>
<p>Suppose further we needed to calculate the standard errors of the state income means. To do this we need to write an R function to calculate the standard error for any given vector. Since there is an builtin function <code>var()</code> to calculate the sample variance, such a function is a very simple one liner, specified by the assignment:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="sc">&gt;</span> stdError <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Writing functions will be considered later in <a href="#sec-writing-your-own-functions">Section&nbsp;10</a> . Note that R’s a builtin function <code>sd()</code> is something different.) After this assignment, the standard errors are calculated by</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="sc">&gt;</span> incster <span class="ot">&lt;-</span> <span class="fu">tapply</span>(incomes, statef, stdError)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and the values calculated are then</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="sc">&gt;</span> incster</span>
<span id="cb62-2"><a href="#cb62-2"></a>act    nsw  nt    qld     sa tas   vic     wa</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="fl">1.5</span> <span class="fl">4.3102</span> <span class="fl">4.5</span> <span class="fl">4.1061</span> <span class="fl">2.7386</span> <span class="fl">0.5</span> <span class="fl">5.244</span> <span class="fl">2.6575</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As an exercise you may care to find the usual 95% confidence limits for the state mean incomes. To do this you could use <code>tapply()</code> once more with the <code>length()</code> function to find the sample sizes, and the <code>qt()</code> function to find the percentage points of the appropriate <em>t</em>-distributions. (You could also investigate R’s facilities for <em>t</em>-tests.)</p>
<p>The function <code>tapply()</code> can also be used to handle more complicated indexing of a vector by multiple categories. For example, we might wish to split the tax accountants by both state and sex. However in this simple instance (just one factor) what happens can be thought of as follows. The values in the vector are collected into groups corresponding to the distinct entries in the factor. The function is then applied to each of these groups individually. The value is a vector of function results, labelled by the <code>levels</code> attribute of the factor.</p>
<p>The combination of a vector and a labelling factor is an example of what is sometimes called a <em>ragged array</em>, since the subclass sizes are possibly irregular. When the subclass sizes are all the same the indexing may be done implicitly and much more efficiently, as we see in the next section.</p>
</section>
<section id="sec-ordered-factors" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-ordered-factors"><span class="header-section-number">4.3</span> Ordered factors</h2>
<p>The levels of factors are stored in alphabetical order, or in the order they were specified to <code>factor</code> if they were specified explicitly.</p>
<p>Sometimes the levels will have a natural ordering that we want to record and want our statistical analysis to make use of. The <code>ordered()</code> function creates such ordered factors but is otherwise identical to <code>factor</code>. For most purposes the only difference between ordered and unordered factors is that the former are printed showing the ordering of the levels, but the contrasts generated for them in fitting linear models are different.</p>
</section>
</section>
<section id="sec-arrays-and-matrices" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Arrays and matrices</h1>
<section id="sec-arrays" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-arrays"><span class="header-section-number">5.1</span> Arrays</h2>
<p>An array can be considered as a multiply subscripted collection of data entries, for example numeric. R allows simple facilities for creating and handling arrays, and in particular the special case of matrices.</p>
<p>A dimension vector is a vector of non-negative integers. If its length is <em>k</em> then the array is <em>k</em>-dimensional, e.g.&nbsp;a matrix is a <em>2</em>-dimensional array. The dimensions are indexed from one up to the values given in the dimension vector.</p>
<p>A vector can be used by R as an array only if it has a dimension vector as its <em>dim</em> attribute. Suppose, for example, <code>z</code> is a vector of 1500 elements. The assignment</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="sc">&gt;</span> <span class="fu">dim</span>(z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>gives it the <em>dim</em> attribute that allows it to be treated as a <em>3</em> by <em>5</em> by <em>100</em> array.</p>
<p>Other functions such as <code>matrix()</code> and <code>array()</code> are available for simpler and more natural looking assignments, as we shall see in <a href="The-array_0028_0029-function.html">The array() function</a>.</p>
<p>The values in the data vector give the values in the array in the same order as they would occur in FORTRAN, that is “column major order,” with the first subscript moving fastest and the last subscript slowest.</p>
<p>For example if the dimension vector for an array, say <code>a</code>, is <code>c(3,4,2)</code> then there are 3 * 4 * 2 = 24 entries in <code>a</code> and the data vector holds them in the order <code>a[1,1,1], a[2,1,1], …, a[2,4,2], a[3,4,2]</code>.</p>
<p>Arrays can be one-dimensional: such arrays are usually treated in the same way as vectors (including when printing), but the exceptions can cause confusion.</p>
</section>
<section id="sec-array-indexing.-subsections-of-an-array" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-array-indexing.-subsections-of-an-array"><span class="header-section-number">5.2</span> Array indexing. Subsections of an array</h2>
<p>Individual elements of an array may be referenced by giving the name of the array followed by the subscripts in square brackets, separated by commas.</p>
<p>More generally, subsections of an array may be specified by giving a sequence of <em>index vectors</em> in place of subscripts; however <em>if any index position is given an empty index vector, then the full range of that subscript is taken</em>.</p>
<p>Continuing the previous example, <code>a[2,,]</code> is a 4 * 2 array with dimension vector <code>c(4,2)</code> and data vector containing the values</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">c</span>(a[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>], a[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>], a[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>], a[<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb64-2"><a href="#cb64-2"></a>  a[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>], a[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>], a[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>], a[<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>in that order. <code>a[,,]</code> stands for the entire array, which is the same as omitting the subscripts entirely and using <code>a</code> alone.</p>
<p>For any array, say <code>Z</code>, the dimension vector may be referenced explicitly as <code>dim(Z)</code> (on either side of an assignment).</p>
<p>Also, if an array name is given with just <em>one subscript or index vector</em>, then the corresponding values of the data vector only are used; in this case the dimension vector is ignored. This is not the case, however, if the single index is not a vector but itself an array, as we next discuss.</p>
</section>
<section id="sec-index-matrices" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-index-matrices"><span class="header-section-number">5.3</span> Index matrices</h2>
<p>As well as an index vector in any subscript position, a matrix may be used with a single <em>index matrix</em> in order either to assign a vector of quantities to an irregular collection of elements in the array, or to extract an irregular collection as a vector.</p>
<p>A matrix example makes the process clear. In the case of a doubly indexed array, an index matrix may be given consisting of two columns and as many rows as desired. The entries in the index matrix are the row and column indices for the doubly indexed array. Suppose for example we have a <em>4</em> by <em>5</em> array <code>X</code> and we wish to do the following:</p>
<ul>
<li>Extract elements <code>X[1,3]</code>, <code>X[2,2]</code> and <code>X[3,1]</code> as a vector structure, and</li>
<li>Replace these entries in the array <code>X</code> by zeroes.</li>
</ul>
<p>In this case we need a <em>3</em> by <em>2</em> subscript array, as in the following example.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>))   <span class="co"># Generate a 4 by 5 array.</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="sc">&gt;</span> x</span>
<span id="cb65-3"><a href="#cb65-3"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb65-4"><a href="#cb65-4"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">9</span>   <span class="dv">13</span>   <span class="dv">17</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">6</span>   <span class="dv">10</span>   <span class="dv">14</span>   <span class="dv">18</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">7</span>   <span class="dv">11</span>   <span class="dv">15</span>   <span class="dv">19</span></span>
<span id="cb65-7"><a href="#cb65-7"></a>[<span class="dv">4</span>,]    <span class="dv">4</span>    <span class="dv">8</span>   <span class="dv">12</span>   <span class="dv">16</span>   <span class="dv">20</span></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="sc">&gt;</span> i <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb65-9"><a href="#cb65-9"></a><span class="sc">&gt;</span> i                             <span class="co"># i is a 3 by 2 index array.</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb65-11"><a href="#cb65-11"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">2</span></span>
<span id="cb65-13"><a href="#cb65-13"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb65-14"><a href="#cb65-14"></a><span class="sc">&gt;</span> x[i]                          <span class="co"># Extract those elements</span></span>
<span id="cb65-15"><a href="#cb65-15"></a>[<span class="dv">1</span>] <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span></span>
<span id="cb65-16"><a href="#cb65-16"></a><span class="sc">&gt;</span> x[i] <span class="ot">&lt;-</span> <span class="dv">0</span>                     <span class="co"># Replace those elements by zeros.</span></span>
<span id="cb65-17"><a href="#cb65-17"></a><span class="sc">&gt;</span> x</span>
<span id="cb65-18"><a href="#cb65-18"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb65-19"><a href="#cb65-19"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">0</span>   <span class="dv">13</span>   <span class="dv">17</span></span>
<span id="cb65-20"><a href="#cb65-20"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">0</span>   <span class="dv">10</span>   <span class="dv">14</span>   <span class="dv">18</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>[<span class="dv">3</span>,]    <span class="dv">0</span>    <span class="dv">7</span>   <span class="dv">11</span>   <span class="dv">15</span>   <span class="dv">19</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>[<span class="dv">4</span>,]    <span class="dv">4</span>    <span class="dv">8</span>   <span class="dv">12</span>   <span class="dv">16</span>   <span class="dv">20</span></span>
<span id="cb65-23"><a href="#cb65-23"></a><span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Negative indices are not allowed in index matrices. <code>NA</code> and zero values are allowed: rows in the index matrix containing a zero are ignored, and rows containing an <code>NA</code> produce an <code>NA</code> in the result.</p>
<p>As a less trivial example, suppose we wish to generate an (unreduced) design matrix for a block design defined by factors <code>blocks</code> (<code>b</code> levels) and <code>varieties</code> (<code>v</code> levels). Further suppose there are <code>n</code> plots in the experiment. We could proceed as follows:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="sc">&gt;</span> Xb <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, b)</span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="sc">&gt;</span> Xv <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, v)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="sc">&gt;</span> ib <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>n, blocks)</span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="sc">&gt;</span> iv <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>n, varieties)</span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="sc">&gt;</span> Xb[ib] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="sc">&gt;</span> Xv[iv] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb66-7"><a href="#cb66-7"></a><span class="sc">&gt;</span> X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Xb, Xv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To construct the incidence matrix, <code>N</code> say, we could use</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="sc">&gt;</span> N <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(Xb, Xv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However a simpler direct way of producing this matrix is to use <code>table()</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="sc">&gt;</span> N <span class="ot">&lt;-</span> <span class="fu">table</span>(blocks, varieties)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Index matrices must be numerical: any other form of matrix (e.g.&nbsp;a logical or character matrix) supplied as a matrix is treated as an indexing vector.</p>
</section>
<section id="the-array-function-sec-the-array-function" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="the-array-function-sec-the-array-function"><span class="header-section-number">5.4</span> The <code>array()</code> function {#sec-the-<code>array()</code>-function}</h2>
<p>As well as giving a vector structure a <code>dim</code> attribute, arrays can be constructed from vectors by the <code>array</code> function, which has the form</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="sc">&gt;</span> Z <span class="ot">&lt;-</span> <span class="fu">array</span>(data_vector, dim_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example, if the vector <code>h</code> contains 24 or fewer, numbers then the command</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="sc">&gt;</span> Z <span class="ot">&lt;-</span> <span class="fu">array</span>(h, <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would use <code>h</code> to set up <em>3</em> by <em>4</em> by <em>2</em> array in <code>Z</code>. If the size of <code>h</code> is exactly 24 the result is the same as</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="sc">&gt;</span> Z <span class="ot">&lt;-</span> h ; <span class="fu">dim</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However if <code>h</code> is shorter than 24, its values are recycled from the beginning again to make it up to size 24 (see <a href="The-recycling-rule.html">The recycling rule</a>) but <code>dim(h) &lt;- c(3,4,2)</code> would signal an error about mismatching length. As an extreme but common example</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="sc">&gt;</span> Z <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>makes <code>Z</code> an array of all zeros.</p>
<p>At this point <code>dim(Z)</code> stands for the dimension vector <code>c(3,4,2)</code>, and <code>Z[1:24]</code> stands for the data vector as it was in <code>h</code>, and <code>Z[]</code> with an empty subscript or <code>Z</code> with no subscript stands for the entire array as an array.</p>
<p>Arrays may be used in arithmetic expressions and the result is an array formed by element-by-element operations on the data vector. The <code>dim</code> attributes of operands generally need to be the same, and this becomes the dimension vector of the result. So if <code>A</code>, <code>B</code> and <code>C</code> are all similar arrays, then</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="sc">&gt;</span> D <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>A<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>makes <code>D</code> a similar array with its data vector being the result of the given element-by-element operations. However the precise rule concerning mixed array and vector calculations has to be considered a little more carefully.</p>
<section id="sec-mixed-vector-and-array-arithmetic.-the-recycling-rule" class="level3">
<h3 class="anchored" data-anchor-id="sec-mixed-vector-and-array-arithmetic.-the-recycling-rule">Mixed vector and array arithmetic. The recycling rule</h3>
<p>The precise rule affecting element by element mixed calculations with vectors and arrays is somewhat quirky and hard to find in the references. From experience we have found the following to be a reliable guide.</p>
<ul>
<li>The expression is scanned from left to right.</li>
<li>Any short vector operands are extended by recycling their values until they match the size of any other operands.</li>
<li>As long as short vectors and arrays <em>only</em> are encountered, the arrays must all have the same <code>dim</code> attribute or an error results.</li>
<li>Any vector operand longer than a matrix or array operand generates an error.</li>
<li>If array structures are present and no error or coercion to vector has been precipitated, the result is an array structure with the common <code>dim</code> attribute of its array operands.</li>
</ul>
</section>
</section>
<section id="sec-the-outer-product-of-two-arrays" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sec-the-outer-product-of-two-arrays"><span class="header-section-number">5.5</span> The outer product of two arrays</h2>
<p>An important operation on arrays is the <em>outer product</em>. If <code>a</code> and <code>b</code> are two numeric arrays, their outer product is an array whose dimension vector is obtained by concatenating their two dimension vectors (order is important), and whose data vector is got by forming all possible products of elements of the data vector of <code>a</code> with those of <code>b</code>. The outer product is formed by the special operator <code>%o%</code>:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="sc">&gt;</span> ab <span class="ot">&lt;-</span> a <span class="sc">%o%</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>An alternative is</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="sc">&gt;</span> ab <span class="ot">&lt;-</span> <span class="fu">outer</span>(a, b, <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The multiplication function can be replaced by an arbitrary function of two variables. For example if we wished to evaluate the function f(x; y) = cos(y)/(1 + x^2) over a regular grid of values with <em>x</em>- and <em>y</em>-coordinates defined by the R vectors <code>x</code> and <code>y</code> respectively, we could proceed as follows:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="sc">&gt;</span> f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">cos</span>(y)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="sc">&gt;</span> z <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In particular the outer product of two ordinary vectors is a doubly subscripted array (that is a matrix, of rank at most 1). Notice that the outer product operator is of course non-commutative. Defining your own R functions will be considered further in <a href="#sec-writing-your-own-functions">Section&nbsp;10</a> .</p>
<section id="sec-an-example:-determinants-of-2-by-2-single-digit-matrices" class="level3">
<h3 class="anchored" data-anchor-id="sec-an-example:-determinants-of-2-by-2-single-digit-matrices">An example: Determinants of 2 by 2 single-digit matrices</h3>
<p>As an artificial but cute example, consider the determinants of <em>2</em> by <em>2</em> matrices <em>[a, b; c, d]</em> where each entry is a non-negative integer in the range <em>0, 1, …, 9</em>, that is a digit.</p>
<p>The problem is to find the determinants, <em>ad - bc</em>, of all possible matrices of this form and represent the frequency with which each value occurs as a <em>high density</em> plot. This amounts to finding the probability distribution of the determinant if each digit is chosen independently and uniformly at random.</p>
<p>A neat way of doing this uses the <code>outer()</code> function twice:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="sc">&gt;</span> d <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="sc">&gt;</span> fr <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">outer</span>(d, d, <span class="st">"-"</span>))</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(fr, <span class="at">xlab=</span><span class="st">"Determinant"</span>, <span class="at">ylab=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that <code>plot()</code> here uses a histogram like plot method, because it “sees” that <code>fr</code> is of class <code>"table"</code>. The “obvious” way of doing this problem with <code>for</code> loops, to be discussed in <a href="Loops-and-conditional-execution.html">Loops and conditional execution</a>, is so inefficient as to be impractical.</p>
<p>It is also perhaps surprising that about 1 in 20 such matrices is singular.</p>
</section>
</section>
<section id="sec-generalized-transpose-of-an-array" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="sec-generalized-transpose-of-an-array"><span class="header-section-number">5.6</span> Generalized transpose of an array</h2>
<p>The function <code>aperm(a, perm)</code> may be used to permute an array, <code>a</code>. The argument <code>perm</code> must be a permutation of the integers <em>{1, …, k}</em>, where <em>k</em> is the number of subscripts in <code>a</code>. The result of the function is an array of the same size as <code>a</code> but with old dimension given by <code>perm[j]</code> becoming the new <code>j</code>-th dimension. The easiest way to think of this operation is as a generalization of transposition for matrices. Indeed if <code>A</code> is a matrix, (that is, a doubly subscripted array) then <code>B</code> given by</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="sc">&gt;</span> B <span class="ot">&lt;-</span> <span class="fu">aperm</span>(A, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is just the transpose of <code>A</code>. For this special case a simpler function <code>t()</code> is available, so we could have used <code>B &lt;- t(A)</code>.</p>
</section>
<section id="sec-matrix-facilities" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-matrix-facilities"><span class="header-section-number">5.7</span> Matrix facilities</h2>
<p>As noted above, a matrix is just an array with two subscripts. However it is such an important special case it needs a separate discussion. R contains many operators and functions that are available only for matrices. For example <code>t(X)</code> is the matrix transpose function, as noted above. The functions <code>nrow(A)</code> and <code>ncol(A)</code> give the number of rows and columns in the matrix <code>A</code> respectively.</p>
<section id="sec-matrix-multiplication" class="level3">
<h3 class="anchored" data-anchor-id="sec-matrix-multiplication">Matrix multiplication</h3>
<p>The operator <code>%*%</code> is used for matrix multiplication. An <em>n</em> by <em>1</em> or <em>1</em> by <em>n</em> matrix may of course be used as an <em>n</em>-vector if in the context such is appropriate. Conversely, vectors which occur in matrix multiplication expressions are automatically promoted either to row or column vectors, whichever is multiplicatively coherent, if possible, (although this is not always unambiguously possible, as we see later).</p>
<p>If, for example, <code>A</code> and <code>B</code> are square matrices of the same size, then</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="sc">&gt;</span> A <span class="sc">*</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is the matrix of element by element products and</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="sc">&gt;</span> A <span class="sc">%*%</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is the matrix product. If <code>x</code> is a vector, then</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="sc">&gt;</span> x <span class="sc">%*%</span> A <span class="sc">%*%</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is a quadratic form.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
<p>The function <code>crossprod()</code> forms “crossproducts”, meaning that <code>crossprod(X, y)</code> is the same as <code>t(X) %*% y</code> but the operation is more efficient. If the second argument to <code>crossprod()</code> is omitted it is taken to be the same as the first.</p>
<p>The meaning of <code>diag()</code> depends on its argument. <code>diag(v)</code>, where <code>v</code> is a vector, gives a diagonal matrix with elements of the vector as the diagonal entries. On the other hand <code>diag(M)</code>, where <code>M</code> is a matrix, gives the vector of main diagonal entries of <code>M</code>. This is the same convention as that used for <code>diag()</code> in <span class="small">MATLAB</span>. Also, somewhat confusingly, if <code>k</code> is a single numeric value then <code>diag(k)</code> is the <code>k</code> by <code>k</code> identity matrix!</p>
</section>
<section id="sec-linear-equations-and-inversion" class="level3">
<h3 class="anchored" data-anchor-id="sec-linear-equations-and-inversion">Linear equations and inversion</h3>
<p>Solving linear equations is the inverse of matrix multiplication. When after</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="sc">&gt;</span> b <span class="ot">&lt;-</span> A <span class="sc">%*%</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>only <code>A</code> and <code>b</code> are given, the vector <code>x</code> is the solution of that linear equation system. In R,</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="sc">&gt;</span> <span class="fu">solve</span>(A,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>solves the system, returning <code>x</code> (up to some accuracy loss). Note that in linear algebra, formally <code>x = A^{-1} %*% b</code> where <code>A^{-1}</code> denotes the <em>inverse</em> of <code>A</code>, which can be computed by</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">solve</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>but rarely is needed. Numerically, it is both inefficient and potentially unstable to compute <code>x &lt;- solve(A) %*% b</code> instead of <code>solve(A,b)</code>.</p>
<p>The quadratic form &nbsp;<code>x %*% A^{-1} %*% x</code> &nbsp; which is used in multivariate computations, should be computed by something like<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> <code>x %*% solve(A,x)</code>, rather than computing the inverse of <code>A</code>.</p>
</section>
<section id="sec-eigenvalues-and-eigenvectors" class="level3">
<h3 class="anchored" data-anchor-id="sec-eigenvalues-and-eigenvectors">Eigenvalues and eigenvectors</h3>
<p>The function <code>eigen(Sm)</code> calculates the eigenvalues and eigenvectors of a symmetric matrix <code>Sm</code>. The result of this function is a list of two components named <code>values</code> and <code>vectors</code>. The assignment</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="sc">&gt;</span> ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will assign this list to <code>ev</code>. Then <code>ev$val</code> is the vector of eigenvalues of <code>Sm</code> and <code>ev$vec</code> is the matrix of corresponding eigenvectors. Had we only needed the eigenvalues we could have used the assignment:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="sc">&gt;</span> evals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sm)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>evals</code> now holds the vector of eigenvalues and the second component is discarded. If the expression</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="sc">&gt;</span> <span class="fu">eigen</span>(Sm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>is used by itself as a command the two components are printed, with their names. For large matrices it is better to avoid computing the eigenvectors if they are not needed by using the expression</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="sc">&gt;</span> evals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sm, <span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-singular-value-decomposition-and-determinants" class="level3">
<h3 class="anchored" data-anchor-id="sec-singular-value-decomposition-and-determinants">Singular value decomposition and determinants</h3>
<p>The function <code>svd(M)</code> takes an arbitrary matrix argument, <code>M</code>, and calculates the singular value decomposition of <code>M</code>. This consists of a matrix of orthonormal columns <code>U</code> with the same column space as <code>M</code>, a second matrix of orthonormal columns <code>V</code> whose column space is the row space of <code>M</code> and a diagonal matrix of positive entries <code>D</code> such that <code>M = U %*% D %*% t(V)</code>. <code>D</code> is actually returned as a vector of the diagonal elements. The result of <code>svd(M)</code> is actually a list of three components named <code>d</code>, <code>u</code> and <code>v</code>, with evident meanings.</p>
<p>If <code>M</code> is in fact square, then, it is not hard to see that</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="sc">&gt;</span> absdetM <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">svd</span>(M)<span class="sc">$</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>calculates the absolute value of the determinant of <code>M</code>. If this calculation were needed often with a variety of matrices it could be defined as an R function</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="sc">&gt;</span> absdet <span class="ot">&lt;-</span> <span class="cf">function</span>(M) <span class="fu">prod</span>(<span class="fu">svd</span>(M)<span class="sc">$</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>after which we could use <code>absdet()</code> as just another R function. As a further trivial but potentially useful example, you might like to consider writing a function, say <code>tr()</code>, to calculate the trace of a square matrix. [Hint: You will not need to use an explicit loop. Look again at the <code>diag()</code> function.]</p>
<p>R has a builtin function <code>det</code> to calculate a determinant, including the sign, and another, <code>determinant</code>, to give the sign and modulus (optionally on log scale),</p>
</section>
<section id="sec-least-squares-fitting-and-the-qr-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="sec-least-squares-fitting-and-the-qr-decomposition">Least squares fitting and the QR decomposition</h3>
<p>The function <code>lsfit()</code> returns a list giving results of a least squares fitting procedure. An assignment such as</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">lsfit</span>(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>gives the results of a least squares fit where <code>y</code> is the vector of observations and <code>X</code> is the design matrix. See the help facility for more details, and also for the follow-up function <code>ls.diag()</code> for, among other things, regression diagnostics. Note that a grand mean term is automatically included and need not be included explicitly as a column of <code>X</code>. Further note that you almost always will prefer using <code>lm(.)</code> (see <a href="Linear-models.html">Linear models</a>) to <code>lsfit()</code> for regression modelling.</p>
<p>Another closely related function is <code>qr()</code> and its allies. Consider the following assignments</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="sc">&gt;</span> Xplus <span class="ot">&lt;-</span> <span class="fu">qr</span>(X)</span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="sc">&gt;</span> b <span class="ot">&lt;-</span> <span class="fu">qr.coef</span>(Xplus, y)</span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="sc">&gt;</span> fit <span class="ot">&lt;-</span> <span class="fu">qr.fitted</span>(Xplus, y)</span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="sc">&gt;</span> res <span class="ot">&lt;-</span> <span class="fu">qr.resid</span>(Xplus, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These compute the orthogonal projection of <code>y</code> onto the range of <code>X</code> in <code>fit</code>, the projection onto the orthogonal complement in <code>res</code> and the coefficient vector for the projection in <code>b</code>, that is, <code>b</code> is essentially the result of the <span class="small">MATLAB</span> ‘backslash’ operator.</p>
<p>It is not assumed that <code>X</code> has full column rank. Redundancies will be discovered and removed as they are found.</p>
<p>This alternative is the older, low-level way to perform least squares calculations. Although still useful in some contexts, it would now generally be replaced by the statistical models features, as will be discussed in <a href="Statistical-models-in-R.html">Statistical models in R</a>.</p>
</section>
</section>
<section id="forming-partitioned-matrices-cbind-and-rbind-sec-forming-partitioned-matrices-cbind-and-rbind" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="forming-partitioned-matrices-cbind-and-rbind-sec-forming-partitioned-matrices-cbind-and-rbind"><span class="header-section-number">5.8</span> Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code> {#sec-forming-partitioned-matrices-<code>cbind()</code>-and-<code>rbind()</code>}</h2>
<p>As we have already seen informally, matrices can be built up from other vectors and matrices by the functions <code>cbind()</code> and <code>rbind()</code>. Roughly <code>cbind()</code> forms matrices by binding together matrices horizontally, or column-wise, and <code>rbind()</code> vertically, or row-wise.</p>
<p>In the assignment</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="sc">&gt;</span> X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(arg_1, arg_2, arg_3, …)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>the arguments to <code>cbind()</code> must be either vectors of any length, or matrices with the same column size, that is the same number of rows. The result is a matrix with the concatenated arguments <var>arg_1</var>, <var>arg_2</var>, … forming the columns.</p>
<p>If some of the arguments to <code>cbind()</code> are vectors they may be shorter than the column size of any matrices present, in which case they are cyclically extended to match the matrix column size (or the length of the longest vector if no matrices are given).</p>
<p>The function <code>rbind()</code> does the corresponding operation for rows. In this case any vector argument, possibly cyclically extended, are of course taken as row vectors.</p>
<p>Suppose <code>X1</code> and <code>X2</code> have the same number of rows. To combine these by columns into a matrix <code>X</code>, together with an initial column of <code>1</code>s we can use</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="sc">&gt;</span> X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X1, X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result of <code>rbind()</code> or <code>cbind()</code> always has matrix status. Hence <code>cbind(x)</code> and <code>rbind(x)</code> are possibly the simplest ways explicitly to allow the vector <code>x</code> to be treated as a column or row matrix respectively.</p>
</section>
<section id="the-concatenation-function-c-with-arrays-sec-the-concatenation-function-c-with-arrays" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="the-concatenation-function-c-with-arrays-sec-the-concatenation-function-c-with-arrays"><span class="header-section-number">5.9</span> The concatenation function, <code>c()</code>, with arrays {#sec-the-concatenation-function-<code>c()</code>-with-arrays}</h2>
<p>It should be noted that whereas <code>cbind()</code> and <code>rbind()</code> are concatenation functions that respect <code>dim</code> attributes, the basic <code>c()</code> function does not, but rather clears numeric objects of all <code>dim</code> and <code>dimnames</code> attributes. This is occasionally useful in its own right.</p>
<p>The official way to coerce an array back to a simple vector object is to use <code>as.vector()</code></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="sc">&gt;</span> vec <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However a similar result can be achieved by using <code>c()</code> with just one argument, simply for this side-effect:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="sc">&gt;</span> vec <span class="ot">&lt;-</span> <span class="fu">c</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There are slight differences between the two, but ultimately the choice between them is largely a matter of style (with the former being preferable).</p>
</section>
<section id="sec-frequency-tables-from-factors" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="sec-frequency-tables-from-factors"><span class="header-section-number">5.10</span> Frequency tables from factors</h2>
<p>Recall that a factor defines a partition into groups. Similarly a pair of factors defines a two way cross classification, and so on. The function <code>table()</code> allows frequency tables to be calculated from equal length factors. If there are <em>k</em> factor arguments, the result is a <em>k</em>-way array of frequencies.</p>
<p>Suppose, for example, that <code>statef</code> is a factor giving the state code for each entry in a data vector. The assignment</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="sc">&gt;</span> statefr <span class="ot">&lt;-</span> <span class="fu">table</span>(statef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>gives in <code>statefr</code> a table of frequencies of each state in the sample. The frequencies are ordered and labelled by the <code>levels</code> attribute of the factor. This simple case is equivalent to, but more convenient than,</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="sc">&gt;</span> statefr <span class="ot">&lt;-</span> <span class="fu">tapply</span>(statef, statef, length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Further suppose that <code>incomef</code> is a factor giving a suitably defined “income class” for each entry in the data vector, for example with the <code>cut()</code> function:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="sc">&gt;</span> <span class="fu">factor</span>(<span class="fu">cut</span>(incomes, <span class="at">breaks =</span> <span class="dv">35</span><span class="sc">+</span><span class="dv">10</span><span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))) <span class="ot">-&gt;</span> incomef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then to calculate a two-way table of frequencies:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="sc">&gt;</span> <span class="fu">table</span>(incomef,statef)</span>
<span id="cb100-2"><a href="#cb100-2"></a>         statef</span>
<span id="cb100-3"><a href="#cb100-3"></a>incomef   act nsw nt qld sa tas vic wa</span>
<span id="cb100-4"><a href="#cb100-4"></a>  (<span class="dv">35</span>,<span class="dv">45</span>]   <span class="dv">1</span>   <span class="dv">1</span>  <span class="dv">0</span>   <span class="dv">1</span>  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">1</span>  <span class="dv">0</span></span>
<span id="cb100-5"><a href="#cb100-5"></a>  (<span class="dv">45</span>,<span class="dv">55</span>]   <span class="dv">1</span>   <span class="dv">1</span>  <span class="dv">1</span>   <span class="dv">1</span>  <span class="dv">2</span>   <span class="dv">0</span>   <span class="dv">1</span>  <span class="dv">3</span></span>
<span id="cb100-6"><a href="#cb100-6"></a>  (<span class="dv">55</span>,<span class="dv">65</span>]   <span class="dv">0</span>   <span class="dv">3</span>  <span class="dv">1</span>   <span class="dv">3</span>  <span class="dv">2</span>   <span class="dv">2</span>   <span class="dv">2</span>  <span class="dv">1</span></span>
<span id="cb100-7"><a href="#cb100-7"></a>  (<span class="dv">65</span>,<span class="dv">75</span>]   <span class="dv">0</span>   <span class="dv">1</span>  <span class="dv">0</span>   <span class="dv">0</span>  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">1</span>  <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Extension to higher-way frequency tables is immediate.</p>
</section>
</section>
<section id="sec-lists-and-data-frames" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Lists and data frames</h1>
<section id="sec-lists" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-lists"><span class="header-section-number">6.1</span> Lists</h2>
<p>An R <em>list</em> is an object consisting of an ordered collection of objects known as its <em>components</em>.</p>
<p>There is no particular need for the components to be of the same mode or type, and, for example, a list could consist of a numeric vector, a logical value, a matrix, a complex vector, a character array, a function, and so on. Here is a simple example of how to make a list:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="sc">&gt;</span> Lst <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name=</span><span class="st">"Fred"</span>, <span class="at">wife=</span><span class="st">"Mary"</span>, <span class="at">no.children=</span><span class="dv">3</span>,</span>
<span id="cb101-2"><a href="#cb101-2"></a>              <span class="at">child.ages=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Components are always <em>numbered</em> and may always be referred to as such. Thus if <code>Lst</code> is the name of a list with four components, these may be individually referred to as <code>Lst[[1]]</code>, <code>Lst[[2]]</code>, <code>Lst[[3]]</code> and <code>Lst[[4]]</code>. If, further, <code>Lst[[4]]</code> is a vector subscripted array then <code>Lst[[4]][1]</code> is its first entry.</p>
<p>If <code>Lst</code> is a list, then the function <code>length(Lst)</code> gives the number of (top level) components it has.</p>
<p>Components of lists may also be <em>named</em>, and in this case the component may be referred to either by giving the component name as a character string in place of the number in double square brackets, or, more conveniently, by giving an expression of the form</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="sc">&gt;</span> name<span class="sc">$</span>component_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>for the same thing.</p>
<p>This is a very useful convention as it makes it easier to get the right component if you forget the number.</p>
<p>So in the simple example given above:</p>
<p><code>Lst$name</code> is the same as <code>Lst[[1]]</code> and is the string <code>"Fred"</code>,</p>
<p><code>Lst$wife</code> is the same as <code>Lst[[2]]</code> and is the string <code>"Mary"</code>,</p>
<p><code>Lst$child.ages[1]</code> is the same as <code>Lst[[4]][1]</code> and is the number <code>4</code>.</p>
<p>Additionally, one can also use the names of the list components in double square brackets, i.e., <code>Lst[["name"]]</code> is the same as <code>Lst$name</code>. This is especially useful, when the name of the component to be extracted is stored in another variable as in</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="st">"name"</span>; Lst[[x]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is very important to distinguish <code>Lst[[1]]</code> from <code>Lst[1]</code>. <var>[[``…</var><code>]]</code> is the operator used to select a single element, whereas <var>[``…</var><code>]</code> is a general subscripting operator. Thus the former is the <em>first object in the list</em> <code>Lst</code>, and if it is a named list the name is <em>not</em> included. The latter is a <em>sublist of the list <code>Lst</code> consisting of the first entry only. If it is a named list, the names are transferred to the sublist.</em></p>
<p>The names of components may be abbreviated down to the minimum number of letters needed to identify them uniquely. Thus <code>Lst$coefficients</code> may be minimally specified as <code>Lst$coe</code> and <code>Lst$covariance</code> as <code>Lst$cov</code>.</p>
<p>The vector of names is in fact simply an attribute of the list like any other and may be handled as such. Other structures besides lists may, of course, similarly be given a <em>names</em> attribute also.</p>
</section>
<section id="sec-constructing-and-modifying-lists" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-constructing-and-modifying-lists"><span class="header-section-number">6.2</span> Constructing and modifying lists</h2>
<p>New lists may be formed from existing objects by the function <code>list()</code>. An assignment of the form</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="sc">&gt;</span> Lst <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name_1=</span>object_1, …, <span class="at">name_m=</span>object_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>sets up a list <code>Lst</code> of <em>m</em> components using <var>object_1</var>, …, <var>object_m</var> for the components and giving them names as specified by the argument names, (which can be freely chosen). If these names are omitted, the components are numbered only. The components used to form the list are <em>copied</em> when forming the new list and the originals are not affected.</p>
<p>Lists, like any subscripted object, can be extended by specifying additional components. For example</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="sc">&gt;</span> Lst[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">matrix=</span>Mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="sec-concatenating-lists" class="level3">
<h3 class="anchored" data-anchor-id="sec-concatenating-lists">Concatenating lists</h3>
<p>When the concatenation function <code>c()</code> is given list arguments, the result is an object of mode list also, whose components are those of the argument lists joined together in sequence.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="sc">&gt;</span> list.ABC <span class="ot">&lt;-</span> <span class="fu">c</span>(list.A, list.B, list.C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Recall that with vector objects as arguments the concatenation function similarly joined together all arguments into a single vector structure. In this case all other attributes, such as <code>dim</code> attributes, are discarded.</p>
</section>
</section>
<section id="sec-data-frames" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-data-frames"><span class="header-section-number">6.3</span> Data frames</h2>
<p>A <em>data frame</em> is a list with class <code>"data.frame"</code>. There are restrictions on lists that may be made into data frames, namely</p>
<ul>
<li>The components must be vectors (numeric, character, or logical), factors, numeric matrices, lists, or other data frames.</li>
<li>Matrices, lists, and data frames provide as many variables to the new data frame as they have columns, elements, or variables, respectively.</li>
<li>Vector structures appearing as variables of the data frame must all have the <em>same length</em>, and matrix structures must all have the <em>same number of rows</em>.</li>
</ul>
<p>A data frame may for many purposes be regarded as a matrix with columns possibly of differing modes and attributes. It may be displayed in matrix form, and its rows and columns extracted using matrix indexing conventions.</p>
<section id="sec-making-data-frames" class="level3">
<h3 class="anchored" data-anchor-id="sec-making-data-frames">Making data frames</h3>
<p>Objects satisfying the restrictions placed on the columns (components) of a data frame may be used to form one using the function <code>data.frame</code>:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="sc">&gt;</span> accountants <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">home=</span>statef, <span class="at">loot=</span>incomes, <span class="at">shot=</span>incomef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A list whose components conform to the restrictions of a data frame may be <em>coerced</em> into a data frame using the function <code>as.data.frame()</code></p>
<p>The simplest way to construct a data frame from scratch is to use the <code>read.table()</code> function to read an entire data frame from an external file. This is discussed further in <a href="Reading-data-from-files.html">Reading data from files</a>.</p>
</section>
<section id="attach-and-detach-sec-attach-and-detach" class="level3">
<h3 class="anchored" data-anchor-id="attach-and-detach-sec-attach-and-detach"><code>attach()</code> and <code>detach()</code> {#sec-<code>attach()</code>-and-<code>detach()</code>}</h3>
<p>The <code>$</code> notation, such as <code>accountants$home</code>, for list components is not always very convenient. A useful facility would be somehow to make the components of a list or data frame temporarily visible as variables under their component name, without the need to quote the list name explicitly each time.</p>
<p>The <code>attach()</code> function takes a ‘database’ such as a list or data frame as its argument. Thus suppose <code>lentils</code> is a data frame with three variables <code>lentils$u</code>, <code>lentils$v</code>, <code>lentils$w</code>. The attach</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="sc">&gt;</span> <span class="fu">attach</span>(lentils)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>places the data frame in the search path at position&nbsp;2, and provided there are no variables <code>u</code>, <code>v</code> or <code>w</code> in position&nbsp;1, <code>u</code>, <code>v</code> and <code>w</code> are available as variables from the data frame in their own right. At this point an assignment such as</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="sc">&gt;</span> u <span class="ot">&lt;-</span> v<span class="sc">+</span>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>does not replace the component <code>u</code> of the data frame, but rather masks it with another variable <code>u</code> in the working directory at position&nbsp;1 on the search path. To make a permanent change to the data frame itself, the simplest way is to resort once again to the <code>$</code> notation:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="sc">&gt;</span> lentils<span class="sc">$</span>u <span class="ot">&lt;-</span> v<span class="sc">+</span>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However the new value of component <code>u</code> is not visible until the data frame is detached and attached again.</p>
<p>To detach a data frame, use the function</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="sc">&gt;</span> <span class="fu">detach</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More precisely, this statement detaches from the search path the entity currently at position&nbsp;2. Thus in the present context the variables <code>u</code>, <code>v</code> and <code>w</code> would be no longer visible, except under the list notation as <code>lentils$u</code> and so on. Entities at positions greater than 2 on the search path can be detached by giving their number to <code>detach</code>, but it is much safer to always use a name, for example by <code>detach(lentils)</code> or <code>detach("lentils")</code></p>
<blockquote class="blockquote">
<p><strong>Note:</strong> In R lists and data frames can only be attached at position 2 or above, and what is attached is a <em>copy</em> of the original object. You can alter the attached values <em>via</em> <code>assign</code>, but the original list or data frame is unchanged.</p>
</blockquote>
</section>
<section id="sec-working-with-data-frames" class="level3">
<h3 class="anchored" data-anchor-id="sec-working-with-data-frames">Working with data frames</h3>
<p>A useful convention that allows you to work with many different problems comfortably together in the same working directory is</p>
<ul>
<li>gather together all variables for any well defined and separate problem in a data frame under a suitably informative name;</li>
<li>when working with a problem attach the appropriate data frame at position&nbsp;2, and use the working directory at level&nbsp;1 for operational quantities and temporary variables;</li>
<li>before leaving a problem, add any variables you wish to keep for future reference to the data frame using the <code>$</code> form of assignment, and then <code>detach()</code>;</li>
<li>finally remove all unwanted variables from the working directory and keep it as clean of left-over temporary variables as possible.</li>
</ul>
<p>In this way it is quite simple to work with many problems in the same directory, all of which have variables named <code>x</code>, <code>y</code> and <code>z</code>, for example.</p>
</section>
<section id="sec-attaching-arbitrary-lists" class="level3">
<h3 class="anchored" data-anchor-id="sec-attaching-arbitrary-lists">Attaching arbitrary lists</h3>
<p><code>attach()</code> is a generic function that allows not only directories and data frames to be attached to the search path, but other classes of object as well. In particular any object of mode <code>"list"</code> may be attached in the same way:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="sc">&gt;</span> <span class="fu">attach</span>(any.old.list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Anything that has been attached can be detached by <code>detach</code>, by position number or, preferably, by name.</p>
</section>
<section id="sec-managing-the-search-path" class="level3">
<h3 class="anchored" data-anchor-id="sec-managing-the-search-path">Managing the search path</h3>
<p>The function <code>search</code> shows the current search path and so is a very useful way to keep track of which data frames and lists (and packages) have been attached and detached. Initially it gives</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="sc">&gt;</span> <span class="fu">search</span>()</span>
<span id="cb113-2"><a href="#cb113-2"></a>[<span class="dv">1</span>] <span class="st">".GlobalEnv"</span>   <span class="st">"Autoloads"</span>    <span class="st">"package:base"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <code>.GlobalEnv</code> is the workspace.<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p>
<p>After <code>lentils</code> is attached we have</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="sc">&gt;</span> <span class="fu">search</span>()</span>
<span id="cb114-2"><a href="#cb114-2"></a>[<span class="dv">1</span>] <span class="st">".GlobalEnv"</span>   <span class="st">"lentils"</span>      <span class="st">"Autoloads"</span>    <span class="st">"package:base"</span></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="sc">&gt;</span> <span class="fu">ls</span>(<span class="dv">2</span>)</span>
<span id="cb114-4"><a href="#cb114-4"></a>[<span class="dv">1</span>] <span class="st">"u"</span> <span class="st">"v"</span> <span class="st">"w"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and as we see <code>ls</code> (or <code>objects</code>) can be used to examine the contents of any position on the search path.</p>
<p>Finally, we detach the data frame and confirm it has been removed from the search path.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="sc">&gt;</span> <span class="fu">detach</span>(<span class="st">"lentils"</span>)</span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="sc">&gt;</span> <span class="fu">search</span>()</span>
<span id="cb115-3"><a href="#cb115-3"></a>[<span class="dv">1</span>] <span class="st">".GlobalEnv"</span>   <span class="st">"Autoloads"</span>    <span class="st">"package:base"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="sec-reading-data-from-files" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Reading data from files</h1>
<p>Large data objects will usually be read as values from external files rather than entered during an R session at the keyboard. R input facilities are simple and their requirements are fairly strict and even rather inflexible. There is a clear presumption by the designers of R that you will be able to modify your input files using other tools, such as file editors or Perl<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> to fit in with the requirements of R. Generally this is very simple.</p>
<p>If variables are to be held mainly in data frames, as we strongly suggest they should be, an entire data frame can be read directly with the <code>read.table()</code> function. There is also a more primitive input function, <code>scan()</code>, that can be called directly.</p>
<p>For more details on importing data into R and also exporting data, see the <em>R Data Import/Export</em> manual.</p>
<section id="the-read.table-function-sec-the-read.table-function" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="the-read.table-function-sec-the-read.table-function"><span class="header-section-number">7.1</span> The <code>read.table()</code> function {#sec-the-<code>read.table()</code>-function}</h2>
<p>To read an entire data frame directly, the external file will normally have a special form.</p>
<ul>
<li>The first line of the file should have a <em>name</em> for each variable in the data frame.</li>
<li>Each additional line of the file has as its first item a <em>row label</em> and the values for each variable.</li>
</ul>
<p>If the file has one fewer item in its first line than in its second, this arrangement is presumed to be in force. So the first few lines of a file to be read as a data frame might look as follows.</p>
<div class="blockquotes-block">
<blockquote class="blockquote">
<table class="table">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>Input file form with names and row labels<span class="sc">:</span></span>
<span id="cb116-2"><a href="#cb116-2"></a></span>
<span id="cb116-3"><a href="#cb116-3"></a>     Price    Floor     Area   Rooms     Age  Cent.heat</span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="dv">01</span>   <span class="fl">52.00</span>    <span class="fl">111.0</span>      <span class="dv">830</span>     <span class="dv">5</span>       <span class="fl">6.2</span>      no</span>
<span id="cb116-5"><a href="#cb116-5"></a><span class="dv">02</span>   <span class="fl">54.75</span>    <span class="fl">128.0</span>      <span class="dv">710</span>     <span class="dv">5</span>       <span class="fl">7.5</span>      no</span>
<span id="cb116-6"><a href="#cb116-6"></a><span class="dv">03</span>   <span class="fl">57.50</span>    <span class="fl">101.0</span>     <span class="dv">1000</span>     <span class="dv">5</span>       <span class="fl">4.2</span>      no</span>
<span id="cb116-7"><a href="#cb116-7"></a><span class="dv">04</span>   <span class="fl">57.50</span>    <span class="fl">131.0</span>      <span class="dv">690</span>     <span class="dv">6</span>       <span class="fl">8.8</span>      no</span>
<span id="cb116-8"><a href="#cb116-8"></a><span class="dv">05</span>   <span class="fl">59.75</span>     <span class="fl">93.0</span>      <span class="dv">900</span>     <span class="dv">5</span>       <span class="fl">1.9</span>     yes</span>
<span id="cb116-9"><a href="#cb116-9"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></td>
</tr>
</tbody>
</table>
</blockquote>
</div>
<p>By default numeric items (except row labels) are read as numeric variables and non-numeric variables, such as <code>Cent.heat</code> in the example, as character variables. This can be changed if necessary.</p>
<p>The function <code>read.table()</code> can then be used to read the data frame directly</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="sc">&gt;</span> HousePrice <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"houses.data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Often you will want to omit including the row labels directly and use the default labels. In this case the file may omit the row label column as in the following.</p>
<div class="blockquotes-block">
<blockquote class="blockquote">
<table class="table">
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>Input file form without row labels<span class="sc">:</span></span>
<span id="cb118-2"><a href="#cb118-2"></a></span>
<span id="cb118-3"><a href="#cb118-3"></a>Price    Floor     Area   Rooms     Age  Cent.heat</span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="fl">52.00</span>    <span class="fl">111.0</span>      <span class="dv">830</span>     <span class="dv">5</span>       <span class="fl">6.2</span>      no</span>
<span id="cb118-5"><a href="#cb118-5"></a><span class="fl">54.75</span>    <span class="fl">128.0</span>      <span class="dv">710</span>     <span class="dv">5</span>       <span class="fl">7.5</span>      no</span>
<span id="cb118-6"><a href="#cb118-6"></a><span class="fl">57.50</span>    <span class="fl">101.0</span>     <span class="dv">1000</span>     <span class="dv">5</span>       <span class="fl">4.2</span>      no</span>
<span id="cb118-7"><a href="#cb118-7"></a><span class="fl">57.50</span>    <span class="fl">131.0</span>      <span class="dv">690</span>     <span class="dv">6</span>       <span class="fl">8.8</span>      no</span>
<span id="cb118-8"><a href="#cb118-8"></a><span class="fl">59.75</span>     <span class="fl">93.0</span>      <span class="dv">900</span>     <span class="dv">5</span>       <span class="fl">1.9</span>     yes</span>
<span id="cb118-9"><a href="#cb118-9"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></td>
</tr>
</tbody>
</table>
</blockquote>
</div>
<p>The data frame may then be read as</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="sc">&gt;</span> HousePrice <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"houses.data"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where the <code>header=TRUE</code> option specifies that the first line is a line of headings, and hence, by implication from the form of the file, that no explicit row labels are given.</p>
</section>
<section id="the-scan-function-sec-the-scan-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="the-scan-function-sec-the-scan-function"><span class="header-section-number">7.2</span> The <code>scan()</code> function {#sec-the-<code>scan()</code>-function}</h2>
<p>Suppose the data vectors are of equal length and are to be read in parallel. Further suppose that there are three vectors, the first of mode character and the remaining two of mode numeric, and the file is <code>input.dat</code>. The first step is to use <code>scan()</code> to read in the three vectors as a list, as follows</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="sc">&gt;</span> inp <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"input.dat"</span>, <span class="fu">list</span>(<span class="st">""</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The second argument is a dummy list structure that establishes the mode of the three vectors to be read. The result, held in <code>inp</code>, is a list whose components are the three vectors read in. To separate the data items into three separate vectors, use assignments like</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="sc">&gt;</span> label <span class="ot">&lt;-</span> inp[[<span class="dv">1</span>]]; x <span class="ot">&lt;-</span> inp[[<span class="dv">2</span>]]; y <span class="ot">&lt;-</span> inp[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More conveniently, the dummy list can have named components, in which case the names can be used to access the vectors read in. For example</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="sc">&gt;</span> inp <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"input.dat"</span>, <span class="fu">list</span>(<span class="at">id=</span><span class="st">""</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you wish to access the variables separately they may either be re-assigned to variables in the working frame:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="sc">&gt;</span> label <span class="ot">&lt;-</span> inp<span class="sc">$</span>id; x <span class="ot">&lt;-</span> inp<span class="sc">$</span>x; y <span class="ot">&lt;-</span> inp<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or the list may be attached at position&nbsp;2 of the search path (see <a href="Attaching-arbitrary-lists.html">Attaching arbitrary lists</a>).</p>
<p>If the second argument is a single value and not a list, a single vector is read in, all components of which must be of the same mode as the dummy value.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="sc">&gt;</span> X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">scan</span>(<span class="st">"light.dat"</span>, <span class="dv">0</span>), <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There are more elaborate input facilities available and these are detailed in the manuals.</p>
</section>
<section id="sec-accessing-builtin-datasets" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="sec-accessing-builtin-datasets"><span class="header-section-number">7.3</span> Accessing builtin datasets</h2>
<p>Around 100 datasets are supplied with R (in package <strong>datasets</strong>), and others are available in packages (including the recommended packages supplied with R). To see the list of datasets currently available use</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="fu">data</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All the datasets supplied with R are available directly by name. However, many packages still use the obsolete convention in which <code>data</code> was also used to load datasets into R, for example</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="fu">data</span>(infert)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and this can still be used with the standard packages (as in this example). In most cases this will load an R object of the same name. However, in a few cases it loads several objects, so see the on-line help for the object to see what to expect.</p>
<section id="sec-7.3.1-loading-data-from-other-r-packages" class="level3">
<h3 class="anchored" data-anchor-id="sec-7.3.1-loading-data-from-other-r-packages">7.3.1 Loading data from other R packages</h3>
<p>To access data from a particular package, use the <code>package</code> argument, for example</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="fu">data</span>(<span class="at">package=</span><span class="st">"rpart"</span>)</span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="fu">data</span>(Puromycin, <span class="at">package=</span><span class="st">"datasets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If a package has been attached by <code>library</code>, its datasets are automatically included in the search.</p>
<p>User-contributed packages can be a rich source of datasets.</p>
</section>
</section>
<section id="sec-editing-data" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sec-editing-data"><span class="header-section-number">7.4</span> Editing data</h2>
<p>When invoked on a data frame or matrix, <code>edit</code> brings up a separate spreadsheet-like environment for editing. This is useful for making small changes once a data set has been read. The command</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="sc">&gt;</span> xnew <span class="ot">&lt;-</span> <span class="fu">edit</span>(xold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will allow you to edit your data set <code>xold</code>, and on completion the changed object is assigned to <code>xnew</code>. If you want to alter the original dataset <code>xold</code>, the simplest way is to use <code>fix(xold)</code>, which is equivalent to <code>xold &lt;- edit(xold)</code>.</p>
<p>Use</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="sc">&gt;</span> xnew <span class="ot">&lt;-</span> <span class="fu">edit</span>(<span class="fu">data.frame</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to enter new data via the spreadsheet interface.</p>
</section>
</section>
<section id="sec-probability-distributions" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Probability distributions</h1>
<section id="sec-r-as-a-set-of-statistical-tables" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sec-r-as-a-set-of-statistical-tables"><span class="header-section-number">8.1</span> R as a set of statistical tables</h2>
<p>One convenient use of R is to provide a comprehensive set of statistical tables. Functions are provided to evaluate the cumulative distribution function P(X &lt;= x), the probability density function and the quantile function (given <em>q</em>, the smallest <em>x</em> such that P(X &lt;= x) &gt; q), and to simulate from the distribution.</p>
<div class="blockquotes-block">
<blockquote class="blockquote">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Distribution</th>
<th style="text-align: left;">R name</th>
<th style="text-align: left;">additional arguments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><code>beta</code></td>
<td style="text-align: left;"><code>shape1, shape2, ncp</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">binomial</td>
<td style="text-align: left;"><code>binom</code></td>
<td style="text-align: left;"><code>size, prob</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cauchy</td>
<td style="text-align: left;"><code>cauchy</code></td>
<td style="text-align: left;"><code>location, scale</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">chi-squared</td>
<td style="text-align: left;"><code>chisq</code></td>
<td style="text-align: left;"><code>df, ncp</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">exponential</td>
<td style="text-align: left;"><code>exp</code></td>
<td style="text-align: left;"><code>rate</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: left;"><code>f</code></td>
<td style="text-align: left;"><code>df1, df2, ncp</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">gamma</td>
<td style="text-align: left;"><code>gamma</code></td>
<td style="text-align: left;"><code>shape, scale</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">geometric</td>
<td style="text-align: left;"><code>geom</code></td>
<td style="text-align: left;"><code>prob</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">hypergeometric</td>
<td style="text-align: left;"><code>hyper</code></td>
<td style="text-align: left;"><code>m, n, k</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">log-normal</td>
<td style="text-align: left;"><code>lnorm</code></td>
<td style="text-align: left;"><code>meanlog, sdlog</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">logistic</td>
<td style="text-align: left;"><code>logis</code></td>
<td style="text-align: left;"><code>location, scale</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">negative binomial</td>
<td style="text-align: left;"><code>nbinom</code></td>
<td style="text-align: left;"><code>size, prob</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">normal</td>
<td style="text-align: left;"><code>norm</code></td>
<td style="text-align: left;"><code>mean, sd</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Poisson</td>
<td style="text-align: left;"><code>pois</code></td>
<td style="text-align: left;"><code>lambda</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">signed rank</td>
<td style="text-align: left;"><code>signrank</code></td>
<td style="text-align: left;"><code>n</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Student’s t</td>
<td style="text-align: left;"><code>t</code></td>
<td style="text-align: left;"><code>df, ncp</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">uniform</td>
<td style="text-align: left;"><code>unif</code></td>
<td style="text-align: left;"><code>min, max</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Weibull</td>
<td style="text-align: left;"><code>weibull</code></td>
<td style="text-align: left;"><code>shape, scale</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wilcoxon</td>
<td style="text-align: left;"><code>wilcox</code></td>
<td style="text-align: left;"><code>m, n</code></td>
</tr>
</tbody>
</table>
</blockquote>
</div>
<p>Prefix the name given here by ‘<code>d</code>’ for the density, ‘<code>p</code>’ for the CDF, ‘<code>q</code>’ for the quantile function and ‘<code>r</code>’ for simulation (<em>r</em>andom deviates). The first argument is <code>x</code> for <var>d``xxx</var>, <code>q</code> for <var>p``xxx</var>, <code>p</code> for <var>q``xxx</var> and <code>n</code> for <var>r``xxx</var> (except for <code>rhyper</code>, <code>rsignrank</code> and <code>rwilcox</code>, for which it is <code>nn</code>). In not quite all cases is the non-centrality parameter <code>ncp</code> currently available: see the on-line help for details.</p>
<p>The <var>p``xxx</var> and <var>q``xxx</var> functions all have logical arguments <code>lower.tail</code> and <code>log.p</code> and the <var>d``xxx</var> ones have <code>log</code>. This allows, e.g., getting the cumulative (or “integrated”) <em>hazard</em> function, H(t) = - log(1 - F(t)), by</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a> <span class="sc">-</span> <span class="fu">pxxx</span>(t, ..., <span class="at">lower.tail =</span> <span class="cn">FALSE</span>, <span class="at">log.p =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or more accurate log-likelihoods (by <var>d``xxx</var><code>(..., log = TRUE)</code>), directly.</p>
<p>In addition there are functions <code>ptukey</code> and <code>qtukey</code> for the distribution of the studentized range of samples from a normal distribution, and <code>dmultinom</code> and <code>rmultinom</code> for the multinomial distribution. Further distributions are available in contributed packages, notably <a href="https://CRAN.R-project.org/package=SuppDists"><strong>SuppDists</strong></a>.</p>
<p>Here are some examples</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb131-1"><a href="#cb131-1"></a><span class="op">&gt;</span> ## <span class="dv">2</span><span class="op">-</span>tailed p<span class="op">-</span>value <span class="cf">for</span> t distribution</span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="op">&gt;</span> <span class="dv">2</span><span class="op">*</span>pt<span class="op">(-</span><span class="fl">2.43</span><span class="op">,</span> df <span class="op">=</span> <span class="dv">13</span><span class="op">)</span></span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="op">&gt;</span> ## upper <span class="dv">1</span><span class="op">%</span> point <span class="cf">for</span> an F<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">7</span><span class="op">)</span> distribution</span>
<span id="cb131-4"><a href="#cb131-4"></a><span class="op">&gt;</span> qf<span class="op">(</span><span class="dv">0</span><span class="er">.01</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> lower<span class="op">.</span>tail <span class="op">=</span> FALSE<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See the on-line help on <code>RNG</code> for how random-number generation is done in R.</p>
</section>
<section id="sec-examining-the-distribution-of-a-set-of-data" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sec-examining-the-distribution-of-a-set-of-data"><span class="header-section-number">8.2</span> Examining the distribution of a set of data</h2>
<p>Given a (univariate) set of data we can examine its distribution in a large number of ways. The simplest is to examine the numbers. Two slightly different summaries are given by <code>summary</code> and <code>fivenum</code> and a display of the numbers by <code>stem</code> (a “stem and leaf” plot).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb132-1"><a href="#cb132-1"></a><span class="op">&gt;</span> attach<span class="op">(</span>faithful<span class="op">)</span></span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="op">&gt;</span> summary<span class="op">(</span>eruptions<span class="op">)</span></span>
<span id="cb132-3"><a href="#cb132-3"></a>   Min<span class="op">.</span> <span class="dv">1</span><span class="er">st</span> Qu<span class="op">.</span>  Median    Mean <span class="dv">3</span><span class="er">rd</span> Qu<span class="op">.</span>    Max<span class="op">.</span></span>
<span id="cb132-4"><a href="#cb132-4"></a>  <span class="fl">1.600</span>   <span class="fl">2.163</span>   <span class="fl">4.000</span>   <span class="fl">3.488</span>   <span class="fl">4.454</span>   <span class="fl">5.100</span></span>
<span id="cb132-5"><a href="#cb132-5"></a><span class="op">&gt;</span> fivenum<span class="op">(</span>eruptions<span class="op">)</span></span>
<span id="cb132-6"><a href="#cb132-6"></a><span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="fl">1.6000</span> <span class="fl">2.1585</span> <span class="fl">4.0000</span> <span class="fl">4.4585</span> <span class="fl">5.1000</span></span>
<span id="cb132-7"><a href="#cb132-7"></a><span class="op">&gt;</span> stem<span class="op">(</span>eruptions<span class="op">)</span></span>
<span id="cb132-8"><a href="#cb132-8"></a></span>
<span id="cb132-9"><a href="#cb132-9"></a>  The decimal point is <span class="dv">1</span> digit<span class="op">(</span>s<span class="op">)</span> to the left of the <span class="op">|</span></span>
<span id="cb132-10"><a href="#cb132-10"></a></span>
<span id="cb132-11"><a href="#cb132-11"></a>  <span class="dv">16</span> <span class="op">|</span> <span class="bn">0703555555</span><span class="er">88</span></span>
<span id="cb132-12"><a href="#cb132-12"></a>  <span class="dv">18</span> <span class="op">|</span> <span class="bn">000022233333335577777777</span><span class="er">888822335777888</span></span>
<span id="cb132-13"><a href="#cb132-13"></a>  <span class="dv">20</span> <span class="op">|</span> <span class="bn">0000222337</span><span class="er">8800035778</span></span>
<span id="cb132-14"><a href="#cb132-14"></a>  <span class="dv">22</span> <span class="op">|</span> <span class="bn">000233557</span><span class="er">8023578</span></span>
<span id="cb132-15"><a href="#cb132-15"></a>  <span class="dv">24</span> <span class="op">|</span> <span class="bn">0022</span><span class="er">8</span></span>
<span id="cb132-16"><a href="#cb132-16"></a>  <span class="dv">26</span> <span class="op">|</span> <span class="dv">23</span></span>
<span id="cb132-17"><a href="#cb132-17"></a>  <span class="dv">28</span> <span class="op">|</span> <span class="dv">0</span><span class="er">80</span></span>
<span id="cb132-18"><a href="#cb132-18"></a>  <span class="dv">30</span> <span class="op">|</span> <span class="dv">7</span></span>
<span id="cb132-19"><a href="#cb132-19"></a>  <span class="dv">32</span> <span class="op">|</span> <span class="dv">2337</span></span>
<span id="cb132-20"><a href="#cb132-20"></a>  <span class="dv">34</span> <span class="op">|</span> <span class="dv">250077</span></span>
<span id="cb132-21"><a href="#cb132-21"></a>  <span class="dv">36</span> <span class="op">|</span> <span class="bn">0000</span><span class="er">823577</span></span>
<span id="cb132-22"><a href="#cb132-22"></a>  <span class="dv">38</span> <span class="op">|</span> <span class="dv">2333335582225577</span></span>
<span id="cb132-23"><a href="#cb132-23"></a>  <span class="dv">40</span> <span class="op">|</span> <span class="bn">00000033577</span><span class="er">88888002233555577778</span></span>
<span id="cb132-24"><a href="#cb132-24"></a>  <span class="dv">42</span> <span class="op">|</span> <span class="bn">0333555577</span><span class="er">8800233333555577778</span></span>
<span id="cb132-25"><a href="#cb132-25"></a>  <span class="dv">44</span> <span class="op">|</span> <span class="bn">022223355577</span><span class="er">80000000023333357778888</span></span>
<span id="cb132-26"><a href="#cb132-26"></a>  <span class="dv">46</span> <span class="op">|</span> <span class="bn">000023335770000002357</span><span class="er">8</span></span>
<span id="cb132-27"><a href="#cb132-27"></a>  <span class="dv">48</span> <span class="op">|</span> <span class="bn">00000022335</span><span class="er">800333</span></span>
<span id="cb132-28"><a href="#cb132-28"></a>  <span class="dv">50</span> <span class="op">|</span> <span class="bn">0370</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A stem-and-leaf plot is like a histogram, and R has a function <code>hist</code> to plot histograms.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1"></a><span class="op">&gt;</span> hist<span class="op">(</span>eruptions<span class="op">)</span></span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="pp">#</span><span class="er"># make the bins smaller, make a plot of density</span></span>
<span id="cb133-3"><a href="#cb133-3"></a><span class="op">&gt;</span> hist<span class="op">(</span>eruptions<span class="op">,</span> seq<span class="op">(</span><span class="fl">1.6</span><span class="op">,</span> <span class="fl">5.2</span><span class="op">,</span> <span class="dv">0</span><span class="er">.2</span><span class="op">),</span> prob<span class="op">=</span>TRUE<span class="op">)</span></span>
<span id="cb133-4"><a href="#cb133-4"></a><span class="op">&gt;</span> lines<span class="op">(</span>density<span class="op">(</span>eruptions<span class="op">,</span> bw<span class="op">=</span><span class="dv">0</span><span class="er">.1</span><span class="op">))</span></span>
<span id="cb133-5"><a href="#cb133-5"></a><span class="op">&gt;</span> rug<span class="op">(</span>eruptions<span class="op">)</span> # show the actual data points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More elegant density plots can be made by <code>density</code>, and we added a line produced by <code>density</code> in this example. The bandwidth <code>bw</code> was chosen by trial-and-error as the default gives too much smoothing (it usually does for “interesting” densities). (Better automated methods of bandwidth choice are available, and in this example <code>bw = "SJ"</code> gives a good result.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hist.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/hist</figcaption>
</figure>
</div>
<p>We can plot the empirical cumulative distribution function by using the function <code>ecdf</code>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb134-1"><a href="#cb134-1"></a><span class="op">&gt;</span> plot<span class="op">(</span>ecdf<span class="op">(</span>eruptions<span class="op">),</span> <span class="cf">do</span><span class="op">.</span>points<span class="op">=</span>FALSE<span class="op">,</span> verticals<span class="op">=</span>TRUE<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This distribution is obviously far from any standard distribution. How about the right-hand mode, say eruptions of longer than 3 minutes? Let us fit a normal distribution and overlay the fitted CDF.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb135-1"><a href="#cb135-1"></a><span class="op">&gt;</span> <span class="dt">long</span> <span class="op">&lt;-</span> eruptions<span class="op">[</span>eruptions <span class="op">&gt;</span> <span class="dv">3</span><span class="op">]</span></span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="op">&gt;</span> plot<span class="op">(</span>ecdf<span class="op">(</span><span class="dt">long</span><span class="op">),</span> <span class="cf">do</span><span class="op">.</span>points<span class="op">=</span>FALSE<span class="op">,</span> verticals<span class="op">=</span>TRUE<span class="op">)</span></span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="op">&gt;</span> x <span class="op">&lt;-</span> seq<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="fl">5.4</span><span class="op">,</span> <span class="dv">0</span><span class="er">.01</span><span class="op">)</span></span>
<span id="cb135-4"><a href="#cb135-4"></a><span class="op">&gt;</span> lines<span class="op">(</span>x<span class="op">,</span> pnorm<span class="op">(</span>x<span class="op">,</span> mean<span class="op">=</span>mean<span class="op">(</span><span class="dt">long</span><span class="op">),</span> sd<span class="op">=</span>sqrt<span class="op">(</span>var<span class="op">(</span><span class="dt">long</span><span class="op">))),</span> lty<span class="op">=</span><span class="dv">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ecdf.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/ecdf</figcaption>
</figure>
</div>
<p>Quantile-quantile (Q-Q) plots can help us examine this more carefully.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)       <span class="co"># arrange for a square figure region</span></span>
<span id="cb136-2"><a href="#cb136-2"></a><span class="fu">qqnorm</span>(long); <span class="fu">qqline</span>(long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which shows a reasonable fit but a shorter right tail than one would expect from a normal distribution. Let us compare this with some simulated data from a <em>t</em> distribution</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/QQ.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/QQ</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">250</span>, <span class="at">df =</span> <span class="dv">5</span>)</span>
<span id="cb137-2"><a href="#cb137-2"></a><span class="fu">qqnorm</span>(x); <span class="fu">qqline</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which will usually (if it is a random sample) show longer tails than expected for a normal. We can make a Q-Q plot against the generating distribution by</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb138-1"><a href="#cb138-1"></a>qqplot<span class="op">(</span>qt<span class="op">(</span>ppoints<span class="op">(</span><span class="dv">250</span><span class="op">),</span> df <span class="op">=</span> <span class="dv">5</span><span class="op">),</span> x<span class="op">,</span> xlab <span class="op">=</span> <span class="st">"Q-Q plot for t dsn"</span><span class="op">)</span></span>
<span id="cb138-2"><a href="#cb138-2"></a>qqline<span class="op">(</span>x<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Finally, we might want a more formal test of agreement with normality (or not). R provides the Shapiro-Wilk test</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="sc">&gt;</span> <span class="fu">shapiro.test</span>(long)</span>
<span id="cb139-2"><a href="#cb139-2"></a></span>
<span id="cb139-3"><a href="#cb139-3"></a>         Shapiro<span class="sc">-</span>Wilk normality test</span>
<span id="cb139-4"><a href="#cb139-4"></a></span>
<span id="cb139-5"><a href="#cb139-5"></a>data<span class="sc">:</span>  long</span>
<span id="cb139-6"><a href="#cb139-6"></a>W <span class="ot">=</span> <span class="fl">0.9793</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01052</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and the Kolmogorov-Smirnov test</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="sc">&gt;</span> <span class="fu">ks.test</span>(long, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(long), <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(long)))</span>
<span id="cb140-2"><a href="#cb140-2"></a></span>
<span id="cb140-3"><a href="#cb140-3"></a>         One<span class="sc">-</span>sample Kolmogorov<span class="sc">-</span>Smirnov test</span>
<span id="cb140-4"><a href="#cb140-4"></a></span>
<span id="cb140-5"><a href="#cb140-5"></a>data<span class="sc">:</span>  long</span>
<span id="cb140-6"><a href="#cb140-6"></a>D <span class="ot">=</span> <span class="fl">0.0661</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.4284</span></span>
<span id="cb140-7"><a href="#cb140-7"></a>alternative hypothesis<span class="sc">:</span> two.sided</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Note that the distribution theory is not valid here as we have estimated the parameters of the normal distribution from the same sample.)</p>
</section>
<section id="sec-one--and-two-sample-tests" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="sec-one--and-two-sample-tests"><span class="header-section-number">8.3</span> One- and two-sample tests</h2>
<p>So far we have compared a single sample to a normal distribution. A much more common operation is to compare aspects of two samples. Note that in R, all “classical” tests including the ones used below are in package <strong>stats</strong> which is normally loaded.</p>
<p>Consider the following sets of data on the latent heat of the fusion of ice (<em>cal/gm</em>) from Rice (1995, p.490)</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>Method A<span class="sc">:</span> <span class="fl">79.98</span> <span class="fl">80.04</span> <span class="fl">80.02</span> <span class="fl">80.04</span> <span class="fl">80.03</span> <span class="fl">80.03</span> <span class="fl">80.04</span> <span class="fl">79.97</span></span>
<span id="cb141-2"><a href="#cb141-2"></a>          <span class="fl">80.05</span> <span class="fl">80.03</span> <span class="fl">80.02</span> <span class="fl">80.00</span> <span class="fl">80.02</span></span>
<span id="cb141-3"><a href="#cb141-3"></a>Method B<span class="sc">:</span> <span class="fl">80.02</span> <span class="fl">79.94</span> <span class="fl">79.98</span> <span class="fl">79.97</span> <span class="fl">79.97</span> <span class="fl">80.03</span> <span class="fl">79.95</span> <span class="fl">79.97</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Boxplots provide a simple graphical comparison of the two samples.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>A <span class="ot">&lt;-</span> <span class="fu">scan</span>()</span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="fl">79.98</span> <span class="fl">80.04</span> <span class="fl">80.02</span> <span class="fl">80.04</span> <span class="fl">80.03</span> <span class="fl">80.03</span> <span class="fl">80.04</span> <span class="fl">79.97</span></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="fl">80.05</span> <span class="fl">80.03</span> <span class="fl">80.02</span> <span class="fl">80.00</span> <span class="fl">80.02</span></span>
<span id="cb142-4"><a href="#cb142-4"></a></span>
<span id="cb142-5"><a href="#cb142-5"></a>B <span class="ot">&lt;-</span> <span class="fu">scan</span>()</span>
<span id="cb142-6"><a href="#cb142-6"></a><span class="fl">80.02</span> <span class="fl">79.94</span> <span class="fl">79.98</span> <span class="fl">79.97</span> <span class="fl">79.97</span> <span class="fl">80.03</span> <span class="fl">79.95</span> <span class="fl">79.97</span></span>
<span id="cb142-7"><a href="#cb142-7"></a></span>
<span id="cb142-8"><a href="#cb142-8"></a><span class="fu">boxplot</span>(A, B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which indicates that the first group tends to give higher results than the second.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ice.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/ice</figcaption>
</figure>
</div>
<p>To test for the equality of the means of the two examples, we can use an <em>unpaired</em> <em>t</em>-test by</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb143-1"><a href="#cb143-1"></a><span class="op">&gt;</span> t<span class="op">.</span>test<span class="op">(</span>A<span class="op">,</span> B<span class="op">)</span></span>
<span id="cb143-2"><a href="#cb143-2"></a></span>
<span id="cb143-3"><a href="#cb143-3"></a>         Welch Two Sample t<span class="op">-</span>test</span>
<span id="cb143-4"><a href="#cb143-4"></a></span>
<span id="cb143-5"><a href="#cb143-5"></a>data<span class="op">:</span>  A and B</span>
<span id="cb143-6"><a href="#cb143-6"></a>t <span class="op">=</span> <span class="fl">3.2499</span><span class="op">,</span> df <span class="op">=</span> <span class="fl">12.027</span><span class="op">,</span> p<span class="op">-</span>value <span class="op">=</span> <span class="dv">0</span><span class="er">.00694</span></span>
<span id="cb143-7"><a href="#cb143-7"></a>alternative hypothesis<span class="op">:</span> true difference in means is not equal to <span class="dv">0</span></span>
<span id="cb143-8"><a href="#cb143-8"></a><span class="dv">95</span> percent confidence interval<span class="op">:</span></span>
<span id="cb143-9"><a href="#cb143-9"></a> <span class="dv">0</span><span class="er">.01385526</span> <span class="dv">0</span><span class="er">.07018320</span></span>
<span id="cb143-10"><a href="#cb143-10"></a>sample estimates<span class="op">:</span></span>
<span id="cb143-11"><a href="#cb143-11"></a>mean of x mean of y</span>
<span id="cb143-12"><a href="#cb143-12"></a> <span class="fl">80.02077</span>  <span class="fl">79.97875</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which does indicate a significant difference, assuming normality. By default the R function does not assume equality of variances in the two samples. We can use the F test to test for equality in the variances, provided that the two samples are from normal populations.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb144-1"><a href="#cb144-1"></a><span class="op">&gt;</span> var<span class="op">.</span>test<span class="op">(</span>A<span class="op">,</span> B<span class="op">)</span></span>
<span id="cb144-2"><a href="#cb144-2"></a></span>
<span id="cb144-3"><a href="#cb144-3"></a>         F test to compare two variances</span>
<span id="cb144-4"><a href="#cb144-4"></a></span>
<span id="cb144-5"><a href="#cb144-5"></a>data<span class="op">:</span>  A and B</span>
<span id="cb144-6"><a href="#cb144-6"></a>F <span class="op">=</span> <span class="dv">0</span><span class="er">.5837</span><span class="op">,</span> num df <span class="op">=</span> <span class="dv">12</span><span class="op">,</span> denom df <span class="op">=</span>  <span class="dv">7</span><span class="op">,</span> p<span class="op">-</span>value <span class="op">=</span> <span class="dv">0</span><span class="er">.3938</span></span>
<span id="cb144-7"><a href="#cb144-7"></a>alternative hypothesis<span class="op">:</span> true ratio of variances is not equal to <span class="dv">1</span></span>
<span id="cb144-8"><a href="#cb144-8"></a><span class="dv">95</span> percent confidence interval<span class="op">:</span></span>
<span id="cb144-9"><a href="#cb144-9"></a> <span class="dv">0</span><span class="er">.1251097</span> <span class="fl">2.1052687</span></span>
<span id="cb144-10"><a href="#cb144-10"></a>sample estimates<span class="op">:</span></span>
<span id="cb144-11"><a href="#cb144-11"></a>ratio of variances</span>
<span id="cb144-12"><a href="#cb144-12"></a>         <span class="dv">0</span><span class="er">.5837405</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which shows no evidence of a significant difference, and so we can use the classical <em>t</em>-test that assumes equality of the variances.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb145-1"><a href="#cb145-1"></a><span class="op">&gt;</span> t<span class="op">.</span>test<span class="op">(</span>A<span class="op">,</span> B<span class="op">,</span> var<span class="op">.</span>equal<span class="op">=</span>TRUE<span class="op">)</span></span>
<span id="cb145-2"><a href="#cb145-2"></a></span>
<span id="cb145-3"><a href="#cb145-3"></a>         Two Sample t<span class="op">-</span>test</span>
<span id="cb145-4"><a href="#cb145-4"></a></span>
<span id="cb145-5"><a href="#cb145-5"></a>data<span class="op">:</span>  A and B</span>
<span id="cb145-6"><a href="#cb145-6"></a>t <span class="op">=</span> <span class="fl">3.4722</span><span class="op">,</span> df <span class="op">=</span> <span class="dv">19</span><span class="op">,</span> p<span class="op">-</span>value <span class="op">=</span> <span class="dv">0</span><span class="er">.002551</span></span>
<span id="cb145-7"><a href="#cb145-7"></a>alternative hypothesis<span class="op">:</span> true difference in means is not equal to <span class="dv">0</span></span>
<span id="cb145-8"><a href="#cb145-8"></a><span class="dv">95</span> percent confidence interval<span class="op">:</span></span>
<span id="cb145-9"><a href="#cb145-9"></a> <span class="dv">0</span><span class="er">.01669058</span> <span class="dv">0</span><span class="er">.06734788</span></span>
<span id="cb145-10"><a href="#cb145-10"></a>sample estimates<span class="op">:</span></span>
<span id="cb145-11"><a href="#cb145-11"></a>mean of x mean of y</span>
<span id="cb145-12"><a href="#cb145-12"></a> <span class="fl">80.02077</span>  <span class="fl">79.97875</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All these tests assume normality of the two samples. The two-sample Wilcoxon (or Mann-Whitney) test only assumes a common continuous distribution under the null hypothesis.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="sc">&gt;</span> <span class="fu">wilcox.test</span>(A, B)</span>
<span id="cb146-2"><a href="#cb146-2"></a></span>
<span id="cb146-3"><a href="#cb146-3"></a>         Wilcoxon rank sum test with continuity correction</span>
<span id="cb146-4"><a href="#cb146-4"></a></span>
<span id="cb146-5"><a href="#cb146-5"></a>data<span class="sc">:</span>  A and B</span>
<span id="cb146-6"><a href="#cb146-6"></a>W <span class="ot">=</span> <span class="dv">89</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.007497</span></span>
<span id="cb146-7"><a href="#cb146-7"></a>alternative hypothesis<span class="sc">:</span> true location shift is not equal to <span class="dv">0</span></span>
<span id="cb146-8"><a href="#cb146-8"></a></span>
<span id="cb146-9"><a href="#cb146-9"></a>Warning message<span class="sc">:</span></span>
<span id="cb146-10"><a href="#cb146-10"></a>Cannot compute exact p<span class="sc">-</span>value with ties <span class="cf">in</span><span class="sc">:</span> <span class="fu">wilcox.test</span>(A, B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note the warning: there are several ties in each sample, which suggests strongly that these data are from a discrete distribution (probably due to rounding).</p>
<p>There are several ways to compare graphically the two samples. We have already seen a pair of boxplots. The following</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb147-1"><a href="#cb147-1"></a><span class="op">&gt;</span> plot<span class="op">(</span>ecdf<span class="op">(</span>A<span class="op">),</span> <span class="cf">do</span><span class="op">.</span>points<span class="op">=</span>FALSE<span class="op">,</span> verticals<span class="op">=</span>TRUE<span class="op">,</span> xlim<span class="op">=</span>range<span class="op">(</span>A<span class="op">,</span> B<span class="op">))</span></span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="op">&gt;</span> plot<span class="op">(</span>ecdf<span class="op">(</span>B<span class="op">),</span> <span class="cf">do</span><span class="op">.</span>points<span class="op">=</span>FALSE<span class="op">,</span> verticals<span class="op">=</span>TRUE<span class="op">,</span> add<span class="op">=</span>TRUE<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will show the two empirical CDFs, and <code>qqplot</code> will perform a Q-Q plot of the two samples. The Kolmogorov-Smirnov test is of the maximal vertical distance between the two ecdf’s, assuming a common continuous distribution:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="sc">&gt;</span> <span class="fu">ks.test</span>(A, B)</span>
<span id="cb148-2"><a href="#cb148-2"></a></span>
<span id="cb148-3"><a href="#cb148-3"></a>         Two<span class="sc">-</span>sample Kolmogorov<span class="sc">-</span>Smirnov test</span>
<span id="cb148-4"><a href="#cb148-4"></a></span>
<span id="cb148-5"><a href="#cb148-5"></a>data<span class="sc">:</span>  A and B</span>
<span id="cb148-6"><a href="#cb148-6"></a>D <span class="ot">=</span> <span class="fl">0.5962</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.05919</span></span>
<span id="cb148-7"><a href="#cb148-7"></a>alternative hypothesis<span class="sc">:</span> two<span class="sc">-</span>sided</span>
<span id="cb148-8"><a href="#cb148-8"></a></span>
<span id="cb148-9"><a href="#cb148-9"></a>Warning message<span class="sc">:</span></span>
<span id="cb148-10"><a href="#cb148-10"></a>cannot compute correct p<span class="sc">-</span>values with ties <span class="cf">in</span><span class="sc">:</span> <span class="fu">ks.test</span>(A, B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sec-grouping-loops-and-conditional-execution" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Grouping, loops and conditional execution</h1>
<section id="sec-grouped-expressions" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sec-grouped-expressions"><span class="header-section-number">9.1</span> Grouped expressions</h2>
<p>R is an expression language in the sense that its only command type is a function or expression which returns a result. Even an assignment is an expression whose result is the value assigned, and it may be used wherever any expression may be used; in particular multiple assignments are possible.</p>
<p>Commands may be grouped together in braces, <var>{``expr_1</var><var>; ``…</var><var>; ``expr_m</var><code>}</code>, in which case the value of the group is the result of the last expression in the group evaluated. Since such a group is also an expression it may, for example, be itself included in parentheses and used as part of an even larger expression, and so on.</p>
</section>
<section id="sec-control-statements" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sec-control-statements"><span class="header-section-number">9.2</span> Control statements</h2>
<section id="conditional-execution-if-statements-sec-conditional-execution-if-statements" class="level3">
<h3 class="anchored" data-anchor-id="conditional-execution-if-statements-sec-conditional-execution-if-statements">Conditional execution: <code>if</code> statements {#sec-conditional-execution:-<code>if</code>-statements}</h3>
<p>The language has available a conditional construction of the form</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="sc">&gt;</span> <span class="cf">if</span> (expr_1) expr_2 <span class="cf">else</span> expr_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <var>expr_1</var> must evaluate to a single logical value and the result of the entire expression is then evident.</p>
<p>The “short-circuit” operators <code>&amp;&amp;</code> and <code>||</code> are often used as part of the condition in an <code>if</code> statement. Whereas <code>&amp;</code> and <code>|</code> apply element-wise to vectors, <code>&amp;&amp;</code> and <code>||</code> apply to vectors of length one, and only evaluate their second argument if necessary.</p>
<p>There is a vectorized version of the <code>if</code>/<code>else</code> construct, the <code>ifelse</code> function. This has the form <code>ifelse(condition, a, b)</code> and returns a vector of the same length as <code>condition</code>, with elements <code>a[i]</code> if <code>condition[i]</code> is true, otherwise <code>b[i]</code> (where <code>a</code> and <code>b</code> are recycled as necessary).</p>
</section>
<section id="repetitive-execution-for-loops-repeat-and-while-sec-repetitive-execution-for-loops-repeat-and-while" class="level3">
<h3 class="anchored" data-anchor-id="repetitive-execution-for-loops-repeat-and-while-sec-repetitive-execution-for-loops-repeat-and-while">Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code> {#sec-repetitive-execution:-<code>for</code>-loops-<code>repeat</code>-and-<code>while</code>}</h3>
<p>There is also a <code>for</code> loop construction which has the form</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="sc">&gt;</span> <span class="cf">for</span> (name <span class="cf">in</span> expr_1) expr_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <var>name</var> is the loop variable. <var>expr_1</var> is a vector expression, (often a sequence like <code>1:20</code>), and <var>expr_2</var> is often a grouped expression with its sub-expressions written in terms of the dummy <em>name</em>. <var>expr_2</var> is repeatedly evaluated as <var>name</var> ranges through the values in the vector result of <var>expr_1</var>.</p>
<p>As an example, suppose <code>ind</code> is a vector of class indicators and we wish to produce separate plots of <code>y</code> versus <code>x</code> within classes. One possibility here is to use <code>coplot()</code>,<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> which will produce an array of plots corresponding to each level of the factor. Another way to do this, now putting all plots on the one display, is as follows:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="sc">&gt;</span> xc <span class="ot">&lt;-</span> <span class="fu">split</span>(x, ind)</span>
<span id="cb151-2"><a href="#cb151-2"></a><span class="sc">&gt;</span> yc <span class="ot">&lt;-</span> <span class="fu">split</span>(y, ind)</span>
<span id="cb151-3"><a href="#cb151-3"></a><span class="sc">&gt;</span> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(yc)) {</span>
<span id="cb151-4"><a href="#cb151-4"></a>    <span class="fu">plot</span>(xc[[i]], yc[[i]])</span>
<span id="cb151-5"><a href="#cb151-5"></a>    <span class="fu">abline</span>(<span class="fu">lsfit</span>(xc[[i]], yc[[i]]))</span>
<span id="cb151-6"><a href="#cb151-6"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Note the function <code>split()</code> which produces a list of vectors obtained by splitting a larger vector according to the classes specified by a factor. This is a useful function, mostly used in connection with boxplots. See the <code>help</code> facility for further details.)</p>
<blockquote class="blockquote">
<p><strong>Warning</strong>: <code>for()</code> loops are used in R code much less often than in compiled languages. Code that takes a ‘whole object’ view is likely to be both clearer and faster in R.</p>
</blockquote>
<p>Other looping facilities include the</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a><span class="sc">&gt;</span> <span class="cf">repeat</span> expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>statement and the</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="sc">&gt;</span> <span class="cf">while</span> (condition) expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>statement.</p>
<p>The <code>break</code> statement can be used to terminate any loop, possibly abnormally. This is the only way to terminate <code>repeat</code> loops.</p>
<p>The <code>next</code> statement can be used to discontinue one particular cycle and skip to the “next”.</p>
<p>Control statements are most often used in connection with <em>functions</em> which are discussed in <a href="#sec-writing-your-own-functions">Section&nbsp;10</a> , and where more examples will emerge.</p>
</section>
</section>
</section>
<section id="sec-writing-your-own-functions" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Writing your own functions</h1>
<p>As we have seen informally along the way, the R language allows the user to create objects of mode <em>function</em>. These are true R functions that are stored in a special internal form and may be used in further expressions and so on. In the process, the language gains enormously in power, convenience and elegance, and learning to write useful functions is one of the main ways to make your use of R comfortable and productive.</p>
<p>It should be emphasized that most of the functions supplied as part of the R system, such as <code>mean()</code>, <code>var()</code>, <code>postscript()</code> and so on, are themselves written in R and thus do not differ materially from user written functions.</p>
<p>A function is defined by an assignment of the form</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="sc">&gt;</span> name <span class="ot">&lt;-</span> <span class="cf">function</span>(arg_1, arg_2, …) expression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <var>expression</var> is an R expression, (usually a grouped expression), that uses the arguments, <var>arg_i</var>, to calculate a value. The value of the expression is the value returned for the function.</p>
<p>A call to the function then usually takes the form <var>name</var><var>(``expr_1</var><var>, ``expr_2</var><code>, …)</code> and may occur anywhere a function call is legitimate.</p>
<section id="sec-simple-examples" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sec-simple-examples"><span class="header-section-number">10.1</span> Simple examples</h2>
<p>As a first example, consider a function to calculate the two sample <em>t</em>-statistic, showing “all the steps”. This is an artificial example, of course, since there are other, simpler ways of achieving the same end.</p>
<p>The function is defined as follows:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="sc">&gt;</span> twosam <span class="ot">&lt;-</span> <span class="cf">function</span>(y1, y2) {</span>
<span id="cb155-2"><a href="#cb155-2"></a>    n1  <span class="ot">&lt;-</span> <span class="fu">length</span>(y1); n2  <span class="ot">&lt;-</span> <span class="fu">length</span>(y2)</span>
<span id="cb155-3"><a href="#cb155-3"></a>    yb1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1);   yb2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y2)</span>
<span id="cb155-4"><a href="#cb155-4"></a>    s1  <span class="ot">&lt;-</span> <span class="fu">var</span>(y1);    s2  <span class="ot">&lt;-</span> <span class="fu">var</span>(y2)</span>
<span id="cb155-5"><a href="#cb155-5"></a>    s <span class="ot">&lt;-</span> ((n1<span class="dv">-1</span>)<span class="sc">*</span>s1 <span class="sc">+</span> (n2<span class="dv">-1</span>)<span class="sc">*</span>s2)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-2</span>)</span>
<span id="cb155-6"><a href="#cb155-6"></a>    tst <span class="ot">&lt;-</span> (yb1 <span class="sc">-</span> yb2)<span class="sc">/</span><span class="fu">sqrt</span>(s<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2))</span>
<span id="cb155-7"><a href="#cb155-7"></a>    tst</span>
<span id="cb155-8"><a href="#cb155-8"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With this function defined, you could perform two sample <em>t</em>-tests using a call such as</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="sc">&gt;</span> tstat <span class="ot">&lt;-</span> <span class="fu">twosam</span>(data<span class="sc">$</span>male, data<span class="sc">$</span>female); tstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As a second example, consider a function to emulate directly the <span class="small">MATLAB</span> backslash command, which returns the coefficients of the orthogonal projection of the vector <em>y</em> onto the column space of the matrix, <em>X</em>. (This is ordinarily called the least squares estimate of the regression coefficients.) This would ordinarily be done with the <code>qr()</code> function; however this is sometimes a bit tricky to use directly and it pays to have a simple function such as the following to use it safely.</p>
<p>Thus given a <em>n</em> by <em>1</em> vector <em>y</em> and an <em>n</em> by <em>p</em> matrix <em>X</em> then <em>X \ y</em> is defined as (X’X)^{-}X’y, where (X’X)^{-} is a generalized inverse of <em>X'X</em>.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="sc">&gt;</span> bslash <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y) {</span>
<span id="cb157-2"><a href="#cb157-2"></a>  X <span class="ot">&lt;-</span> <span class="fu">qr</span>(X)</span>
<span id="cb157-3"><a href="#cb157-3"></a>  <span class="fu">qr.coef</span>(X, y)</span>
<span id="cb157-4"><a href="#cb157-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After this object is created it may be used in statements such as</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1"></a><span class="sc">&gt;</span> regcoeff <span class="ot">&lt;-</span> <span class="fu">bslash</span>(Xmat, yvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and so on.</p>
<p>The classical R function <code>lsfit()</code> does this job quite well, and more<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>. It in turn uses the functions <code>qr()</code> and <code>qr.coef()</code> in the slightly counterintuitive way above to do this part of the calculation. Hence there is probably some value in having just this part isolated in a simple to use function if it is going to be in frequent use. If so, we may wish to make it a matrix binary operator for even more convenient use.</p>
</section>
<section id="sec-defining-new-binary-operators" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sec-defining-new-binary-operators"><span class="header-section-number">10.2</span> Defining new binary operators</h2>
<p>Had we given the <code>bslash()</code> function a different name, namely one of the form</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a><span class="sc">%anything%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>it could have been used as a <em>binary operator</em> in expressions rather than in function form. Suppose, for example, we choose <code>!</code> for the internal character. The function definition would then start as</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="sc">&gt;</span> <span class="st">"%!%"</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y) { … }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Note the use of quote marks.) The function could then be used as <code>X %!% y</code>. (The backslash symbol itself is not a convenient choice as it presents special problems in this context.)</p>
<p>The matrix multiplication operator, <code>%*%</code>, and the outer product matrix operator <code>%o%</code> are other examples of binary operators defined in this way.</p>
</section>
<section id="sec-named-arguments-and-defaults" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="sec-named-arguments-and-defaults"><span class="header-section-number">10.3</span> Named arguments and defaults</h2>
<p>As first noted in <a href="Generating-regular-sequences.html">Generating regular sequences</a>, if arguments to called functions are given in the “<var>name</var><var>=``object</var>” form, they may be given in any order. Furthermore the argument sequence may begin in the unnamed, positional form, and specify named arguments after the positional arguments.</p>
<p>Thus if there is a function <code>fun1</code> defined by</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="sc">&gt;</span> fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, data.frame, graph, limit) {</span>
<span id="cb161-2"><a href="#cb161-2"></a>    [<span class="cf">function</span> body omitted]</span>
<span id="cb161-3"><a href="#cb161-3"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>then the function may be invoked in several ways, for example</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">fun1</span>(d, df, <span class="cn">TRUE</span>, <span class="dv">20</span>)</span>
<span id="cb162-2"><a href="#cb162-2"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">fun1</span>(d, df, <span class="at">graph=</span><span class="cn">TRUE</span>, <span class="at">limit=</span><span class="dv">20</span>)</span>
<span id="cb162-3"><a href="#cb162-3"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">fun1</span>(<span class="at">data=</span>d, <span class="at">limit=</span><span class="dv">20</span>, <span class="at">graph=</span><span class="cn">TRUE</span>, <span class="at">data.frame=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>are all equivalent.</p>
<p>In many cases arguments can be given commonly appropriate default values, in which case they may be omitted altogether from the call when the defaults are appropriate. For example, if <code>fun1</code> were defined as</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a><span class="sc">&gt;</span> fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, data.frame, <span class="at">graph=</span><span class="cn">TRUE</span>, <span class="at">limit=</span><span class="dv">20</span>) { … }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>it could be called as</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">fun1</span>(d, df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which is now equivalent to the three cases above, or as</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a><span class="sc">&gt;</span> ans <span class="ot">&lt;-</span> <span class="fu">fun1</span>(d, df, <span class="at">limit=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which changes one of the defaults.</p>
<p>It is important to note that defaults may be arbitrary expressions, even involving other arguments to the same function; they are not restricted to be constants as in our simple example here.</p>
</section>
<section id="the-sec-the--argument" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="the-sec-the--argument"><span class="header-section-number">10.4</span> The ‘<code>…</code>{#sec-the-’<code>…</code>’-argument}</h2>
<p>Another frequent requirement is to allow one function to pass on argument settings to another. For example many graphics functions use the function <code>par()</code> and functions like <code>plot()</code> allow the user to pass on graphical parameters to <code>par()</code> to control the graphical output. (See <a href="The-par_0028_0029-function.html">The par() function</a>, for more details on the <code>par()</code> function.) This can be done by including an extra argument, literally ‘<code>…</code>’, of the function, which may then be passed on. An outline example is given below.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a>fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, data.frame, <span class="at">graph=</span><span class="cn">TRUE</span>, <span class="at">limit=</span><span class="dv">20</span>, ...) {</span>
<span id="cb166-2"><a href="#cb166-2"></a>  [omitted statements]</span>
<span id="cb166-3"><a href="#cb166-3"></a>  <span class="cf">if</span> (graph)</span>
<span id="cb166-4"><a href="#cb166-4"></a>    <span class="fu">par</span>(<span class="at">pch=</span><span class="st">"*"</span>, ...)</span>
<span id="cb166-5"><a href="#cb166-5"></a>  [more omissions]</span>
<span id="cb166-6"><a href="#cb166-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Less frequently, a function will need to refer to components of ‘<code>…</code>’. The expression <code>list(...)</code> evaluates all such arguments and returns them in a named list, while <code>..1</code>, <code>..2</code>, etc. evaluate them one at a time, with ‘<code>..n</code>’ returning the n’th unmatched argument.</p>
</section>
<section id="sec-assignments-within-functions" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="sec-assignments-within-functions"><span class="header-section-number">10.5</span> Assignments within functions</h2>
<p>Note that <em>any ordinary assignments done within the function are local and temporary and are lost after exit from the function</em>. Thus the assignment <code>X &lt;- qr(X)</code> does not affect the value of the argument in the calling program.</p>
<p>To understand completely the rules governing the scope of R assignments the reader needs to be familiar with the notion of an evaluation <em>frame</em>. This is a somewhat advanced, though hardly difficult, topic and is not covered further here.</p>
<p>If global and permanent assignments are intended within a function, then either the “superassignment” operator, <code>&lt;&lt;-</code> or the function <code>assign()</code> can be used. See the <code>help</code> document for details.</p>
</section>
<section id="sec-more-advanced-examples" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="sec-more-advanced-examples"><span class="header-section-number">10.6</span> More advanced examples</h2>
<section id="sec-efficiency-factors-in-block-designs" class="level3">
<h3 class="anchored" data-anchor-id="sec-efficiency-factors-in-block-designs">Efficiency factors in block designs</h3>
<p>As a more complete, if a little pedestrian, example of a function, consider finding the efficiency factors for a block design. (Some aspects of this problem have already been discussed in <a href="Index-matrices.html">Index matrices</a>.)</p>
<p>A block design is defined by two factors, say <code>blocks</code> (<code>b</code> levels) and <code>varieties</code> (<code>v</code> levels). If <em>R</em> and <em>K</em> are the <em>v</em> by <em>v</em> and <em>b</em> by <em>b</em> <em>replications</em> and <em>block size</em> matrices, respectively, and <em>N</em> is the <em>b</em> by <em>v</em> incidence matrix, then the efficiency factors are defined as the eigenvalues of the matrix E = I_v - R^{-1/2}N’K^{-1}NR^{-1/2} = I_v - A’A, where A = K^{-1/2}NR^{-1/2}. One way to write the function is given below.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="sc">&gt;</span> bdeff <span class="ot">&lt;-</span> <span class="cf">function</span>(blocks, varieties) {</span>
<span id="cb167-2"><a href="#cb167-2"></a>    blocks <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(blocks)             <span class="co"># minor safety move</span></span>
<span id="cb167-3"><a href="#cb167-3"></a>    b <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">levels</span>(blocks))</span>
<span id="cb167-4"><a href="#cb167-4"></a>    varieties <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(varieties)       <span class="co"># minor safety move</span></span>
<span id="cb167-5"><a href="#cb167-5"></a>    v <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">levels</span>(varieties))</span>
<span id="cb167-6"><a href="#cb167-6"></a>    K <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(blocks))           <span class="co"># remove dim attr</span></span>
<span id="cb167-7"><a href="#cb167-7"></a>    R <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(varieties))        <span class="co"># remove dim attr</span></span>
<span id="cb167-8"><a href="#cb167-8"></a>    N <span class="ot">&lt;-</span> <span class="fu">table</span>(blocks, varieties)</span>
<span id="cb167-9"><a href="#cb167-9"></a>    A <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(K) <span class="sc">*</span> N <span class="sc">*</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(R), <span class="fu">rep</span>(b, v))</span>
<span id="cb167-10"><a href="#cb167-10"></a>    sv <span class="ot">&lt;-</span> <span class="fu">svd</span>(A)</span>
<span id="cb167-11"><a href="#cb167-11"></a>    <span class="fu">list</span>(<span class="at">eff=</span><span class="dv">1</span> <span class="sc">-</span> sv<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span>, <span class="at">blockcv=</span>sv<span class="sc">$</span>u, <span class="at">varietycv=</span>sv<span class="sc">$</span>v)</span>
<span id="cb167-12"><a href="#cb167-12"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is numerically slightly better to work with the singular value decomposition on this occasion rather than the eigenvalue routines.</p>
<p>The result of the function is a list giving not only the efficiency factors as the first component, but also the block and variety canonical contrasts, since sometimes these give additional useful qualitative information.</p>
</section>
<section id="sec-dropping-all-names-in-a-printed-array" class="level3">
<h3 class="anchored" data-anchor-id="sec-dropping-all-names-in-a-printed-array">Dropping all names in a printed array</h3>
<p>For printing purposes with large matrices or arrays, it is often useful to print them in close block form without the array names or numbers. Removing the <code>dimnames</code> attribute will not achieve this effect, but rather the array must be given a <code>dimnames</code> attribute consisting of empty strings. For example to print a matrix, <code>X</code></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="sc">&gt;</span> temp <span class="ot">&lt;-</span> X</span>
<span id="cb168-2"><a href="#cb168-2"></a><span class="sc">&gt;</span> <span class="fu">dimnames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="st">""</span>, <span class="fu">nrow</span>(X)), <span class="fu">rep</span>(<span class="st">""</span>, <span class="fu">ncol</span>(X)))</span>
<span id="cb168-3"><a href="#cb168-3"></a><span class="sc">&gt;</span> temp; <span class="fu">rm</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This can be much more conveniently done using a function, <code>no.dimnames()</code>, shown below, as a “wrap around” to achieve the same result. It also illustrates how some effective and useful user functions can be quite short.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb169-1"><a href="#cb169-1"></a>no<span class="op">.</span>dimnames <span class="op">&lt;-</span> function<span class="op">(</span>a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-2"><a href="#cb169-2"></a>  <span class="pp">#</span><span class="er"># Remove all dimension names from an array for compact printing.</span></span>
<span id="cb169-3"><a href="#cb169-3"></a>  d <span class="op">&lt;-</span> list<span class="op">()</span></span>
<span id="cb169-4"><a href="#cb169-4"></a>  l <span class="op">&lt;-</span> <span class="dv">0</span></span>
<span id="cb169-5"><a href="#cb169-5"></a>  <span class="cf">for</span><span class="op">(</span>i in dim<span class="op">(</span>a<span class="op">))</span> <span class="op">{</span></span>
<span id="cb169-6"><a href="#cb169-6"></a>    d<span class="op">[[</span><span class="at">l </span><span class="op">&lt;-</span><span class="at"> l </span><span class="op">+</span><span class="at"> </span><span class="dv">1</span><span class="op">]]</span> <span class="op">&lt;-</span> rep<span class="op">(</span><span class="st">""</span><span class="op">,</span> i<span class="op">)</span></span>
<span id="cb169-7"><a href="#cb169-7"></a>  <span class="op">}</span></span>
<span id="cb169-8"><a href="#cb169-8"></a>  dimnames<span class="op">(</span>a<span class="op">)</span> <span class="op">&lt;-</span> d</span>
<span id="cb169-9"><a href="#cb169-9"></a>  a</span>
<span id="cb169-10"><a href="#cb169-10"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With this function defined, an array may be printed in close format using</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="sc">&gt;</span> <span class="fu">no.dimnames</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is particularly useful for large integer arrays, where patterns are the real interest rather than the values.</p>
</section>
<section id="sec-recursive-numerical-integration" class="level3">
<h3 class="anchored" data-anchor-id="sec-recursive-numerical-integration">Recursive numerical integration</h3>
<p>Functions may be recursive, and may themselves define functions within themselves. Note, however, that such functions, or indeed variables, are not inherited by called functions in higher evaluation frames as they would be if they were on the search path.</p>
<p>The example below shows a naive way of performing one-dimensional numerical integration. The integrand is evaluated at the end points of the range and in the middle. If the one-panel trapezium rule answer is close enough to the two panel, then the latter is returned as the value. Otherwise the same process is recursively applied to each panel. The result is an adaptive integration process that concentrates function evaluations in regions where the integrand is farthest from linear. There is, however, a heavy overhead, and the function is only competitive with other algorithms when the integrand is both smooth and very difficult to evaluate.</p>
<p>The example is also given partly as a little puzzle in R programming.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>area <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, <span class="at">eps =</span> <span class="fl">1.0e-06</span>, <span class="at">lim =</span> <span class="dv">10</span>) {</span>
<span id="cb171-2"><a href="#cb171-2"></a>  fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, fa, fb, a0, eps, lim, fun) {</span>
<span id="cb171-3"><a href="#cb171-3"></a>    <span class="do">## function ‘fun1’ is only visible inside ‘area’</span></span>
<span id="cb171-4"><a href="#cb171-4"></a>    d <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb171-5"><a href="#cb171-5"></a>    h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb171-6"><a href="#cb171-6"></a>    fd <span class="ot">&lt;-</span> <span class="fu">f</span>(d)</span>
<span id="cb171-7"><a href="#cb171-7"></a>    a1 <span class="ot">&lt;-</span> h <span class="sc">*</span> (fa <span class="sc">+</span> fd)</span>
<span id="cb171-8"><a href="#cb171-8"></a>    a2 <span class="ot">&lt;-</span> h <span class="sc">*</span> (fd <span class="sc">+</span> fb)</span>
<span id="cb171-9"><a href="#cb171-9"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(a0 <span class="sc">-</span> a1 <span class="sc">-</span> a2) <span class="sc">&lt;</span> eps <span class="sc">||</span> lim <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb171-10"><a href="#cb171-10"></a>      <span class="fu">return</span>(a1 <span class="sc">+</span> a2)</span>
<span id="cb171-11"><a href="#cb171-11"></a>    <span class="cf">else</span> {</span>
<span id="cb171-12"><a href="#cb171-12"></a>      <span class="fu">return</span>(<span class="fu">fun</span>(f, a, d, fa, fd, a1, eps, lim <span class="sc">-</span> <span class="dv">1</span>, fun) <span class="sc">+</span></span>
<span id="cb171-13"><a href="#cb171-13"></a>             <span class="fu">fun</span>(f, d, b, fd, fb, a2, eps, lim <span class="sc">-</span> <span class="dv">1</span>, fun))</span>
<span id="cb171-14"><a href="#cb171-14"></a>    }</span>
<span id="cb171-15"><a href="#cb171-15"></a>  }</span>
<span id="cb171-16"><a href="#cb171-16"></a>  fa <span class="ot">&lt;-</span> <span class="fu">f</span>(a)</span>
<span id="cb171-17"><a href="#cb171-17"></a>  fb <span class="ot">&lt;-</span> <span class="fu">f</span>(b)</span>
<span id="cb171-18"><a href="#cb171-18"></a>  a0 <span class="ot">&lt;-</span> ((fa <span class="sc">+</span> fb) <span class="sc">*</span> (b <span class="sc">-</span> a))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb171-19"><a href="#cb171-19"></a>  <span class="fu">fun1</span>(f, a, b, fa, fb, a0, eps, lim, fun1)</span>
<span id="cb171-20"><a href="#cb171-20"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sec-scope" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="sec-scope"><span class="header-section-number">10.7</span> Scope</h2>
<p>The discussion in this section is somewhat more technical than in other parts of this document. However, it details one of the major differences between <span class="small">S-PLUS</span> and R.</p>
<p>The symbols which occur in the body of a function can be divided into three classes; formal parameters, local variables and free variables. The formal parameters of a function are those occurring in the argument list of the function. Their values are determined by the process of <em>binding</em> the actual function arguments to the formal parameters. Local variables are those whose values are determined by the evaluation of expressions in the body of the functions. Variables which are not formal parameters or local variables are called free variables. Free variables become local variables if they are assigned to. Consider the following function definition.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb172-1"><a href="#cb172-1"></a>f <span class="op">&lt;-</span> function<span class="op">(</span>x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-2"><a href="#cb172-2"></a>  y <span class="op">&lt;-</span> <span class="dv">2</span><span class="op">*</span>x</span>
<span id="cb172-3"><a href="#cb172-3"></a>  print<span class="op">(</span>x<span class="op">)</span></span>
<span id="cb172-4"><a href="#cb172-4"></a>  print<span class="op">(</span>y<span class="op">)</span></span>
<span id="cb172-5"><a href="#cb172-5"></a>  print<span class="op">(</span>z<span class="op">)</span></span>
<span id="cb172-6"><a href="#cb172-6"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this function, <code>x</code> is a formal parameter, <code>y</code> is a local variable and <code>z</code> is a free variable.</p>
<p>In R the free variable bindings are resolved by first looking in the environment in which the function was created. This is called <em>lexical scope</em>. First we define a function called <code>cube</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>cube <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb173-2"><a href="#cb173-2"></a>  sq <span class="ot">&lt;-</span> <span class="cf">function</span>() n<span class="sc">*</span>n</span>
<span id="cb173-3"><a href="#cb173-3"></a>  n<span class="sc">*</span><span class="fu">sq</span>()</span>
<span id="cb173-4"><a href="#cb173-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The variable <code>n</code> in the function <code>sq</code> is not an argument to that function. Therefore it is a free variable and the scoping rules must be used to ascertain the value that is to be associated with it. Under static scope (<span class="small">S-PLUS</span>) the value is that associated with a global variable named <code>n</code>. Under lexical scope (R) it is the parameter to the function <code>cube</code> since that is the active binding for the variable <code>n</code> at the time the function <code>sq</code> was defined. The difference between evaluation in R and evaluation in <span class="small">S-PLUS</span> is that <span class="small">S-PLUS</span> looks for a global variable called <code>n</code> while R first looks for a variable called <code>n</code> in the environment created when <code>cube</code> was invoked.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="do">## first evaluation in S</span></span>
<span id="cb174-2"><a href="#cb174-2"></a>S<span class="sc">&gt;</span> <span class="fu">cube</span>(<span class="dv">2</span>)</span>
<span id="cb174-3"><a href="#cb174-3"></a>Error <span class="cf">in</span> <span class="fu">sq</span>()<span class="sc">:</span> Object <span class="st">"n"</span> not found</span>
<span id="cb174-4"><a href="#cb174-4"></a>Dumped</span>
<span id="cb174-5"><a href="#cb174-5"></a>S<span class="sc">&gt;</span> n <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb174-6"><a href="#cb174-6"></a>S<span class="sc">&gt;</span> <span class="fu">cube</span>(<span class="dv">2</span>)</span>
<span id="cb174-7"><a href="#cb174-7"></a>[<span class="dv">1</span>] <span class="dv">18</span></span>
<span id="cb174-8"><a href="#cb174-8"></a><span class="do">## then the same function evaluated in R</span></span>
<span id="cb174-9"><a href="#cb174-9"></a>R<span class="sc">&gt;</span> <span class="fu">cube</span>(<span class="dv">2</span>)</span>
<span id="cb174-10"><a href="#cb174-10"></a>[<span class="dv">1</span>] <span class="dv">8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Lexical scope can also be used to give functions <em>mutable state</em>. In the following example we show how R can be used to mimic a bank account. A functioning bank account needs to have a balance or total, a function for making withdrawals, a function for making deposits and a function for stating the current balance. We achieve this by creating the three functions within <code>account</code> and then returning a list containing them. When <code>account</code> is invoked it takes a numerical argument <code>total</code> and returns a list containing the three functions. Because these functions are defined in an environment which contains <code>total</code>, they will have access to its value.</p>
<p>The special assignment operator, <code>&lt;&lt;-</code>, is used to change the value associated with <code>total</code>. This operator looks back in enclosing environments for an environment that contains the symbol <code>total</code> and when it finds such an environment it replaces the value, in that environment, with the value of right hand side. If the global or top-level environment is reached without finding the symbol <code>total</code> then that variable is created and assigned to there. For most users <code>&lt;&lt;-</code> creates a global variable and assigns the value of the right hand side to it<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a>. Only when <code>&lt;&lt;-</code> has been used in a function that was returned as the value of another function will the special behavior described here occur.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>open.account <span class="ot">&lt;-</span> <span class="cf">function</span>(total) {</span>
<span id="cb175-2"><a href="#cb175-2"></a>  <span class="fu">list</span>(</span>
<span id="cb175-3"><a href="#cb175-3"></a>    <span class="at">deposit =</span> <span class="cf">function</span>(amount) {</span>
<span id="cb175-4"><a href="#cb175-4"></a>      <span class="cf">if</span>(amount <span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb175-5"><a href="#cb175-5"></a>        <span class="fu">stop</span>(<span class="st">"Deposits must be positive!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb175-6"><a href="#cb175-6"></a>      total <span class="ot">&lt;&lt;-</span> total <span class="sc">+</span> amount</span>
<span id="cb175-7"><a href="#cb175-7"></a>      <span class="fu">cat</span>(amount, <span class="st">"deposited.  Your balance is"</span>, total, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb175-8"><a href="#cb175-8"></a>    },</span>
<span id="cb175-9"><a href="#cb175-9"></a>    <span class="at">withdraw =</span> <span class="cf">function</span>(amount) {</span>
<span id="cb175-10"><a href="#cb175-10"></a>      <span class="cf">if</span>(amount <span class="sc">&gt;</span> total)</span>
<span id="cb175-11"><a href="#cb175-11"></a>        <span class="fu">stop</span>(<span class="st">"You don't have that much money!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb175-12"><a href="#cb175-12"></a>      total <span class="ot">&lt;&lt;-</span> total <span class="sc">-</span> amount</span>
<span id="cb175-13"><a href="#cb175-13"></a>      <span class="fu">cat</span>(amount, <span class="st">"withdrawn.  Your balance is"</span>, total, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb175-14"><a href="#cb175-14"></a>    },</span>
<span id="cb175-15"><a href="#cb175-15"></a>    <span class="at">balance =</span> <span class="cf">function</span>() {</span>
<span id="cb175-16"><a href="#cb175-16"></a>      <span class="fu">cat</span>(<span class="st">"Your balance is"</span>, total, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb175-17"><a href="#cb175-17"></a>    }</span>
<span id="cb175-18"><a href="#cb175-18"></a>  )</span>
<span id="cb175-19"><a href="#cb175-19"></a>}</span>
<span id="cb175-20"><a href="#cb175-20"></a></span>
<span id="cb175-21"><a href="#cb175-21"></a>ross <span class="ot">&lt;-</span> <span class="fu">open.account</span>(<span class="dv">100</span>)</span>
<span id="cb175-22"><a href="#cb175-22"></a>robert <span class="ot">&lt;-</span> <span class="fu">open.account</span>(<span class="dv">200</span>)</span>
<span id="cb175-23"><a href="#cb175-23"></a></span>
<span id="cb175-24"><a href="#cb175-24"></a>ross<span class="sc">$</span><span class="fu">withdraw</span>(<span class="dv">30</span>)</span>
<span id="cb175-25"><a href="#cb175-25"></a>ross<span class="sc">$</span><span class="fu">balance</span>()</span>
<span id="cb175-26"><a href="#cb175-26"></a>robert<span class="sc">$</span><span class="fu">balance</span>()</span>
<span id="cb175-27"><a href="#cb175-27"></a></span>
<span id="cb175-28"><a href="#cb175-28"></a>ross<span class="sc">$</span><span class="fu">deposit</span>(<span class="dv">50</span>)</span>
<span id="cb175-29"><a href="#cb175-29"></a>ross<span class="sc">$</span><span class="fu">balance</span>()</span>
<span id="cb175-30"><a href="#cb175-30"></a>ross<span class="sc">$</span><span class="fu">withdraw</span>(<span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-customizing-the-environment" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="sec-customizing-the-environment"><span class="header-section-number">10.8</span> Customizing the environment</h2>
<p>Users can customize their environment in several different ways. There is a site initialization file and every directory can have its own special initialization file. Finally, the special functions <code>.First</code> and <code>.Last</code> can be used.</p>
<p>The location of the site initialization file is taken from the value of the <code>R_PROFILE</code> environment variable. If that variable is unset, the file <code>Rprofile.site</code> in the R home subdirectory <code>etc</code> is used. This file should contain the commands that you want to execute every time R is started under your system. A second, personal, profile file named <code>.Rprofile</code><a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> can be placed in any directory. If R is invoked in that directory then that file will be sourced. This file gives individual users control over their workspace and allows for different startup procedures in different working directories. If no <code>.Rprofile</code> file is found in the startup directory, then R looks for a <code>.Rprofile</code> file in the user’s home directory and uses that (if it exists). If the environment variable <code>R_PROFILE_USER</code> is set, the file it points to is used instead of the <code>.Rprofile</code> files.</p>
<p>Any function named <code>.First()</code> in either of the two profile files or in the <code>.RData</code> image has a special status. It is automatically performed at the beginning of an R session and may be used to initialize the environment. For example, the definition in the example below alters the prompt to <code>$</code> and sets up various other useful things that can then be taken for granted in the rest of the session.</p>
<p>Thus, the sequence in which files are executed is, <code>Rprofile.site</code>, the user profile, <code>.RData</code> and then <code>.First()</code>. A definition in later files will mask definitions in earlier files.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb176-1"><a href="#cb176-1"></a><span class="op">&gt;</span> <span class="op">.</span>First <span class="op">&lt;-</span> function<span class="op">()</span> <span class="op">{</span></span>
<span id="cb176-2"><a href="#cb176-2"></a>  options<span class="op">(</span>prompt<span class="op">=</span><span class="st">"$ "</span><span class="op">,</span> <span class="cf">continue</span><span class="op">=</span><span class="st">"+</span><span class="sc">\t</span><span class="st">"</span><span class="op">)</span>  # $ is the prompt</span>
<span id="cb176-3"><a href="#cb176-3"></a>  options<span class="op">(</span>digits<span class="op">=</span><span class="dv">5</span><span class="op">,</span> length<span class="op">=</span><span class="dv">999</span><span class="op">)</span>         # custom numbers and printout</span>
<span id="cb176-4"><a href="#cb176-4"></a>  x11<span class="op">()</span>                                 # <span class="cf">for</span> graphics</span>
<span id="cb176-5"><a href="#cb176-5"></a>  par<span class="op">(</span>pch <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span>                        # plotting character</span>
<span id="cb176-6"><a href="#cb176-6"></a>  source<span class="op">(</span>file<span class="op">.</span>path<span class="op">(</span>Sys<span class="op">.</span>getenv<span class="op">(</span><span class="st">"HOME"</span><span class="op">),</span> <span class="st">"R"</span><span class="op">,</span> <span class="st">"mystuff.R"</span><span class="op">))</span></span>
<span id="cb176-7"><a href="#cb176-7"></a>                                        <span class="pp"># </span><span class="er">my personal functions</span></span>
<span id="cb176-8"><a href="#cb176-8"></a>  library<span class="op">(</span>MASS<span class="op">)</span>                         # attach a package</span>
<span id="cb176-9"><a href="#cb176-9"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Similarly a function <code>.Last()</code>, if defined, is (normally) executed at the very end of the session. An example is given below.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="sc">&gt;</span> .Last <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb177-2"><a href="#cb177-2"></a>  <span class="fu">graphics.off</span>()                        <span class="co"># a small safety measure.</span></span>
<span id="cb177-3"><a href="#cb177-3"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">date</span>(),<span class="st">"</span><span class="sc">\n</span><span class="st">Adios</span><span class="sc">\n</span><span class="st">"</span>))        <span class="co"># Is it time for lunch?</span></span>
<span id="cb177-4"><a href="#cb177-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-classes-generic-functions-and-object-orientation" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="sec-classes-generic-functions-and-object-orientation"><span class="header-section-number">10.9</span> Classes, generic functions and object orientation</h2>
<p>The class of an object determines how it will be treated by what are known as <em>generic</em> functions. Put the other way round, a generic function performs a task or action on its arguments <em>specific to the class of the argument itself</em>. If the argument lacks any <code>class</code> attribute, or has a class not catered for specifically by the generic function in question, there is always a <em>default action</em> provided.</p>
<p>An example makes things clearer. The class mechanism offers the user the facility of designing and writing generic functions for special purposes. Among the other generic functions are <code>plot()</code> for displaying objects graphically, <code>summary()</code> for summarizing analyses of various types, and <code>anova()</code> for comparing statistical models.</p>
<p>The number of generic functions that can treat a class in a specific way can be quite large. For example, the functions that can accommodate in some fashion objects of class <code>"data.frame"</code> include</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>[     [[<span class="ot">&lt;-</span>    any    as.matrix</span>
<span id="cb178-2"><a href="#cb178-2"></a>[<span class="ot">&lt;-</span>   mean    plot   summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A currently complete list can be got by using the <code>methods()</code> function:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a><span class="sc">&gt;</span> <span class="fu">methods</span>(<span class="at">class=</span><span class="st">"data.frame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Conversely the number of classes a generic function can handle can also be quite large. For example the <code>plot()</code> function has a default method and variants for objects of classes <code>"data.frame"</code>, <code>"density"</code>, <code>"factor"</code>, and more. A complete list can be got again by using the <code>methods()</code> function:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="sc">&gt;</span> <span class="fu">methods</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For many generic functions the function body is quite short, for example</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a><span class="sc">&gt;</span> coef</span>
<span id="cb181-2"><a href="#cb181-2"></a><span class="cf">function</span> (object, ...)</span>
<span id="cb181-3"><a href="#cb181-3"></a><span class="fu">UseMethod</span>(<span class="st">"coef"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The presence of <code>UseMethod</code> indicates this is a generic function. To see what methods are available we can use <code>methods()</code></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="sc">&gt;</span> <span class="fu">methods</span>(coef)</span>
<span id="cb182-2"><a href="#cb182-2"></a>[<span class="dv">1</span>] coef.aov<span class="sc">*</span>         coef.Arima<span class="sc">*</span>       coef.default<span class="sc">*</span>     coef.listof<span class="sc">*</span></span>
<span id="cb182-3"><a href="#cb182-3"></a>[<span class="dv">5</span>] coef.nls<span class="sc">*</span>         coef.summary.nls<span class="sc">*</span></span>
<span id="cb182-4"><a href="#cb182-4"></a></span>
<span id="cb182-5"><a href="#cb182-5"></a>   Non<span class="sc">-</span>visible functions are asterisked</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example there are six methods, none of which can be seen by typing its name. We can read these by either of</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1"></a><span class="sc">&gt;</span> <span class="fu">getAnywhere</span>(<span class="st">"coef.aov"</span>)</span>
<span id="cb183-2"><a href="#cb183-2"></a>A single object matching <span class="st">'coef.aov'</span> was found</span>
<span id="cb183-3"><a href="#cb183-3"></a>It was found <span class="cf">in</span> the following places</span>
<span id="cb183-4"><a href="#cb183-4"></a>  registered S3 method <span class="cf">for</span> coef from namespace stats</span>
<span id="cb183-5"><a href="#cb183-5"></a>  namespace<span class="sc">:</span>stats</span>
<span id="cb183-6"><a href="#cb183-6"></a>with value</span>
<span id="cb183-7"><a href="#cb183-7"></a></span>
<span id="cb183-8"><a href="#cb183-8"></a><span class="cf">function</span> (object, ...)</span>
<span id="cb183-9"><a href="#cb183-9"></a>{</span>
<span id="cb183-10"><a href="#cb183-10"></a>    z <span class="ot">&lt;-</span> object<span class="sc">$</span>coef</span>
<span id="cb183-11"><a href="#cb183-11"></a>    z[<span class="sc">!</span><span class="fu">is.na</span>(z)]</span>
<span id="cb183-12"><a href="#cb183-12"></a>}</span>
<span id="cb183-13"><a href="#cb183-13"></a></span>
<span id="cb183-14"><a href="#cb183-14"></a><span class="sc">&gt;</span> <span class="fu">getS3method</span>(<span class="st">"coef"</span>, <span class="st">"aov"</span>)</span>
<span id="cb183-15"><a href="#cb183-15"></a><span class="cf">function</span> (object, ...)</span>
<span id="cb183-16"><a href="#cb183-16"></a>{</span>
<span id="cb183-17"><a href="#cb183-17"></a>    z <span class="ot">&lt;-</span> object<span class="sc">$</span>coef</span>
<span id="cb183-18"><a href="#cb183-18"></a>    z[<span class="sc">!</span><span class="fu">is.na</span>(z)]</span>
<span id="cb183-19"><a href="#cb183-19"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A function named <var>gen</var><var>.``cl</var> will be invoked by the generic <var>gen</var> for class <var>cl</var>, so do not name functions in this style unless they are intended to be methods.</p>
<p>The reader is referred to the <em>R Language Definition</em> for a more complete discussion of this mechanism.</p>
</section>
</section>
<section id="sec-statistical-models-in-r" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Statistical models in R</h1>
<p>This section presumes the reader has some familiarity with statistical methodology, in particular with regression analysis and the analysis of variance. Later we make some rather more ambitious presumptions, namely that something is known about generalized linear models and nonlinear regression.</p>
<p>The requirements for fitting statistical models are sufficiently well defined to make it possible to construct general tools that apply in a broad spectrum of problems.</p>
<p>R provides an interlocking suite of facilities that make fitting statistical models very simple. As we mention in the introduction, the basic output is minimal, and one needs to ask for the details by calling extractor functions.</p>
<section id="sec-defining-statistical-models-formulae" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sec-defining-statistical-models-formulae"><span class="header-section-number">11.1</span> Defining statistical models; formulae</h2>
<p>The template for a statistical model is a linear regression model with independent, homoscedastic errors</p>
<div class="display">
<div class="sourceCode" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>y_i <span class="ot">=</span> sum_{j<span class="ot">=</span><span class="dv">0</span>}<span class="sc">^</span>p beta_j x_{ij} <span class="sc">+</span> e_i, &nbsp;&nbsp;&nbsp;&nbsp;i <span class="ot">=</span> <span class="dv">1</span>, …, n,</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the e_i are NID(0, sigma^2). In matrix terms this would be written</p>
<div class="display">
<div class="sourceCode" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a>y <span class="ot">=</span> X &nbsp;beta <span class="sc">+</span> e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the <em>y</em> is the response vector, <em>X</em> is the <em>model matrix</em> or <em>design matrix</em> and has columns <em>x_0, x_1, …, x_p</em>, the determining variables. Very often <em>x_0</em> will be a column of ones defining an <em>intercept</em> term.</p>
<section id="sec-examples" class="level3">
<h3 class="anchored" data-anchor-id="sec-examples">Examples</h3>
<p>Before giving a formal specification, a few examples may usefully set the picture.</p>
<p>Suppose <code>y</code>, <code>x</code>, <code>x0</code>, <code>x1</code>, <code>x2</code>, … are numeric variables, <code>X</code> is a matrix and <code>A</code>, <code>B</code>, <code>C</code>, … are factors. The following formulae on the left side below specify statistical models as described on the right.</p>
<p><code>y ~ x</code><br>
<code>y ~ 1 + x</code></p>
<p>: Both imply the same simple linear regression model of <em>y</em> on <em>x</em>. The first has an implicit intercept term, and the second an explicit one.</p>
<p><code>y ~ 0 + x</code><br>
<code>y ~ -1 + x</code><br>
<code>y ~ x - 1</code></p>
<p>: Simple linear regression of <em>y</em> on <em>x</em> through the origin (that is, without an intercept term).</p>
<dl>
<dt><code>log(y) ~ x1 + x2</code></dt>
<dd>
<p>Multiple regression of the transformed variable, log(y), on <em>x1</em> and <em>x2</em> (with an implicit intercept term).</p>
</dd>
</dl>
<p><code>y ~ poly(x,2)</code><br>
<code>y ~ 1 + x + I(x^2)</code></p>
<p>: Polynomial regression of <em>y</em> on <em>x</em> of degree 2. The first form uses orthogonal polynomials, and the second uses explicit powers, as basis.</p>
<dl>
<dt><code>y ~ X + poly(x,2)</code></dt>
<dd>
<p>Multiple regression <em>y</em> with model matrix consisting of the matrix <em>X</em> as well as polynomial terms in <em>x</em> to degree 2.</p>
</dd>
<dt><code>y ~ A</code></dt>
<dd>
<p>Single classification analysis of variance model of <em>y</em>, with classes determined by <em>A</em>.</p>
</dd>
<dt><code>y ~ A + x</code></dt>
<dd>
<p>Single classification analysis of covariance model of <em>y</em>, with classes determined by <em>A</em>, and with covariate <em>x</em>.</p>
</dd>
</dl>
<p><code>y ~ A*B</code><br>
<code>y ~ A + B + A:B</code><br>
<code>y ~ B %in% A</code><br>
<code>y ~ A/B</code></p>
<p>: Two factor non-additive model of <em>y</em> on <em>A</em> and <em>B</em>. The first two specify the same crossed classification and the second two specify the same nested classification. In abstract terms all four specify the same model subspace.</p>
<p><code>y ~ (A + B + C)^2</code><br>
<code>y ~ A*B*C - A:B:C</code></p>
<p>: Three factor experiment but with a model containing main effects and two factor interactions only. Both formulae specify the same model.</p>
<p><code>y ~ A * x</code><br>
<code>y ~ A/x</code><br>
<code>y ~ A/(1 + x) - 1</code></p>
<p>: Separate simple linear regression models of <em>y</em> on <em>x</em> within the levels of <em>A</em>, with different codings. The last form produces explicit estimates of as many different intercepts and slopes as there are levels in <em>A</em>.</p>
<dl>
<dt><code>y ~ A*B + Error(C)</code></dt>
<dd>
<p>An experiment with two treatment factors, <em>A</em> and <em>B</em>, and error strata determined by factor <em>C</em>. For example a split plot experiment, with whole plots (and hence also subplots), determined by factor <em>C</em>.</p>
</dd>
</dl>
<p>The operator <code>~</code> is used to define a <em>model formula</em> in R. The form, for an ordinary linear model, is</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a>response <span class="sc">~</span> op_1 term_1 op_2 term_2 op_3 term_3 …</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where</p>
<dl>
<dt><var>response</var></dt>
<dd>
<p>is a vector or matrix, (or expression evaluating to a vector or matrix) defining the response variable(s).</p>
</dd>
<dt><var>op_i</var></dt>
<dd>
<p>is an operator, either <code>+</code> or <code>-</code>, implying the inclusion or exclusion of a term in the model, (the first is optional).</p>
</dd>
<dt><var>term_i</var></dt>
<dd>
<p>is either</p>
<ul>
<li>a vector or matrix expression, or <code>1</code>,</li>
<li>a factor, or</li>
<li>a <em>formula expression</em> consisting of factors, vectors or matrices connected by <em>formula operators</em>.</li>
</ul>
<p>In all cases each term defines a collection of columns either to be added to or removed from the model matrix. A <code>1</code> stands for an intercept column and is by default included in the model matrix unless explicitly removed.</p>
</dd>
</dl>
<p>The <em>formula operators</em> are similar in effect to the Wilkinson and Rogers notation used by such programs as Glim and Genstat. One inevitable change is that the operator <code>.</code>’ becomes ’<code>:</code> since the period is a valid name character in R.</p>
<p>The notation is summarized below (based on Chambers &amp; Hastie, 1992, p.29):</p>
<dl>
<dt><var>Y</var><var>~ ``M</var></dt>
<dd>
<p><var>Y</var> is modeled as <var>M</var>.</p>
</dd>
<dt><var>M_1</var><var>+ ``M_2</var></dt>
<dd>
<p>Include <var>M_1</var> and <var>M_2</var>.</p>
</dd>
<dt><var>M_1</var><var>- ``M_2</var></dt>
<dd>
<p>Include <var>M_1</var> leaving out terms of <var>M_2</var>.</p>
</dd>
<dt><var>M_1</var><var>: ``M_2</var></dt>
<dd>
<p>The tensor product of <var>M_1</var> and <var>M_2</var>. If both terms are factors, then the “subclasses” factor.</p>
</dd>
<dt><var>M_1</var><var>%in% ``M_2</var></dt>
<dd>
<p>Similar to <var>M_1</var><var>:``M_2</var>, but with a different coding.</p>
</dd>
<dt><var>M_1</var><var>* ``M_2</var></dt>
<dd>
<p><var>M_1</var><var>+ ``M_2</var><var>+ ``M_1</var><var>:``M_2</var>.</p>
</dd>
<dt><var>M_1</var><var>/ ``M_2</var></dt>
<dd>
<p><var>M_1</var><var>+ ``M_2</var><var>%in% ``M_1</var>.</p>
</dd>
<dt><var>M</var><var>^``n</var></dt>
<dd>
<p>All terms in <var>M</var> together with “interactions” up to order <var>n</var></p>
</dd>
<dt><var>I(``M</var><code>)</code></dt>
<dd>
<p>Insulate <var>M</var>. Inside <var>M</var> all operators have their normal arithmetic meaning, and that term appears in the model matrix.</p>
</dd>
</dl>
<p>Note that inside the parentheses that usually enclose function arguments all operators have their normal arithmetic meaning. The function <code>I()</code> is an identity function used to allow terms in model formulae to be defined using arithmetic operators.</p>
<p>Note particularly that the model formulae specify the <em>columns of the model matrix</em>, the specification of the parameters being implicit. This is not the case in other contexts, for example in specifying nonlinear models.</p>
</section>
<section id="sec-contrasts" class="level3">
<h3 class="anchored" data-anchor-id="sec-contrasts">Contrasts</h3>
<p>We need at least some idea how the model formulae specify the columns of the model matrix. This is easy if we have continuous variables, as each provides one column of the model matrix (and the intercept will provide a column of ones if included in the model).</p>
<p>What about a <em>k</em>-level factor <code>A</code>? The answer differs for unordered and ordered factors. For <em>unordered</em> factors <em>k - 1</em> columns are generated for the indicators of the second, …, <em>k</em>th levels of the factor. (Thus the implicit parameterization is to contrast the response at each level with that at the first.) For <em>ordered</em> factors the <em>k - 1</em> columns are the orthogonal polynomials on <em>1, …, k</em>, omitting the constant term.</p>
<p>Although the answer is already complicated, it is not the whole story. First, if the intercept is omitted in a model that contains a factor term, the first such term is encoded into <em>k</em> columns giving the indicators for all the levels. Second, the whole behavior can be changed by the <code>options</code> setting for <code>contrasts</code>. The default setting in R is</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The main reason for mentioning this is that R and S have different defaults for unordered factors, S using Helmert contrasts. So if you need to compare your results to those of a textbook or paper which used <span class="small">S-PLUS</span>, you will need to set</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.helmert"</span>, <span class="st">"contr.poly"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is a deliberate difference, as treatment contrasts (R’s default) are thought easier for newcomers to interpret.</p>
<p>We have still not finished, as the contrast scheme to be used can be set for each term in the model using the functions <code>contrasts</code> and <code>C</code>.</p>
<p>We have not yet considered interaction terms: these generate the products of the columns introduced for their component terms.</p>
<p>Although the details are complicated, model formulae in R will normally generate the models that an expert statistician would expect, provided that marginality is preserved. Fitting, for example, a model with an interaction but not the corresponding main effects will in general lead to surprising results, and is for experts only.</p>
</section>
</section>
<section id="sec-linear-models" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sec-linear-models"><span class="header-section-number">11.2</span> Linear models</h2>
<p>The basic function for fitting ordinary multiple models is <code>lm()</code>, and a streamlined version of the call is as follows:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1"></a><span class="sc">&gt;</span> fitted.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> data.frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a><span class="sc">&gt;</span> fm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> production)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would fit a multiple regression model of <em>y</em> on <em>x1</em> and <em>x2</em> (with implicit intercept term).</p>
<p>The important (but technically optional) parameter <code>data = production</code> specifies that any variables needed to construct the model should come first from the <code>production</code> <em>data frame</em>. <em>This is the case regardless of whether data frame <code>production</code> has been attached on the search path or not</em>.</p>
</section>
<section id="sec-generic-functions-for-extracting-model-information" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="sec-generic-functions-for-extracting-model-information"><span class="header-section-number">11.3</span> Generic functions for extracting model information</h2>
<p>The value of <code>lm()</code> is a fitted model object; technically a list of results of class <code>"lm"</code>. Information about the fitted model can then be displayed, extracted, plotted and so on by using generic functions that orient themselves to objects of class <code>"lm"</code>. These include</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb191-1"><a href="#cb191-1"></a>add1    deviance   formula      predict  step</span>
<span id="cb191-2"><a href="#cb191-2"></a>alias   drop1      kappa        print    summary</span>
<span id="cb191-3"><a href="#cb191-3"></a>anova   effects    labels       proj     vcov</span>
<span id="cb191-4"><a href="#cb191-4"></a>coef    family     plot         residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A brief description of the most commonly used ones is given below.</p>
<p><span id="index-anova"></span></p>
<p><var>anova(``object_1</var><var>, ``object_2</var><code>)</code></p>
<p>Compare a submodel with an outer model and produce an analysis of variance table.</p>
<p><var>coef(``object</var><code>)</code></p>
<p>Extract the regression coefficient (matrix).</p>
<p>Long form: <var>coefficients(``object</var><code>)</code>.</p>
<p><var>deviance(``object</var><code>)</code></p>
<p>Residual sum of squares, weighted if appropriate.</p>
<p><var>formula(``object</var><code>)</code></p>
<p>Extract the model formula.</p>
<p><var>plot(``object</var><code>)</code></p>
<p>Produce four plots, showing residuals, fitted values and some diagnostics.</p>
<p><var>predict(``object</var><var>, newdata=``data.frame</var><code>)</code></p>
<p>The data frame supplied must have variables specified with the same labels as the original. The value is a vector or matrix of predicted values corresponding to the determining variable values in <var>data.frame</var>.</p>
<p><var>print(``object</var><code>)</code></p>
<p>Print a concise version of the object. Most often used implicitly.</p>
<p><var>residuals(``object</var><code>)</code></p>
<p>Extract the (matrix of) residuals, weighted as appropriate.</p>
<p>Short form: <var>resid(``object</var><code>)</code>.</p>
<p><var>step(``object</var><code>)</code></p>
<p>Select a suitable model by adding or dropping terms and preserving hierarchies. The model with the smallest value of AIC (Akaike’s An Information Criterion) discovered in the stepwise search is returned.</p>
<p><var>summary(``object</var><code>)</code></p>
<p>Print a comprehensive summary of the results of the regression analysis.</p>
<p><var>vcov(``object</var><code>)</code></p>
<p>Returns the variance-covariance matrix of the main parameters of a fitted model object.</p>
</section>
<section id="sec-analysis-of-variance-and-model-comparison" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="sec-analysis-of-variance-and-model-comparison"><span class="header-section-number">11.4</span> Analysis of variance and model comparison</h2>
<p>The model fitting function <var>aov(``formula</var><var>, data=``data.frame</var><code>)</code> operates at the simplest level in a very similar way to the function <code>lm()</code>, and most of the generic functions listed in the table in <a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a> apply.</p>
<p>It should be noted that in addition <code>aov()</code> allows an analysis of models with multiple error strata such as split plot experiments, or balanced incomplete block designs with recovery of inter-block information. The model formula</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a>response <span class="sc">~</span> mean.formula <span class="sc">+</span> <span class="fu">Error</span>(strata.formula)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>specifies a multi-stratum experiment with error strata defined by the <var>strata.formula</var>. In the simplest case, <var>strata.formula</var> is simply a factor, when it defines a two strata experiment, namely between and within the levels of the factor.</p>
<p>For example, with all determining variables factors, a model formula such as that in:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a><span class="sc">&gt;</span> fm <span class="ot">&lt;-</span> <span class="fu">aov</span>(yield <span class="sc">~</span> v <span class="sc">+</span> n<span class="sc">*</span>p<span class="sc">*</span>k <span class="sc">+</span> <span class="fu">Error</span>(farms<span class="sc">/</span>blocks), <span class="at">data=</span>farm.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would typically be used to describe an experiment with mean model <code>v + n*p*k</code> and three error strata, namely “between farms”, “within farms, between blocks” and “within blocks”.</p>
<section id="sec-anova-tables" class="level3">
<h3 class="anchored" data-anchor-id="sec-anova-tables">ANOVA tables</h3>
<p>Note also that the analysis of variance table (or tables) are for a sequence of fitted models. The sums of squares shown are the decrease in the residual sums of squares resulting from an inclusion of <em>that term</em> in the model at <em>that place</em> in the sequence. Hence only for orthogonal experiments will the order of inclusion be inconsequential.</p>
<p>For multistratum experiments the procedure is first to project the response onto the error strata, again in sequence, and to fit the mean model to each projection. For further details, see Chambers &amp; Hastie (1992).</p>
<p>A more flexible alternative to the default full ANOVA table is to compare two or more models directly using the <code>anova()</code> function.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a><span class="sc">&gt;</span> <span class="fu">anova</span>(fitted.model<span class="fl">.1</span>, fitted.model<span class="fl">.2</span>, …)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The display is then an ANOVA table showing the differences between the fitted models when fitted in sequence. The fitted models being compared would usually be an hierarchical sequence, of course. This does not give different information to the default, but rather makes it easier to comprehend and control.</p>
</section>
</section>
<section id="sec-updating-fitted-models" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="sec-updating-fitted-models"><span class="header-section-number">11.5</span> Updating fitted models</h2>
<p>The <code>update()</code> function is largely a convenience function that allows a model to be fitted that differs from one previously fitted usually by just a few additional or removed terms. Its form is</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a><span class="sc">&gt;</span> new.model <span class="ot">&lt;-</span> <span class="fu">update</span>(old.model, new.formula)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the <var>new.formula</var> the special name consisting of a period, <code>.</code>, only, can be used to stand for “the corresponding part of the old model formula”. For example,</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a><span class="sc">&gt;</span> fm05 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5, <span class="at">data =</span> production)</span>
<span id="cb196-2"><a href="#cb196-2"></a><span class="sc">&gt;</span> fm6  <span class="ot">&lt;-</span> <span class="fu">update</span>(fm05, . <span class="sc">~</span> . <span class="sc">+</span> x6)</span>
<span id="cb196-3"><a href="#cb196-3"></a><span class="sc">&gt;</span> smf6 <span class="ot">&lt;-</span> <span class="fu">update</span>(fm6, <span class="fu">sqrt</span>(.) <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would fit a five variate multiple regression with variables (presumably) from the data frame <code>production</code>, fit an additional model including a sixth regressor variable, and fit a variant on the model where the response had a square root transform applied.</p>
<p>Note especially that if the <code>data=</code> argument is specified on the original call to the model fitting function, this information is passed on through the fitted model object to <code>update()</code> and its allies.</p>
<p>The name ‘<code>.</code>’ can also be used in other contexts, but with slightly different meaning. For example</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a><span class="sc">&gt;</span> fmfull <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> . , <span class="at">data =</span> production)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>would fit a model with response <code>y</code> and regressor variables <em>all other variables in the data frame <code>production</code></em>.</p>
<p>Other functions for exploring incremental sequences of models are <code>add1()</code>, <code>drop1()</code> and <code>step()</code>. The names of these give a good clue to their purpose, but for full details see the on-line help.</p>
</section>
<section id="sec-generalized-linear-models" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="sec-generalized-linear-models"><span class="header-section-number">11.6</span> Generalized linear models</h2>
<p>Generalized linear modeling is a development of linear models to accommodate both non-normal response distributions and transformations to linearity in a clean and straightforward way. A generalized linear model may be described in terms of the following sequence of assumptions:</p>
<ul>
<li><p>There is a response, <em>y</em>, of interest and stimulus variables x_1, x_2, …, whose values influence the distribution of the response.</p></li>
<li><p>The stimulus variables influence the distribution of <em>y</em> through <em>a single linear function, only</em>. This linear function is called the <em>linear predictor</em>, and is usually written</p>
<div class="display">
<div class="sourceCode" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>eta <span class="ot">=</span> beta_1 x_1 <span class="sc">+</span> beta_2 x_2 <span class="sc">+</span> … <span class="sc">+</span> beta_p x_p,</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>hence x_i has no influence on the distribution of <em>y</em> if and only if beta_i is zero.</p></li>
<li><p>The distribution of <em>y</em> is of the form</p>
<div class="display">
<div class="sourceCode" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a><span class="fu">f_Y</span>(y; mu, phi)</span>
<span id="cb199-2"><a href="#cb199-2"></a>  <span class="ot">=</span> <span class="fu">exp</span>((A<span class="sc">/</span>phi) <span class="sc">*</span> (y <span class="fu">lambda</span>(mu) <span class="sc">-</span> <span class="fu">gamma</span>(<span class="fu">lambda</span>(mu))) <span class="sc">+</span> <span class="fu">tau</span>(y, phi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where phi is a <em>scale parameter</em> (possibly known), and is constant for all observations, <em>A</em> represents a prior weight, assumed known but possibly varying with the observations, and $\mu$ is the mean of <em>y</em>. So it is assumed that the distribution of <em>y</em> is determined by its mean and possibly a scale parameter as well.</p></li>
<li><p>The mean, mu, is a smooth invertible function of the linear predictor:</p>
<div class="display">
<div class="sourceCode" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a>mu <span class="ot">=</span> <span class="fu">m</span>(eta),    eta <span class="ot">=</span> m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}(mu) <span class="ot">=</span> <span class="fu">ell</span>(mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and this inverse function, ell(), is called the <em>link function</em>.</p></li>
</ul>
<p>These assumptions are loose enough to encompass a wide class of models useful in statistical practice, but tight enough to allow the development of a unified methodology of estimation and inference, at least approximately. The reader is referred to any of the current reference works on the subject for full details, such as McCullagh &amp; Nelder (1989) or Dobson (1990).</p>
<section id="sec-families" class="level3">
<h3 class="anchored" data-anchor-id="sec-families">Families</h3>
<p>The class of generalized linear models handled by facilities supplied in R includes <em>gaussian</em>, <em>binomial</em>, <em>poisson</em>, <em>inverse gaussian</em> and <em>gamma</em> response distributions and also <em>quasi-likelihood</em> models where the response distribution is not explicitly specified. In the latter case the <em>variance function</em> must be specified as a function of the mean, but in other cases this function is implied by the response distribution.</p>
<p>Each response distribution admits a variety of link functions to connect the mean with the linear predictor. Those automatically available are shown in the following table:</p>
<div class="blockquotes-block">
<blockquote class="blockquote">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Family name</th>
<th style="text-align: left;">Link functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>binomial</code></td>
<td style="text-align: left;"><code>logit</code>, <code>probit</code>, <code>log</code>, <code>cloglog</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gaussian</code></td>
<td style="text-align: left;"><code>identity</code>, <code>log</code>, <code>inverse</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Gamma</code></td>
<td style="text-align: left;"><code>identity</code>, <code>inverse</code>, <code>log</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>inverse.gaussian</code></td>
<td style="text-align: left;"><code>1/mu^2</code>, <code>identity</code>, <code>inverse</code>, <code>log</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>poisson</code></td>
<td style="text-align: left;"><code>identity</code>, <code>log</code>, <code>sqrt</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>quasi</code></td>
<td style="text-align: left;"><code>logit</code>, <code>probit</code>, <code>cloglog</code>, <code>identity</code>, <code>inverse</code>, <code>log</code>, <code>1/mu^2</code>, <code>sqrt</code></td>
</tr>
</tbody>
</table>
</blockquote>
</div>
<p>The combination of a response distribution, a link function and various other pieces of information that are needed to carry out the modeling exercise is called the <em>family</em> of the generalized linear model.</p>
</section>
<section id="the-glm-function-sec-the-glm-function" class="level3">
<h3 class="anchored" data-anchor-id="the-glm-function-sec-the-glm-function">The <code>glm()</code> function {#sec-the-<code>glm()</code>-function}</h3>
<p>Since the distribution of the response depends on the stimulus variables through a single linear function <em>only</em>, the same mechanism as was used for linear models can still be used to specify the linear part of a generalized model. The family has to be specified in a different way.</p>
<p>The R function to fit a generalized linear model is <code>glm()</code> which uses the form</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a><span class="sc">&gt;</span> fitted.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, <span class="at">family=</span>family.generator, <span class="at">data=</span>data.frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The only new feature is the <var>family.generator</var>, which is the instrument by which the family is described. It is the name of a function that generates a list of functions and expressions that together define and control the model and estimation process. Although this may seem a little complicated at first sight, its use is quite simple.</p>
<p>The names of the standard, supplied family generators are given under “Family Name” in the table in <a href="Families.html">Families</a>. Where there is a choice of links, the name of the link may also be supplied with the family name, in parentheses as a parameter. In the case of the <code>quasi</code> family, the variance function may also be specified in this way.</p>
<p>Some examples make the process clear.</p>
</section>
<section id="the-gaussian-family-sec-the-gaussian-family" class="level3">
<h3 class="anchored" data-anchor-id="the-gaussian-family-sec-the-gaussian-family">The <code>gaussian</code> family {#sec-the-<code>gaussian</code>-family}</h3>
<p>A call such as</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a><span class="sc">&gt;</span> fm <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">family =</span> gaussian, <span class="at">data =</span> sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>achieves the same result as</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a><span class="sc">&gt;</span> fm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1<span class="sc">+</span>x2, <span class="at">data=</span>sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>but much less efficiently. Note how the gaussian family is not automatically provided with a choice of links, so no parameter is allowed. If a problem requires a gaussian family with a nonstandard link, this can usually be achieved through the <code>quasi</code> family, as we shall see later.</p>
</section>
<section id="the-binomial-family-sec-the-binomial-family" class="level3">
<h3 class="anchored" data-anchor-id="the-binomial-family-sec-the-binomial-family">The <code>binomial</code> family {#sec-the-<code>binomial</code>-family}</h3>
<p>Consider a small, artificial example, from Silvey (1970).</p>
<p>On the Aegean island of Kalythos the male inhabitants suffer from a congenital eye disease, the effects of which become more marked with increasing age. Samples of islander males of various ages were tested for blindness and the results recorded. The data is shown below:</p>
<p>The problem we consider is to fit both logistic and probit models to this data, and to estimate for each model the LD50, that is the age at which the chance of blindness for a male inhabitant is 50%.</p>
<p>If <em>y</em> is the number of blind at age <em>x</em> and <em>n</em> the number tested, both models have the form y ~ B(n, F(beta_0 + beta_1 x)) where for the probit case, F(z) = Phi(z) is the standard normal distribution function, and in the logit case (the default), F(z) = e^z/(1+e^z). In both cases the LD50 is LD50 = - beta_0/beta_1 that is, the point at which the argument of the distribution function is zero.</p>
<p>The first step is to set the data up as a data frame</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="sc">&gt;</span> kalythos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">35</span>,<span class="dv">45</span>,<span class="dv">55</span>,<span class="dv">70</span>), <span class="at">n =</span> <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">5</span>),</span>
<span id="cb204-2"><a href="#cb204-2"></a>                         <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">17</span>,<span class="dv">26</span>,<span class="dv">37</span>,<span class="dv">44</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To fit a binomial model using <code>glm()</code> there are three possibilities for the response:</p>
<ul>
<li>If the response is a <em>vector</em> it is assumed to hold <em>binary</em> data, and so must be a <em>0/1</em> vector.</li>
<li>If the response is a <em>two-column matrix</em> it is assumed that the first column holds the number of successes for the trial and the second holds the number of failures.</li>
<li>If the response is a <em>factor</em>, its first level is taken as failure (0) and all other levels as ‘success’ (1).</li>
</ul>
<p>Here we need the second of these conventions, so we add a matrix to our data frame:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a><span class="sc">&gt;</span> kalythos<span class="sc">$</span>Ymat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(kalythos<span class="sc">$</span>y, kalythos<span class="sc">$</span>n <span class="sc">-</span> kalythos<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To fit the models we use</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a><span class="sc">&gt;</span> fmp <span class="ot">&lt;-</span> <span class="fu">glm</span>(Ymat <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span>probit), <span class="at">data =</span> kalythos)</span>
<span id="cb206-2"><a href="#cb206-2"></a><span class="sc">&gt;</span> fml <span class="ot">&lt;-</span> <span class="fu">glm</span>(Ymat <span class="sc">~</span> x, <span class="at">family =</span> binomial, <span class="at">data =</span> kalythos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since the logit link is the default the parameter may be omitted on the second call. To see the results of each fit we could use</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(fmp)</span>
<span id="cb207-2"><a href="#cb207-2"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(fml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Both models fit (all too) well. To find the LD50 estimate we can use a simple function:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1"></a><span class="sc">&gt;</span> ld50 <span class="ot">&lt;-</span> <span class="cf">function</span>(b) <span class="sc">-</span>b[<span class="dv">1</span>]<span class="sc">/</span>b[<span class="dv">2</span>]</span>
<span id="cb208-2"><a href="#cb208-2"></a><span class="sc">&gt;</span> ldp <span class="ot">&lt;-</span> <span class="fu">ld50</span>(<span class="fu">coef</span>(fmp)); ldl <span class="ot">&lt;-</span> <span class="fu">ld50</span>(<span class="fu">coef</span>(fml)); <span class="fu">c</span>(ldp, ldl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The actual estimates from this data are 43.663 years and 43.601 years respectively.</p>
</section>
<section id="sec-poisson-models" class="level3">
<h3 class="anchored" data-anchor-id="sec-poisson-models">Poisson models</h3>
<p>With the Poisson family the default link is the <code>log</code>, and in practice the major use of this family is to fit surrogate Poisson log-linear models to frequency data, whose actual distribution is often multinomial. This is a large and important subject we will not discuss further here. It even forms a major part of the use of non-gaussian generalized models overall.</p>
<p>Occasionally genuinely Poisson data arises in practice and in the past it was often analyzed as gaussian data after either a log or a square-root transformation. As a graceful alternative to the latter, a Poisson generalized linear model may be fitted as in the following example:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a><span class="sc">&gt;</span> fmod <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> A <span class="sc">+</span> B <span class="sc">+</span> x, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span>sqrt),</span>
<span id="cb209-2"><a href="#cb209-2"></a>              <span class="at">data =</span> worm.counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-quasi-likelihood-models" class="level3">
<h3 class="anchored" data-anchor-id="sec-quasi-likelihood-models">Quasi-likelihood models</h3>
<p>For all families the variance of the response will depend on the mean and will have the scale parameter as a multiplier. The form of dependence of the variance on the mean is a characteristic of the response distribution; for example for the poisson distribution Var(y) = mu.</p>
<p>For quasi-likelihood estimation and inference the precise response distribution is not specified, but rather only a link function and the form of the variance function as it depends on the mean. Since quasi-likelihood estimation uses formally identical techniques to those for the gaussian distribution, this family provides a way of fitting gaussian models with non-standard link functions or variance functions, incidentally.</p>
<p>For example, consider fitting the non-linear regression y = theta_1 z_1 / (z_2 - theta_2) + e which may be written alternatively as y = 1 / (beta_1 x_1 + beta_2 x_2) + e where x_1 = z_2/z_1, x_2 = -1/z_1, beta_1 = 1/theta_1, and beta_2 = theta_2/theta_1. Supposing a suitable data frame to be set up we could fit this non-linear regression as</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a><span class="sc">&gt;</span> nlfit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb210-2"><a href="#cb210-2"></a>               <span class="at">family =</span> <span class="fu">quasi</span>(<span class="at">link=</span>inverse, <span class="at">variance=</span>constant),</span>
<span id="cb210-3"><a href="#cb210-3"></a>               <span class="at">data =</span> biochem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The reader is referred to the manual and the help document for further information, as needed.</p>
</section>
</section>
<section id="sec-nonlinear-least-squares-and-maximum-likelihood-models" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="sec-nonlinear-least-squares-and-maximum-likelihood-models"><span class="header-section-number">11.7</span> Nonlinear least squares and maximum likelihood models</h2>
<p>Certain forms of nonlinear model can be fitted by Generalized Linear Models (<code>glm()</code>). But in the majority of cases we have to approach the nonlinear curve fitting problem as one of nonlinear optimization. R’s nonlinear optimization routines are <code>optim()</code>, <code>nlm()</code> and <code>nlminb()</code>, We seek the parameter values that minimize some index of lack-of-fit, and they do this by trying out various parameter values iteratively. Unlike linear regression for example, there is no guarantee that the procedure will converge on satisfactory estimates. All the methods require initial guesses about what parameter values to try, and convergence may depend critically upon the quality of the starting values.</p>
<section id="sec-least-squares" class="level3">
<h3 class="anchored" data-anchor-id="sec-least-squares">Least squares</h3>
<p>One way to fit a nonlinear model is by minimizing the sum of the squared errors (SSE) or residuals. This method makes sense if the observed errors could have plausibly arisen from a normal distribution.</p>
<p>Here is an example from Bates &amp; Watts (1988), page 51. The data are:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.06</span>, <span class="fl">0.06</span>, <span class="fl">0.11</span>, <span class="fl">0.11</span>, <span class="fl">0.22</span>, <span class="fl">0.22</span>, <span class="fl">0.56</span>, <span class="fl">0.56</span>,</span>
<span id="cb211-2"><a href="#cb211-2"></a>         <span class="fl">1.10</span>, <span class="fl">1.10</span>)</span>
<span id="cb211-3"><a href="#cb211-3"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">47</span>, <span class="dv">97</span>, <span class="dv">107</span>, <span class="dv">123</span>, <span class="dv">139</span>, <span class="dv">159</span>, <span class="dv">152</span>, <span class="dv">191</span>, <span class="dv">201</span>, <span class="dv">207</span>, <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The fit criterion to be minimized is:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a><span class="sc">&gt;</span> fn <span class="ot">&lt;-</span> <span class="cf">function</span>(p) <span class="fu">sum</span>((y <span class="sc">-</span> (p[<span class="dv">1</span>] <span class="sc">*</span> x)<span class="sc">/</span>(p[<span class="dv">2</span>] <span class="sc">+</span> x))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In order to do the fit we need initial estimates of the parameters. One way to find sensible starting values is to plot the data, guess some parameter values, and superimpose the model curve using those values.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y)</span>
<span id="cb213-2"><a href="#cb213-2"></a><span class="sc">&gt;</span> xfit <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">02</span>, <span class="fl">1.1</span>, .<span class="dv">05</span>)</span>
<span id="cb213-3"><a href="#cb213-3"></a><span class="sc">&gt;</span> yfit <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="sc">*</span> xfit<span class="sc">/</span>(<span class="fl">0.1</span> <span class="sc">+</span> xfit)</span>
<span id="cb213-4"><a href="#cb213-4"></a><span class="sc">&gt;</span> <span class="fu">lines</span>(<span class="fu">spline</span>(xfit, yfit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We could do better, but these starting values of 200 and 0.1 seem adequate. Now do the fit:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a><span class="sc">&gt;</span> out <span class="ot">&lt;-</span> <span class="fu">nlm</span>(fn, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="fl">0.1</span>), <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After the fitting, <code>out$minimum</code> is the SSE, and <code>out$estimate</code> are the least squares estimates of the parameters. To obtain the approximate standard errors (SE) of the estimates we do:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a><span class="sc">&gt;</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="dv">2</span><span class="sc">*</span>out<span class="sc">$</span>minimum<span class="sc">/</span>(<span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">solve</span>(out<span class="sc">$</span>hessian)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>2</code> which is subtracted in the line above represents the number of parameters. A 95% confidence interval would be the parameter estimate +/- 1.96 SE. We can superimpose the least squares fit on a new plot:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y)</span>
<span id="cb216-2"><a href="#cb216-2"></a><span class="sc">&gt;</span> xfit <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">02</span>, <span class="fl">1.1</span>, .<span class="dv">05</span>)</span>
<span id="cb216-3"><a href="#cb216-3"></a><span class="sc">&gt;</span> yfit <span class="ot">&lt;-</span> <span class="fl">212.68384222</span> <span class="sc">*</span> xfit<span class="sc">/</span>(<span class="fl">0.06412146</span> <span class="sc">+</span> xfit)</span>
<span id="cb216-4"><a href="#cb216-4"></a><span class="sc">&gt;</span> <span class="fu">lines</span>(<span class="fu">spline</span>(xfit, yfit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The standard package <strong>stats</strong> provides much more extensive facilities for fitting non-linear models by least squares. The model we have just fitted is the Michaelis-Menten model, so we can use</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a><span class="sc">&gt;</span> df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb217-2"><a href="#cb217-2"></a><span class="sc">&gt;</span> fit <span class="ot">&lt;-</span> <span class="fu">nls</span>(y <span class="sc">~</span> <span class="fu">SSmicmen</span>(x, Vm, K), df)</span>
<span id="cb217-3"><a href="#cb217-3"></a><span class="sc">&gt;</span> fit</span>
<span id="cb217-4"><a href="#cb217-4"></a>Nonlinear regression model</span>
<span id="cb217-5"><a href="#cb217-5"></a>  model<span class="sc">:</span>  y <span class="sc">~</span> <span class="fu">SSmicmen</span>(x, Vm, K)</span>
<span id="cb217-6"><a href="#cb217-6"></a>   data<span class="sc">:</span>  df</span>
<span id="cb217-7"><a href="#cb217-7"></a>          Vm            K</span>
<span id="cb217-8"><a href="#cb217-8"></a><span class="fl">212.68370711</span>   <span class="fl">0.06412123</span></span>
<span id="cb217-9"><a href="#cb217-9"></a> residual sum<span class="sc">-</span>of<span class="sc">-</span>squares<span class="sc">:</span>  <span class="fl">1195.449</span></span>
<span id="cb217-10"><a href="#cb217-10"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(fit)</span>
<span id="cb217-11"><a href="#cb217-11"></a></span>
<span id="cb217-12"><a href="#cb217-12"></a>Formula<span class="sc">:</span> y <span class="sc">~</span> <span class="fu">SSmicmen</span>(x, Vm, K)</span>
<span id="cb217-13"><a href="#cb217-13"></a></span>
<span id="cb217-14"><a href="#cb217-14"></a>Parameters<span class="sc">:</span></span>
<span id="cb217-15"><a href="#cb217-15"></a>    Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)</span>
<span id="cb217-16"><a href="#cb217-16"></a>Vm <span class="fl">2.127e+02</span>  <span class="fl">6.947e+00</span>  <span class="fl">30.615</span> <span class="fl">3.24e-11</span></span>
<span id="cb217-17"><a href="#cb217-17"></a>K  <span class="fl">6.412e-02</span>  <span class="fl">8.281e-03</span>   <span class="fl">7.743</span> <span class="fl">1.57e-05</span></span>
<span id="cb217-18"><a href="#cb217-18"></a></span>
<span id="cb217-19"><a href="#cb217-19"></a>Residual standard error<span class="sc">:</span> <span class="fl">10.93</span> on <span class="dv">10</span> degrees of freedom</span>
<span id="cb217-20"><a href="#cb217-20"></a></span>
<span id="cb217-21"><a href="#cb217-21"></a>Correlation of Parameter Estimates<span class="sc">:</span></span>
<span id="cb217-22"><a href="#cb217-22"></a>      Vm</span>
<span id="cb217-23"><a href="#cb217-23"></a>K <span class="fl">0.7651</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-maximum-likelihood" class="level3">
<h3 class="anchored" data-anchor-id="sec-maximum-likelihood">Maximum likelihood</h3>
<p>Maximum likelihood is a method of nonlinear model fitting that applies even if the errors are not normal. The method finds the parameter values which maximize the log likelihood, or equivalently which minimize the negative log-likelihood. Here is an example from Dobson (1990), pp. 108–111. This example fits a logistic model to dose-response data, which clearly could also be fit by <code>glm()</code>. The data are:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.6907</span>, <span class="fl">1.7242</span>, <span class="fl">1.7552</span>, <span class="fl">1.7842</span>, <span class="fl">1.8113</span>,</span>
<span id="cb218-2"><a href="#cb218-2"></a>         <span class="fl">1.8369</span>, <span class="fl">1.8610</span>, <span class="fl">1.8839</span>)</span>
<span id="cb218-3"><a href="#cb218-3"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="dv">6</span>, <span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">28</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">61</span>, <span class="dv">60</span>)</span>
<span id="cb218-4"><a href="#cb218-4"></a><span class="sc">&gt;</span> n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">56</span>, <span class="dv">63</span>, <span class="dv">59</span>, <span class="dv">62</span>, <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The negative log-likelihood to minimize is:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="sc">&gt;</span> fn <span class="ot">&lt;-</span> <span class="cf">function</span>(p)</span>
<span id="cb219-2"><a href="#cb219-2"></a>   <span class="fu">sum</span>( <span class="sc">-</span> (y<span class="sc">*</span>(p[<span class="dv">1</span>]<span class="sc">+</span>p[<span class="dv">2</span>]<span class="sc">*</span>x) <span class="sc">-</span> n<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(p[<span class="dv">1</span>]<span class="sc">+</span>p[<span class="dv">2</span>]<span class="sc">*</span>x))</span>
<span id="cb219-3"><a href="#cb219-3"></a>           <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">choose</span>(n, y)) ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We pick sensible starting values and do the fit:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1"></a><span class="sc">&gt;</span> out <span class="ot">&lt;-</span> <span class="fu">nlm</span>(fn, <span class="at">p =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">20</span>), <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After the fitting, <code>out$minimum</code> is the negative log-likelihood, and <code>out$estimate</code> are the maximum likelihood estimates of the parameters. To obtain the approximate SEs of the estimates we do:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a><span class="sc">&gt;</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(out<span class="sc">$</span>hessian)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A 95% confidence interval would be the parameter estimate +/- 1.96 SE.</p>
</section>
</section>
<section id="sec-some-non-standard-models" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="sec-some-non-standard-models"><span class="header-section-number">11.8</span> Some non-standard models</h2>
<p>We conclude this chapter with just a brief mention of some of the other facilities available in R for special regression and data analysis problems.</p>
<ul>
<li><p><span id="index-Mixed-models"></span> <strong>Mixed models.</strong> The recommended <a href="https://CRAN.R-project.org/package=nlme"><strong>nlme</strong></a> package provides functions <code>lme()</code> and <code>nlme()</code> for linear and non-linear mixed-effects models, that is linear and non-linear regressions in which some of the coefficients correspond to random effects. These functions make heavy use of formulae to specify the models.</p></li>
<li><p><span id="index-Local-approximating-regressions"></span> <strong>Local approximating regressions.</strong> The <code>loess()</code> function fits a nonparametric regression by using a locally weighted regression. Such regressions are useful for highlighting a trend in messy data or for data reduction to give some insight into a large data set.</p>
<p>Function <code>loess</code> is in the standard package <strong>stats</strong>, together with code for projection pursuit regression.</p></li>
<li><p><span id="index-Robust-regression"></span> <strong>Robust regression.</strong> There are several functions available for fitting regression models in a way resistant to the influence of extreme outliers in the data. Function <code>lqs</code> in the recommended package <a href="https://CRAN.R-project.org/package=MASS"><strong>MASS</strong></a> provides state-of-art algorithms for highly-resistant fits. Less resistant but statistically more efficient methods are available in packages, for example function <code>rlm</code> in package <a href="https://CRAN.R-project.org/package=MASS"><strong>MASS</strong></a>.</p></li>
<li><p><span id="index-Additive-models"></span> <strong>Additive models.</strong> This technique aims to construct a regression function from smooth additive functions of the determining variables, usually one for each determining variable. Functions <code>avas</code> and <code>ace</code> in package <a href="https://CRAN.R-project.org/package=acepack"><strong>acepack</strong></a> and functions <code>bruto</code> and <code>mars</code> in package <a href="https://CRAN.R-project.org/package=mda"><strong>mda</strong></a> provide some examples of these techniques in user-contributed packages to R. An extension is <strong>Generalized Additive Models</strong>, implemented in user-contributed packages <a href="https://CRAN.R-project.org/package=gam"><strong>gam</strong></a> and <a href="https://CRAN.R-project.org/package=mgcv"><strong>mgcv</strong></a>.</p></li>
<li><p><span id="index-Tree_002dbased-models"></span> <strong>Tree-based models.</strong> Rather than seek an explicit global linear model for prediction or interpretation, tree-based models seek to bifurcate the data, recursively, at critical points of the determining variables in order to partition the data ultimately into groups that are as homogeneous as possible within, and as heterogeneous as possible between. The results often lead to insights that other data analysis methods tend not to yield.</p>
<p>Models are again specified in the ordinary linear model form. The model fitting function is <code>tree()</code>, but many other generic functions such as <code>plot()</code> and <code>text()</code> are well adapted to displaying the results of a tree-based model fit in a graphical way.</p>
<p>Tree models are available in R <em>via</em> the user-contributed packages <a href="https://CRAN.R-project.org/package=rpart"><strong>rpart</strong></a> and <a href="https://CRAN.R-project.org/package=tree"><strong>tree</strong></a>.</p></li>
</ul>
</section>
</section>
<section id="sec-graphical-procedures" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Graphical procedures</h1>
<p>Graphical facilities are an important and extremely versatile component of the R environment. It is possible to use the facilities to display a wide variety of statistical graphs and also to build entirely new types of graph.</p>
<p>The graphics facilities can be used in both interactive and batch modes, but in most cases, interactive use is more productive. Interactive use is also easy because at startup time R initiates a graphics <em>device driver</em> which opens a special <em>graphics window</em> for the display of interactive graphics. Although this is done automatically, it may useful to know that the command used is <code>X11()</code> under UNIX, <code>windows()</code> under Windows and <code>quartz()</code> under macOS. A new device can always be opened by <code>dev.new()</code>.</p>
<p>Once the device driver is running, R plotting commands can be used to produce a variety of graphical displays and to create entirely new kinds of display.</p>
<p>Plotting commands are divided into three basic groups:</p>
<ul>
<li><strong>High-level</strong> plotting functions create a new plot on the graphics device, possibly with axes, labels, titles and so on.</li>
<li><strong>Low-level</strong> plotting functions add more information to an existing plot, such as extra points, lines and labels.</li>
<li><strong>Interactive</strong> graphics functions allow you interactively add information to, or extract information from, an existing plot, using a pointing device such as a mouse.</li>
</ul>
<p>In addition, R maintains a list of <em>graphical parameters</em> which can be manipulated to customize your plots.</p>
<p>This manual only describes what are known as ‘base’ graphics. A separate graphics sub-system in package <strong>grid</strong> coexists with base – it is more powerful but harder to use. There is a recommended package <a href="https://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a> which builds on <strong>grid</strong> and provides ways to produce multi-panel plots akin to those in the <em>Trellis</em> system in S.</p>
<section id="sec-high-level-plotting-commands" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sec-high-level-plotting-commands"><span class="header-section-number">12.1</span> High-level plotting commands</h2>
<p>High-level plotting functions are designed to generate a complete plot of the data passed as arguments to the function. Where appropriate, axes, labels and titles are automatically generated (unless you request otherwise.) High-level plotting commands always start a new plot, erasing the current plot if necessary.</p>
<section id="the-plot-function-sec-the-plot-function" class="level3">
<h3 class="anchored" data-anchor-id="the-plot-function-sec-the-plot-function">The <code>plot()</code> function {#sec-the-<code>plot()</code>-function}</h3>
<p>One of the most frequently used plotting functions in R is the <code>plot()</code> function. This is a <em>generic</em> function: the type of plot produced is dependent on the type or <em>class</em> of the first argument.</p>
<p><var>plot(``x</var><var>, ``y</var><code>)</code><br>
<var>plot(``xy</var><code>)</code></p>
<p>: If <var>x</var> and <var>y</var> are vectors, <var>plot(``x</var><var>, ``y</var><code>)</code> produces a scatterplot of <var>y</var> against <var>x</var>. The same effect can be produced by supplying one argument (second form) as either a list containing two elements <var>x</var> and <var>y</var> or a two-column matrix.</p>
<dl>
<dt><var>plot(``x</var><code>)</code></dt>
<dd>
<p>If <var>x</var> is a time series, this produces a time-series plot. If <var>x</var> is a numeric vector, it produces a plot of the values in the vector against their index in the vector. If <var>x</var> is a complex vector, it produces a plot of imaginary versus real parts of the vector elements.</p>
</dd>
</dl>
<p><var>plot(``f</var><code>)</code><br>
<var>plot(``f</var><var>, ``y</var><code>)</code></p>
<p>: <var>f</var> is a factor object, <var>y</var> is a numeric vector. The first form generates a bar plot of <var>f</var>; the second form produces boxplots of <var>y</var> for each level of <var>f</var>.</p>
<p><var>plot(``df</var><code>)</code><br>
<var>plot(~ ``expr</var><code>)</code><br>
<var>plot(``y</var><var>~ ``expr</var><code>)</code></p>
<p>: <var>df</var> is a data frame, <var>y</var> is any object, <var>expr</var> is a list of object names separated by <code>+</code> (e.g., <code>a + b + c</code>). The first two forms produce distributional plots of the variables in a data frame (first form) or of a number of named objects (second form). The third form plots <var>y</var> against every object named in <var>expr</var>.</p>
</section>
<section id="sec-displaying-multivariate-data" class="level3">
<h3 class="anchored" data-anchor-id="sec-displaying-multivariate-data">Displaying multivariate data</h3>
<p>R provides two very useful functions for representing multivariate data. If <code>X</code> is a numeric matrix or data frame, the command</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a><span class="sc">&gt;</span> <span class="fu">pairs</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a pairwise scatterplot matrix of the variables defined by the columns of <code>X</code>, that is, every column of <code>X</code> is plotted against every other column of <code>X</code> and the resulting <em>n(n-1)</em> plots are arranged in a matrix with plot scales constant over the rows and columns of the matrix.</p>
<p>When three or four variables are involved a <em>coplot</em> may be more enlightening. If <code>a</code> and <code>b</code> are numeric vectors and <code>c</code> is a numeric vector or factor object (all of the same length), then the command</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(a <span class="sc">~</span> b <span class="sc">|</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a number of scatterplots of <code>a</code> against <code>b</code> for given values of <code>c</code>. If <code>c</code> is a factor, this simply means that <code>a</code> is plotted against <code>b</code> for every level of <code>c</code>. When <code>c</code> is numeric, it is divided into a number of <em>conditioning intervals</em> and for each interval <code>a</code> is plotted against <code>b</code> for values of <code>c</code> within the interval. The number and position of intervals can be controlled with <code>given.values=</code> argument to <code>coplot()</code>—the function <code>co.intervals()</code> is useful for selecting intervals. You can also use two <em>given</em> variables with a command like</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(a <span class="sc">~</span> b <span class="sc">|</span> c <span class="sc">+</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which produces scatterplots of <code>a</code> against <code>b</code> for every joint conditioning interval of <code>c</code> and <code>d</code>.</p>
<p>The <code>coplot()</code> and <code>pairs()</code> function both take an argument <code>panel=</code> which can be used to customize the type of plot which appears in each panel. The default is <code>points()</code> to produce a scatterplot but by supplying some other low-level graphics function of two vectors <code>x</code> and <code>y</code> as the value of <code>panel=</code> you can produce any type of plot you wish. An example panel function useful for coplots is <code>panel.smooth()</code>.</p>
</section>
<section id="sec-display-graphics" class="level3">
<h3 class="anchored" data-anchor-id="sec-display-graphics">Display graphics</h3>
<p>Other high-level graphics functions produce different types of plots. Some examples are:</p>
<p><code>qqnorm(x)</code><br>
<code>qqline(x)</code><br>
<code>qqplot(x, y)</code></p>
<p>: <span id="index-qqnorm-1"></span></p>
<pre><code>Distribution-comparison plots. The first form plots the numeric
vector `x` against the expected Normal order scores (a normal scores
plot) and the second adds a straight line to such a plot by drawing
a line through the distribution and data quartiles. The third form
plots the quantiles of `x` against those of `y` to compare their
respective distributions.</code></pre>
<p><code>hist(x)</code><br>
<var>hist(x, nclass=``n</var><code>)</code><br>
<var>hist(x, breaks=``b</var><code>, …)</code></p>
<p>: <span id="index-hist-1"></span></p>
<pre><code>Produces a histogram of the numeric vector `x`. A sensible number of
classes is usually chosen, but a recommendation can be given with
the `nclass=` argument. Alternatively, the breakpoints can be
specified exactly with the `breaks=` argument. If the
`probability=TRUE` argument is given, the bars represent relative
frequencies divided by bin width instead of counts.</code></pre>
<dl>
<dt><code>dotchart(x, …)</code></dt>
<dd>
<p><span id="index-dotchart"></span></p>
<p>Constructs a dotchart of the data in <code>x</code>. In a dotchart the <em>y</em>-axis gives a labelling of the data in <code>x</code> and the <em>x</em>-axis gives its value. For example it allows easy visual selection of all data entries with values lying in specified ranges.</p>
</dd>
</dl>
<p><code>image(x, y, z, …)</code><br>
<code>contour(x, y, z, …)</code><br>
<code>persp(x, y, z, …)</code></p>
<p>: <span id="index-image"></span></p>
<pre><code>Plots of three variables. The `image` plot draws a grid of
rectangles using different colours to represent the value of `z`,
the `contour` plot draws contour lines to represent the value of
`z`, and the `persp` plot draws a 3D surface.</code></pre>
</section>
<section id="sec-arguments-to-high-level-plotting-functions" class="level3">
<h3 class="anchored" data-anchor-id="sec-arguments-to-high-level-plotting-functions">Arguments to high-level plotting functions</h3>
<p>There are a number of arguments which may be passed to high-level graphics functions, as follows:</p>
<dl>
<dt><code>add=TRUE</code></dt>
<dd>
<p>Forces the function to act as a low-level graphics function, superimposing the plot on the current plot (some functions only).</p>
</dd>
<dt><code>axes=FALSE</code></dt>
<dd>
<p>Suppresses generation of axes—useful for adding your own custom axes with the <code>axis()</code> function. The default, <code>axes=TRUE</code>, means include axes.</p>
</dd>
</dl>
<p><code>log="x"</code><br>
<code>log="y"</code><br>
<code>log="xy"</code></p>
<p>: Causes the <em>x</em>, <em>y</em> or both axes to be logarithmic. This will work for many, but not all, types of plot.</p>
<dl>
<dt><code>type=</code></dt>
<dd>
<p>The <code>type=</code> argument controls the type of plot produced, as follows:</p>
<dl>
<dt><code>type="p"</code></dt>
<dd>
<p>Plot individual points (the default)</p>
</dd>
<dt><code>type="l"</code></dt>
<dd>
<p>Plot lines</p>
</dd>
<dt><code>type="b"</code></dt>
<dd>
<p>Plot points connected by lines (<em>both</em>)</p>
</dd>
<dt><code>type="o"</code></dt>
<dd>
<p>Plot points overlaid by lines</p>
</dd>
<dt><code>type="h"</code></dt>
<dd>
<p>Plot vertical lines from points to the zero axis (<em>high-density</em>)</p>
</dd>
</dl>
<p><code>type="s"</code><br>
<code>type="S"</code></p>
<p>: Step-function plots. In the first form, the top of the vertical defines the point; in the second, the bottom.</p>
<dl>
<dt><code>type="n"</code></dt>
<dd>
<p>No plotting at all. However axes are still drawn (by default) and the coordinate system is set up according to the data. Ideal for creating plots with subsequent low-level graphics functions.</p>
</dd>
</dl>
</dd>
</dl>
<p><var>xlab=``string</var><br>
<var>ylab=``string</var></p>
<p>: Axis labels for the <em>x</em> and <em>y</em> axes. Use these arguments to change the default labels, usually the names of the objects used in the call to the high-level plotting function.</p>
<dl>
<dt><var>main=``string</var></dt>
<dd>
<p>Figure title, placed at the top of the plot in a large font.</p>
</dd>
<dt><var>sub=``string</var></dt>
<dd>
<p>Sub-title, placed just below the <em>x</em>-axis in a smaller font.</p>
</dd>
</dl>
</section>
</section>
<section id="sec-low-level-plotting-commands" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sec-low-level-plotting-commands"><span class="header-section-number">12.2</span> Low-level plotting commands</h2>
<p>Sometimes the high-level plotting functions don’t produce exactly the kind of plot you desire. In this case, low-level plotting commands can be used to add extra information (such as points, lines or text) to the current plot.</p>
<p>Some of the more useful low-level plotting functions are:</p>
<p><code>points(x, y)</code><br>
<code>lines(x, y)</code></p>
<p>: <span id="index-points"></span></p>
<pre><code>Adds points or connected lines to the current plot. `plot()`'s
`type=` argument can also be passed to these functions (and defaults
to `"p"` for `points()` and `"l"` for `lines()`.)</code></pre>
<dl>
<dt><code>text(x, y, labels, …)</code></dt>
<dd>
<p><span id="index-text"></span></p>
<p>Add text to a plot at points given by <code>x, y</code>. Normally <code>labels</code> is an integer or character vector in which case <code>labels[i]</code> is plotted at point <code>(x[i], y[i])</code>. The default is <code>1:length(x)</code>.</p>
<p><strong>Note</strong>: This function is often used in the sequence</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y, <span class="at">type=</span><span class="st">"n"</span>); <span class="fu">text</span>(x, y, names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The graphics parameter <code>type="n"</code> suppresses the points but sets up the axes, and the <code>text()</code> function supplies special characters, as specified by the character vector <code>names</code> for the points.</p>
</dd>
</dl>
<p><code>abline(a, b)</code><br>
<var>abline(h=``y</var><code>)</code><br>
<var>abline(v=``x</var><code>)</code><br>
<var>abline(``lm.obj</var><code>)</code></p>
<p>: <span id="index-abline"></span></p>
<pre><code>Adds a line of slope `b` and intercept `a` to the current plot.
`h=``y`{.variable} may be used to specify *y*-coordinates for the
heights of horizontal lines to go across a plot, and
`v=``x`{.variable} similarly for the *x*-coordinates for vertical
lines. Also `lm.obj`{.variable} may be list with a `coefficients`
component of length 2 (such as the result of model-fitting
functions,) which are taken as an intercept and slope, in that
order.</code></pre>
<dl>
<dt><code>polygon(x, y, …)</code></dt>
<dd>
<p><span id="index-polygon"></span></p>
<p>Draws a polygon defined by the ordered vertices in (<code>x</code>, <code>y</code>) and (optionally) shade it in with hatch lines, or fill it if the graphics device allows the filling of figures.</p>
</dd>
<dt><code>legend(x, y, legend, …)</code></dt>
<dd>
<p><span id="index-legend"></span></p>
<p>Adds a legend to the current plot at the specified position. Plotting characters, line styles, colors etc., are identified with the labels in the character vector <code>legend</code>. At least one other argument <var>v</var> (a vector the same length as <code>legend</code>) with the corresponding values of the plotting unit must also be given, as follows:</p>
<dl>
<dt><var>legend( , fill=``v</var><code>)</code></dt>
<dd>
<p>Colors for filled boxes</p>
</dd>
<dt><var>legend( , col=``v</var><code>)</code></dt>
<dd>
<p>Colors in which points or lines will be drawn</p>
</dd>
<dt><var>legend( , lty=``v</var><code>)</code></dt>
<dd>
<p>Line styles</p>
</dd>
<dt><var>legend( , lwd=``v</var><code>)</code></dt>
<dd>
<p>Line widths</p>
</dd>
<dt><var>legend( , pch=``v</var><code>)</code></dt>
<dd>
<p>Plotting characters (character vector)</p>
</dd>
</dl>
</dd>
<dt><code>title(main, sub)</code></dt>
<dd>
<p><span id="index-title"></span></p>
<p>Adds a title <code>main</code> to the top of the current plot in a large font and (optionally) a sub-title <code>sub</code> at the bottom in a smaller font.</p>
</dd>
<dt><code>axis(side, …)</code></dt>
<dd>
<p><span id="index-axis"></span></p>
<p>Adds an axis to the current plot on the side given by the first argument (1 to 4, counting clockwise from the bottom.) Other arguments control the positioning of the axis within or beside the plot, and tick positions and labels. Useful for adding custom axes after calling <code>plot()</code> with the <code>axes=FALSE</code> argument.</p>
</dd>
</dl>
<p>Low-level plotting functions usually require some positioning information (e.g., <em>x</em> and <em>y</em> coordinates) to determine where to place the new plot elements. Coordinates are given in terms of <em>user coordinates</em> which are defined by the previous high-level graphics command and are chosen based on the supplied data.</p>
<p>Where <code>x</code> and <code>y</code> arguments are required, it is also sufficient to supply a single argument being a list with elements named <code>x</code> and <code>y</code>. Similarly a matrix with two columns is also valid input. In this way functions such as <code>locator()</code> (see below) may be used to specify positions on a plot interactively.</p>
<section id="sec-mathematical-annotation" class="level3">
<h3 class="anchored" data-anchor-id="sec-mathematical-annotation">Mathematical annotation</h3>
<p>In some cases, it is useful to add mathematical symbols and formulae to a plot. This can be achieved in R by specifying an <em>expression</em> rather than a character string in any one of <code>text</code>, <code>mtext</code>, <code>axis</code>, or <code>title</code>. For example, the following code draws the formula for the Binomial probability function:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(x, y, <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bgroup</span>(<span class="st">"("</span>, <span class="fu">atop</span>(n, x), <span class="st">")"</span>), p<span class="sc">^</span>x, q<span class="sc">^</span>{n<span class="sc">-</span>x})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More information, including a full listing of the features available can obtained from within R using the commands:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(plotmath)</span>
<span id="cb232-2"><a href="#cb232-2"></a><span class="sc">&gt;</span> <span class="fu">example</span>(plotmath)</span>
<span id="cb232-3"><a href="#cb232-3"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(plotmath)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-hershey-vector-fonts" class="level3">
<h3 class="anchored" data-anchor-id="sec-hershey-vector-fonts">Hershey vector fonts</h3>
<p>It is possible to specify Hershey vector fonts for rendering text when using the <code>text</code> and <code>contour</code> functions. There are three reasons for using the Hershey fonts:</p>
<ul>
<li>Hershey fonts can produce better output, especially on a computer screen, for rotated and/or small text.</li>
<li>Hershey fonts provide certain symbols that may not be available in the standard fonts. In particular, there are zodiac signs, cartographic symbols and astronomical symbols.</li>
<li>Hershey fonts provide Cyrillic and Japanese (Kana and Kanji) characters.</li>
</ul>
<p>More information, including tables of Hershey characters can be obtained from within R using the commands:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a><span class="sc">&gt;</span> <span class="fu">help</span>(Hershey)</span>
<span id="cb233-2"><a href="#cb233-2"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(Hershey)</span>
<span id="cb233-3"><a href="#cb233-3"></a><span class="sc">&gt;</span> <span class="fu">help</span>(Japanese)</span>
<span id="cb233-4"><a href="#cb233-4"></a><span class="sc">&gt;</span> <span class="fu">demo</span>(Japanese)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sec-interacting-with-graphics" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="sec-interacting-with-graphics"><span class="header-section-number">12.3</span> Interacting with graphics</h2>
<p>R also provides functions which allow users to extract or add information to a plot using a mouse. The simplest of these is the <code>locator()</code> function:</p>
<dl>
<dt><code>locator(n, type)</code></dt>
<dd>
<p><span id="index-locator"></span></p>
<p>Waits for the user to select locations on the current plot using the left mouse button. This continues until <code>n</code> (default 512) points have been selected, or another mouse button is pressed. The <code>type</code> argument allows for plotting at the selected points and has the same effect as for high-level graphics commands; the default is no plotting. <code>locator()</code> returns the locations of the points selected as a list with two components <code>x</code> and <code>y</code>.</p>
</dd>
</dl>
<p><code>locator()</code> is usually called with no arguments. It is particularly useful for interactively selecting positions for graphic elements such as legends or labels when it is difficult to calculate in advance where the graphic should be placed. For example, to place some informative text near an outlying point, the command</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(<span class="fu">locator</span>(<span class="dv">1</span>), <span class="st">"Outlier"</span>, <span class="at">adj=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>may be useful. (<code>locator()</code> will be ignored if the current device, such as <code>postscript</code> does not support interactive pointing.)</p>
<dl>
<dt><code>identify(x, y, labels)</code></dt>
<dd>
<p><span id="index-identify"></span></p>
<p>Allow the user to highlight any of the points defined by <code>x</code> and <code>y</code> (using the left mouse button) by plotting the corresponding component of <code>labels</code> nearby (or the index number of the point if <code>labels</code> is absent). Returns the indices of the selected points when another button is pressed.</p>
</dd>
</dl>
<p>Sometimes we want to identify particular <em>points</em> on a plot, rather than their positions. For example, we may wish the user to select some observation of interest from a graphical display and then manipulate that observation in some way. Given a number of <em>(x, y)</em> coordinates in two numeric vectors <code>x</code> and <code>y</code>, we could use the <code>identify()</code> function as follows:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y)</span>
<span id="cb235-2"><a href="#cb235-2"></a><span class="sc">&gt;</span> <span class="fu">identify</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>identify()</code> functions performs no plotting itself, but simply allows the user to move the mouse pointer and click the left mouse button near a point. If there is a point near the mouse pointer it will be marked with its index number (that is, its position in the <code>x</code>/<code>y</code> vectors) plotted nearby. Alternatively, you could use some informative string (such as a case name) as a highlight by using the <code>labels</code> argument to <code>identify()</code>, or disable marking altogether with the <code>plot = FALSE</code> argument. When the process is terminated (see above), <code>identify()</code> returns the indices of the selected points; you can use these indices to extract the selected points from the original vectors <code>x</code> and <code>y</code>.</p>
</section>
<section id="sec-using-graphics-parameters" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="sec-using-graphics-parameters"><span class="header-section-number">12.4</span> Using graphics parameters</h2>
<p>When creating graphics, particularly for presentation or publication purposes, R’s defaults do not always produce exactly that which is required. You can, however, customize almost every aspect of the display using <em>graphics parameters</em>. R maintains a list of a large number of graphics parameters which control things such as line style, colors, figure arrangement and text justification among many others. Every graphics parameter has a name (such as <code>col</code>, which controls colors,) and a value (a color number, for example.)</p>
<p>A separate list of graphics parameters is maintained for each active device, and each device has a default set of parameters when initialized. Graphics parameters can be set in two ways: either permanently, affecting all graphics functions which access the current device; or temporarily, affecting only a single graphics function call.</p>
<section id="permanent-changes-the-par-function-sec-permanent-changes-the-par-function" class="level3">
<h3 class="anchored" data-anchor-id="permanent-changes-the-par-function-sec-permanent-changes-the-par-function">Permanent changes: The <code>par()</code> function {#sec-permanent-changes:-the-<code>par()</code>-function}</h3>
<p>The <code>par()</code> function is used to access and modify the list of graphics parameters for the current graphics device.</p>
<dl>
<dt><code>par()</code></dt>
<dd>
<p>Without arguments, returns a list of all graphics parameters and their values for the current device.</p>
</dd>
<dt><code>par(c("col", "lty"))</code></dt>
<dd>
<p>With a character vector argument, returns only the named graphics parameters (again, as a list.)</p>
</dd>
<dt><code>par(col=4, lty=2)</code></dt>
<dd>
<p>With named arguments (or a single list argument), sets the values of the named graphics parameters, and returns the original values of the parameters as a list.</p>
</dd>
</dl>
<p>Setting graphics parameters with the <code>par()</code> function changes the value of the parameters <em>permanently</em>, in the sense that all future calls to graphics functions (on the current device) will be affected by the new value. You can think of setting graphics parameters in this way as setting “default” values for the parameters, which will be used by all graphics functions unless an alternative value is given.</p>
<p>Note that calls to <code>par()</code> <em>always</em> affect the global values of graphics parameters, even when <code>par()</code> is called from within a function. This is often undesirable behavior—usually we want to set some graphics parameters, do some plotting, and then restore the original values so as not to affect the user’s R session. You can restore the initial values by saving the result of <code>par()</code> when making changes, and restoring the initial values when plotting is complete.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a><span class="sc">&gt;</span> oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">col=</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb236-2"><a href="#cb236-2"></a>  … plotting commands …</span>
<span id="cb236-3"><a href="#cb236-3"></a><span class="sc">&gt;</span> <span class="fu">par</span>(oldpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To save and restore <em>all</em> settable<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a> graphical parameters use</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a><span class="sc">&gt;</span> oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly=</span><span class="cn">TRUE</span>)</span>
<span id="cb237-2"><a href="#cb237-2"></a>  … plotting commands …</span>
<span id="cb237-3"><a href="#cb237-3"></a><span class="sc">&gt;</span> <span class="fu">par</span>(oldpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-temporary-changes:-arguments-to-graphics-functions" class="level3">
<h3 class="anchored" data-anchor-id="sec-temporary-changes:-arguments-to-graphics-functions">Temporary changes: Arguments to graphics functions</h3>
<p>Graphics parameters may also be passed to (almost) any graphics function as named arguments. This has the same effect as passing the arguments to the <code>par()</code> function, except that the changes only last for the duration of the function call. For example:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, y, <span class="at">pch=</span><span class="st">"+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces a scatterplot using a plus sign as the plotting character, without changing the default plotting character for future plots.</p>
<p>Unfortunately, this is not implemented entirely consistently and it is sometimes necessary to set and reset graphics parameters using <code>par()</code>.</p>
</section>
</section>
<section id="sec-graphics-parameters-list" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="sec-graphics-parameters-list"><span class="header-section-number">12.5</span> Graphics parameters list</h2>
<p>The following sections detail many of the commonly-used graphical parameters. The R help documentation for the <code>par()</code> function provides a more concise summary; this is provided as a somewhat more detailed alternative.</p>
<p>Graphics parameters will be presented in the following form:</p>
<dl>
<dt><var>name</var><var>=``value</var></dt>
<dd>
<p>A description of the parameter’s effect. <var>name</var> is the name of the parameter, that is, the argument name to use in calls to <code>par()</code> or a graphics function. <var>value</var> is a typical value you might use when setting the parameter.</p>
</dd>
</dl>
<p>Note that <code>axes</code> is <strong>not</strong> a graphics parameter but an argument to a few <code>plot</code> methods: see <code>xaxt</code> and <code>yaxt</code>.</p>
<section id="sec-graphical-elements" class="level3">
<h3 class="anchored" data-anchor-id="sec-graphical-elements">Graphical elements</h3>
<p>R plots are made up of points, lines, text and polygons (filled regions.) Graphical parameters exist which control how these <em>graphical elements</em> are drawn, as follows:</p>
<dl>
<dt><code>pch="+"</code></dt>
<dd>
<p>Character to be used for plotting points. The default varies with graphics drivers, but it is usually a circle. Plotted points tend to appear slightly above or below the appropriate position unless you use <code>"."</code> as the plotting character, which produces centered points.</p>
</dd>
<dt><code>pch=4</code></dt>
<dd>
<p>When <code>pch</code> is given as an integer between 0 and 25 inclusive, a specialized plotting symbol is produced. To see what the symbols are, use the command</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a><span class="sc">&gt;</span> <span class="fu">legend</span>(<span class="fu">locator</span>(<span class="dv">1</span>), <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">pch =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Those from 21 to 25 may appear to duplicate earlier symbols, but can be coloured in different ways: see the help on <code>points</code> and its examples.</p>
<p>In addition, <code>pch</code> can be a character or a number in the range <code>32:255</code> representing a character in the current font.</p>
</dd>
<dt><code>lty=2</code></dt>
<dd>
<p>Line types. Alternative line styles are not supported on all graphics devices (and vary on those that do) but line type 1 is always a solid line, line type 0 is always invisible, and line types 2 and onwards are dotted or dashed lines, or some combination of both.</p>
</dd>
<dt><code>lwd=2</code></dt>
<dd>
<p>Line widths. Desired width of lines, in multiples of the “standard” line width. Affects axis lines as well as lines drawn with <code>lines()</code>, etc. Not all devices support this, and some have restrictions on the widths that can be used.</p>
</dd>
<dt><code>col=2</code></dt>
<dd>
<p>Colors to be used for points, lines, text, filled regions and images. A number from the current palette (see <code>?palette</code>) or a named colour.</p>
</dd>
</dl>
<p><code>col.axis</code><br>
<code>col.lab</code><br>
<code>col.main</code><br>
<code>col.sub</code></p>
<p>: The color to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
<dl>
<dt><code>font=2</code></dt>
<dd>
<p>An integer which specifies which font to use for text. If possible, device drivers arrange so that <code>1</code> corresponds to plain text, <code>2</code> to bold face, <code>3</code> to italic, <code>4</code> to bold italic and <code>5</code> to a symbol font (which include Greek letters).</p>
</dd>
</dl>
<p><code>font.axis</code><br>
<code>font.lab</code><br>
<code>font.main</code><br>
<code>font.sub</code></p>
<p>: The font to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
<dl>
<dt><code>adj=-0.1</code></dt>
<dd>
<p>Justification of text relative to the plotting position. <code>0</code> means left justify, <code>1</code> means right justify and <code>0.5</code> means to center horizontally about the plotting position. The actual value is the proportion of text that appears to the left of the plotting position, so a value of <code>-0.1</code> leaves a gap of 10% of the text width between the text and the plotting position.</p>
</dd>
<dt><code>cex=1.5</code></dt>
<dd>
<p>Character expansion. The value is the desired size of text characters (including plotting characters) relative to the default text size.</p>
</dd>
</dl>
<p><code>cex.axis</code><br>
<code>cex.lab</code><br>
<code>cex.main</code><br>
<code>cex.sub</code></p>
<p>: The character expansion to be used for axis annotation, <em>x</em> and <em>y</em> labels, main and sub-titles, respectively.</p>
</section>
<section id="sec-axes-and-tick-marks" class="level3">
<h3 class="anchored" data-anchor-id="sec-axes-and-tick-marks">Axes and tick marks</h3>
<p>Many of R’s high-level plots have axes, and you can construct axes yourself with the low-level <code>axis()</code> graphics function. Axes have three main components: the <em>axis line</em> (line style controlled by the <code>lty</code> graphics parameter), the <em>tick marks</em> (which mark off unit divisions along the axis line) and the <em>tick labels</em> (which mark the units.) These components can be customized with the following graphics parameters.</p>
<dl>
<dt><code>lab=c(5, 7, 12)</code></dt>
<dd>
<p>The first two numbers are the desired number of tick intervals on the <em>x</em> and <em>y</em> axes respectively. The third number is the desired length of axis labels, in characters (including the decimal point.) Choosing a too-small value for this parameter may result in all tick labels being rounded to the same number!</p>
</dd>
<dt><code>las=1</code></dt>
<dd>
<p>Orientation of axis labels. <code>0</code> means always parallel to axis, <code>1</code> means always horizontal, and <code>2</code> means always perpendicular to the axis.</p>
</dd>
<dt><code>mgp=c(3, 1, 0)</code></dt>
<dd>
<p>Positions of axis components. The first component is the distance from the axis label to the axis position, in text lines. The second component is the distance to the tick labels, and the final component is the distance from the axis position to the axis line (usually zero). Positive numbers measure outside the plot region, negative numbers inside.</p>
</dd>
<dt><code>tck=0.01</code></dt>
<dd>
<p>Length of tick marks, as a fraction of the size of the plotting region. When <code>tck</code> is small (less than 0.5) the tick marks on the <em>x</em> and <em>y</em> axes are forced to be the same size. A value of 1 gives grid lines. Negative values give tick marks outside the plotting region. Use <code>tck=0.01</code> and <code>mgp=c(1,-1.5,0)</code> for internal tick marks.</p>
</dd>
</dl>
<p><code>xaxs="r"</code><br>
<code>yaxs="i"</code></p>
<p>: Axis styles for the <em>x</em> and <em>y</em> axes, respectively. With styles <code>"i"</code> (internal) and <code>"r"</code> (the default) tick marks always fall within the range of the data, however style <code>"r"</code> leaves a small amount of space at the edges.</p>
</section>
<section id="sec-figure-margins" class="level3">
<h3 class="anchored" data-anchor-id="sec-figure-margins">Figure margins</h3>
<p>A single plot in R is known as a <code>figure</code> and comprises a <em>plot region</em> surrounded by margins (possibly containing axis labels, titles, etc.) and (usually) bounded by the axes themselves.</p>
<p>A typical figure is</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig11.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/fig11</figcaption>
</figure>
</div>
<p>Graphics parameters controlling figure layout include:</p>
<dl>
<dt><code>mai=c(1, 0.5, 0.5, 0)</code></dt>
<dd>
<p>Widths of the bottom, left, top and right margins, respectively, measured in inches.</p>
</dd>
<dt><code>mar=c(4, 2, 2, 1)</code></dt>
<dd>
<p>Similar to <code>mai</code>, except the measurement unit is text lines.</p>
</dd>
</dl>
<p><code>mar</code> and <code>mai</code> are equivalent in the sense that setting one changes the value of the other. The default values chosen for this parameter are often too large; the right-hand margin is rarely needed, and neither is the top margin if no title is being used. The bottom and left margins must be large enough to accommodate the axis and tick labels. Furthermore, the default is chosen without regard to the size of the device surface: for example, using the <code>postscript()</code> driver with the <code>height=4</code> argument will result in a plot which is about 50% margin unless <code>mar</code> or <code>mai</code> are set explicitly. When multiple figures are in use (see below) the margins are reduced, however this may not be enough when many figures share the same page.</p>
</section>
<section id="sec-multiple-figure-environment" class="level3">
<h3 class="anchored" data-anchor-id="sec-multiple-figure-environment">Multiple figure environment</h3>
<p>R allows you to create an <em>n</em> by <em>m</em> array of figures on a single page. Each figure has its own margins, and the array of figures is optionally surrounded by an <em>outer margin</em>, as shown in the following figure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig12.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">images/fig12</figcaption>
</figure>
</div>
<p>The graphical parameters relating to multiple figures are as follows:</p>
<p><code>mfcol=c(3, 2)</code><br>
<code>mfrow=c(2, 4)</code></p>
<p>: Set the size of a multiple figure array. The first value is the number of rows; the second is the number of columns. The only difference between these two parameters is that setting <code>mfcol</code> causes figures to be filled by column; <code>mfrow</code> fills by rows.</p>
<pre><code>The layout in the Figure could have been created by setting
`mfrow=c(3,2)`; the figure shows the page after four plots have been
drawn.

Setting either of these can reduce the base size of symbols and text
(controlled by `par("cex")` and the pointsize of the device). In a
layout with exactly two rows and columns the base size is reduced by
a factor of 0.83: if there are three or more of either rows or
columns, the reduction factor is 0.66.</code></pre>
<dl>
<dt><code>mfg=c(2, 2, 3, 2)</code></dt>
<dd>
<p>Position of the current figure in a multiple figure environment. The first two numbers are the row and column of the current figure; the last two are the number of rows and columns in the multiple figure array. Set this parameter to jump between figures in the array. You can even use different values for the last two numbers than the <em>true</em> values for unequally-sized figures on the same page.</p>
</dd>
<dt><code>fig=c(4, 9, 1, 4)/10</code></dt>
<dd>
<p>Position of the current figure on the page. Values are the positions of the left, right, bottom and top edges respectively, as a percentage of the page measured from the bottom left corner. The example value would be for a figure in the bottom right of the page. Set this parameter for arbitrary positioning of figures within a page. If you want to add a figure to a current page, use <code>new=TRUE</code> as well (unlike S).</p>
</dd>
</dl>
<p><code>oma=c(2, 0, 3, 0)</code><br>
<code>omi=c(0, 0, 0.8, 0)</code></p>
<p>: Size of outer margins. Like <code>mar</code> and <code>mai</code>, the first measures in text lines and the second in inches, starting with the bottom margin and working clockwise.</p>
<p>Outer margins are particularly useful for page-wise titles, etc. Text can be added to the outer margins with the <code>mtext()</code> function with argument <code>outer=TRUE</code>. There are no outer margins by default, however, so you must create them explicitly using <code>oma</code> or <code>omi</code>.</p>
<p>More complicated arrangements of multiple figures can be produced by the <code>split.screen()</code> and <code>layout()</code> functions, as well as by the <strong>grid</strong> and <a href="https://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a> packages.</p>
</section>
</section>
<section id="sec-device-drivers" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="sec-device-drivers"><span class="header-section-number">12.6</span> Device drivers</h2>
<p>R can generate graphics (of varying levels of quality) on almost any type of display or printing device. Before this can begin, however, R needs to be informed what type of device it is dealing with. This is done by starting a <em>device driver</em>. The purpose of a device driver is to convert graphical instructions from R (“draw a line,” for example) into a form that the particular device can understand.</p>
<p>Device drivers are started by calling a device driver function. There is one such function for every device driver: type <code>help(Devices)</code> for a list of them all. For example, issuing the command</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a><span class="sc">&gt;</span> <span class="fu">postscript</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>causes all future graphics output to be sent to the printer in PostScript format. Some commonly-used device drivers are:</p>
<dl>
<dt><code>X11()</code></dt>
<dd>
<p><span id="index-X11"></span></p>
<p>For use with the X11 window system on Unix-alikes</p>
</dd>
<dt><code>windows()</code></dt>
<dd>
<p><span id="index-windows"></span></p>
<p>For use on Windows</p>
</dd>
<dt><code>quartz()</code></dt>
<dd>
<p><span id="index-quartz"></span></p>
<p>For use on macOS</p>
</dd>
<dt><code>postscript()</code></dt>
<dd>
<p><span id="index-postscript"></span></p>
<p>For printing on PostScript printers, or creating PostScript graphics files.</p>
</dd>
<dt><code>pdf()</code></dt>
<dd>
<p><span id="index-pdf"></span></p>
<p>Produces a PDF file, which can also be included into PDF files.</p>
</dd>
<dt><code>png()</code></dt>
<dd>
<p><span id="index-png"></span></p>
<p>Produces a bitmap PNG file. (Not always available: see its help page.)</p>
</dd>
<dt><code>jpeg()</code></dt>
<dd>
<p><span id="index-jpeg"></span></p>
<p>Produces a bitmap JPEG file, best used for <code>image</code> plots. (Not always available: see its help page.)</p>
</dd>
</dl>
<p>When you have finished with a device, be sure to terminate the device driver by issuing the command</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1"></a><span class="sc">&gt;</span> <span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This ensures that the device finishes cleanly; for example in the case of hardcopy devices this ensures that every page is completed and has been sent to the printer. (This will happen automatically at the normal end of a session.)</p>
<section id="sec-postscript-diagrams-for-typeset-documents" class="level3">
<h3 class="anchored" data-anchor-id="sec-postscript-diagrams-for-typeset-documents">PostScript diagrams for typeset documents</h3>
<p>By passing the <code>file</code> argument to the <code>postscript()</code> device driver function, you may store the graphics in PostScript format in a file of your choice. The plot will be in landscape orientation unless the <code>horizontal=FALSE</code> argument is given, and you can control the size of the graphic with the <code>width</code> and <code>height</code> arguments (the plot will be scaled as appropriate to fit these dimensions.) For example, the command</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb243-1"><a href="#cb243-1"></a><span class="op">&gt;</span> postscript<span class="op">(</span><span class="st">"file.ps"</span><span class="op">,</span> horizontal<span class="op">=</span>FALSE<span class="op">,</span> height<span class="op">=</span><span class="dv">5</span><span class="op">,</span> pointsize<span class="op">=</span><span class="dv">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will produce a file containing PostScript code for a figure five inches high, perhaps for inclusion in a document. It is important to note that if the file named in the command already exists, it will be overwritten. This is the case even if the file was only created earlier in the same R session.</p>
<p>Many usages of PostScript output will be to incorporate the figure in another document. This works best when <em>encapsulated</em> PostScript is produced: R always produces conformant output, but only marks the output as such when the <code>onefile=FALSE</code> argument is supplied. This unusual notation stems from S-compatibility: it really means that the output will be a single page (which is part of the EPSF specification). Thus to produce a plot for inclusion use something like</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb244-1"><a href="#cb244-1"></a><span class="op">&gt;</span> postscript<span class="op">(</span><span class="st">"plot1.eps"</span><span class="op">,</span> horizontal<span class="op">=</span>FALSE<span class="op">,</span> onefile<span class="op">=</span>FALSE<span class="op">,</span></span>
<span id="cb244-2"><a href="#cb244-2"></a>             height<span class="op">=</span><span class="dv">8</span><span class="op">,</span> width<span class="op">=</span><span class="dv">6</span><span class="op">,</span> pointsize<span class="op">=</span><span class="dv">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-multiple-graphics-devices" class="level3">
<h3 class="anchored" data-anchor-id="sec-multiple-graphics-devices">Multiple graphics devices</h3>
<p>In advanced use of R it is often useful to have several graphics devices in use at the same time. Of course only one graphics device can accept graphics commands at any one time, and this is known as the <em>current device</em>. When multiple devices are open, they form a numbered sequence with names giving the kind of device at any position.</p>
<p>The main commands used for operating with multiple devices, and their meanings are as follows:</p>
<dl>
<dt><code>X11()</code></dt>
<dd>
<p>[UNIX]</p>
</dd>
</dl>
<p><code>windows()</code><br>
<code>win.printer()</code><br>
<code>win.metafile()</code></p>
<p>: [Windows]</p>
<dl>
<dt><code>quartz()</code></dt>
<dd>
<p>[macOS]</p>
</dd>
</dl>
<p><code>postscript()</code><br>
<code>pdf()</code><br>
<code>png()</code><br>
<code>jpeg()</code><br>
<code>tiff()</code><br>
<code>bitmap()</code><br>
<code>…</code></p>
<p>: Each new call to a device driver function opens a new graphics device, thus extending by one the device list. This device becomes the current device, to which graphics output will be sent.</p>
<dl>
<dt><code>dev.list()</code></dt>
<dd>
<p><span id="index-dev_002elist"></span></p>
<p>Returns the number and name of all active devices. The device at position 1 on the list is always the <em>null device</em> which does not accept graphics commands at all.</p>
</dd>
</dl>
<p><code>dev.next()</code><br>
<code>dev.prev()</code></p>
<p>: <span id="index-dev_002enext"></span></p>
<pre><code>Returns the number and name of the graphics device next to, or
previous to the current device, respectively.</code></pre>
<dl>
<dt><var>dev.set(which=``k</var><code>)</code></dt>
<dd>
<p><span id="index-dev_002eset"></span></p>
<p>Can be used to change the current graphics device to the one at position <var>k</var> of the device list. Returns the number and label of the device.</p>
</dd>
<dt><var>dev.off(``k</var><code>)</code></dt>
<dd>
<p><span id="index-dev_002eoff"></span></p>
<p>Terminate the graphics device at point <var>k</var> of the device list. For some devices, such as <code>postscript</code> devices, this will either print the file immediately or correctly complete the file for later printing, depending on how the device was initiated.</p>
</dd>
</dl>
<p><var>dev.copy(device, …, which=``k</var><code>)</code><br>
<var>dev.print(device, …, which=``k</var><code>)</code></p>
<p>: Make a copy of the device <var>k</var>. Here <code>device</code> is a device function, such as <code>postscript</code>, with extra arguments, if needed, specified by ‘<code>…</code>’. <code>dev.print</code> is similar, but the copied device is immediately closed, so that end actions, such as printing hardcopies, are immediately performed.</p>
<dl>
<dt><code>graphics.off()</code></dt>
<dd>
<p>Terminate all graphics devices on the list, except the null device.</p>
</dd>
</dl>
</section>
</section>
<section id="sec-dynamic-graphics" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="sec-dynamic-graphics"><span class="header-section-number">12.7</span> Dynamic graphics</h2>
<p>R does not have builtin capabilities for dynamic or interactive graphics, e.g.&nbsp;rotating point clouds or to “brushing” (interactively highlighting) points. However, extensive dynamic graphics facilities are available in the system GGobi by Swayne, Cook and Buja available from</p>
<blockquote class="blockquote">
<p><a href="http://ggobi.org/" class="uri">http://ggobi.org/</a></p>
</blockquote>
<p>and these can be accessed from R via the package <a href="https://CRAN.R-project.org/package=rggobi"><strong>rggobi</strong></a>, described at <a href="http://ggobi.org/rggobi.html" class="uri">http://ggobi.org/rggobi.html</a>.</p>
<p>Also, package <a href="https://CRAN.R-project.org/package=rgl"><strong>rgl</strong></a> provides ways to interact with 3D plots, for example of surfaces.</p>
</section>
</section>
<section id="sec-packages" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Packages</h1>
<p>All R functions and datasets are stored in <em>packages</em>. Only when a package is loaded are its contents available. This is done both for efficiency (the full list would take more memory and would take longer to search than a subset), and to aid package developers, who are protected from name clashes with other code. The process of developing packages is described in <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Creating-R-packages">Creating R packages</a> in Writing R Extensions. Here, we will describe them from a user’s point of view.</p>
<p>To see which packages are installed at your site, issue the command</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>with no arguments. To load a particular package (e.g., the <a href="https://CRAN.R-project.org/package=boot"><strong>boot</strong></a> package containing functions from Davison &amp; Hinkley (1997)), use a command like</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Users connected to the Internet can use the <code>install.packages()</code> and <code>update.packages()</code> functions (available through the <code>Packages</code> menu in the Windows and macOS GUIs, see <a href="https://cran.r-project.org/doc/manuals/R-admin.html#Installing-packages">Installing packages</a> in R Installation and Administration) to install and update packages.</p>
<p>To see which packages are currently loaded, use</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1"></a><span class="sc">&gt;</span> <span class="fu">search</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to display the search list. Some packages may be loaded but not available on the search list (see <a href="Namespaces.html">Namespaces</a>): these will be included in the list given by</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a><span class="sc">&gt;</span> <span class="fu">loadedNamespaces</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To see a list of all available help topics in an installed package, use</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1"></a><span class="sc">&gt;</span> <span class="fu">help.start</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to start the HTML help system, and then navigate to the package listing in the <code>Reference</code> section.</p>
<section id="sec-standard-packages" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sec-standard-packages"><span class="header-section-number">13.1</span> Standard packages</h2>
<p>The standard (or <em>base</em>) packages are considered part of the R source code. They contain the basic functions that allow R to work, and the datasets and standard statistical and graphical functions that are described in this manual. They should be automatically available in any R installation. See <a href="../R-FAQ/Which-add-on-packages-exist-for-R_003f.html#which-add-on-packages-exist-for-r_003f">R packages</a> in R FAQ, for a complete list.</p>
</section>
<section id="sec-contributed-packages-and-cran" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sec-contributed-packages-and-cran"><span class="header-section-number">13.2</span> Contributed packages and CRAN</h2>
<p>There are thousands of contributed packages for R, written by many different authors. Some of these packages implement specialized statistical methods, others give access to data or hardware, and others are designed to complement textbooks. Some (the <em>recommended</em> packages) are distributed with every binary distribution of R. Most are available for download from CRAN (<a href="https://CRAN.R-project.org/" class="uri">https://CRAN.R-project.org/</a> and its mirrors) and other repositories such as Bioconductor (<a href="https://www.bioconductor.org/" class="uri">https://www.bioconductor.org/</a>). The <em>R FAQ</em> contains a list of CRAN packages current at the time of release, but the collection of available packages changes very frequently.</p>
</section>
<section id="sec-namespaces" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="sec-namespaces"><span class="header-section-number">13.3</span> Namespaces</h2>
<p>Packages have <em>namespaces</em>, which do three things: they allow the package writer to hide functions and data that are meant only for internal use, they prevent functions from breaking when a user (or other package writer) picks a name that clashes with one in the package, and they provide a way to refer to an object within a particular package.</p>
<p>For example, <code>t()</code> is the transpose function in R, but users might define their own function named <code>t</code>. Namespaces prevent the user’s definition from taking precedence, and breaking every function that tries to transpose a matrix.</p>
<p>There are two operators that work with namespaces. The double-colon operator <code>::</code> selects definitions from a particular namespace. In the example above, the transpose function will always be available as <code>base::t</code>, because it is defined in the <code>base</code> package. Only functions that are exported from the package can be retrieved in this way.</p>
<p>The triple-colon operator <code>:::</code> may be seen in a few places in R code: it acts like the double-colon operator but also allows access to hidden objects. Users are more likely to use the <code>getAnywhere()</code> function, which searches multiple packages.</p>
<p>Packages are often inter-dependent, and loading one may cause others to be automatically loaded. The colon operators described above will also cause automatic loading of the associated package. When packages with namespaces are loaded automatically they are not added to the search list.</p>
</section>
</section>
<section id="sec-os-facilities" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> OS facilities</h1>
<p>R has quite extensive facilities to access the OS under which it is running: this allows it to be used as a scripting language and that ability is much used by R itself, for example to install packages.</p>
<p>Because R’s own scripts need to work across all platforms, considerable effort has gone into make the scripting facilities as platform-independent as is feasible.</p>
<section id="sec-files-and-directories" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sec-files-and-directories"><span class="header-section-number">14.1</span> Files and directories</h2>
<p>There are many functions to manipulate files and directories. Here are pointers to some of the more commonly used ones.</p>
<p>To create an (empty) file or directory, use <code>file.create</code> or <code>dir.create</code>. (These are the analogues of the POSIX utilities <code>touch</code> and <code>mkdir</code>.) For temporary files and directories in the R session directory see <code>tempfile</code>.</p>
<p>Files can be removed by either <code>file.remove</code> or <code>unlink</code>: the latter can remove directory trees.</p>
<p>For directory listings use <code>list.files</code> (also available as <code>dir</code>) or <code>list.dirs</code>. These can select files using a regular expression: to select by wildcards use <code>Sys.glob</code>.</p>
<p>Many types of information on a filepath (including for example if it is a file or directory) can be found by <code>file.info</code>.</p>
<p>There are several ways to find out if a file ‘exists’ (a file can exist on the filesystem and not be visible to the current user). There are functions <code>file.exists</code>, <code>file.access</code> and <code>file_test</code> with various versions of this test: <code>file_test</code> is a version of the POSIX <code>test</code> command for those familiar with shell scripting.</p>
<p>Function <code>file.copy</code> is the R analogue of the POSIX command <code>cp</code>.</p>
<p>Choosing files can be done interactively by <code>file.choose</code>: the Windows port has the more versatile functions <code>choose.files</code> and <code>choose.dir</code> and there are similar functions in the <strong>tcltk</strong> package: <code>tk_choose.files</code> and <code>tk_choose.dir</code>.</p>
<p>Functions <code>file.show</code> and <code>file.edit</code> will display and edit one or more files in a way appropriate to the R port, using the facilities of a console (such as RGui on Windows or R.app on macOS) if one is in use.</p>
<p>There is some support for <em>links</em> in the filesystem: see functions <code>file.link</code> and <code>Sys.readlink</code>.</p>
</section>
<section id="sec-filepaths" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sec-filepaths"><span class="header-section-number">14.2</span> Filepaths</h2>
<p>With a few exceptions, R relies on the underlying OS functions to manipulate filepaths. Some aspects of this are allowed to depend on the OS, and do, even down to the version of the OS. There are POSIX standards for how OSes should interpret filepaths and many R users assume POSIX compliance: but Windows does not claim to be compliant and other OSes may be less than completely compliant.</p>
<p>The following are some issues which have been encountered with filepaths.</p>
<ul>
<li>POSIX filesystems are case-sensitive, so <code>foo.png</code> and <code>Foo.PNG</code> are different files. However, the defaults on Windows and macOS are to be case-insensitive, and FAT filesystems (commonly used on removable storage) are not normally case-sensitive (and all filepaths may be mapped to lower case).</li>
<li>Almost all the Windows’ OS services support the use of slash or backslash as the filepath separator, and R converts the known exceptions to the form required by Windows.</li>
<li>The behaviour of filepaths with a trailing slash is OS-dependent. Such paths are not valid on Windows and should not be expected to work. POSIX-2008 requires such paths to match only directories, but earlier versions allowed them to also match files. So they are best avoided.</li>
<li>Multiple slashes in filepaths such as <code>/abc//def</code> are valid on POSIX filesystems and treated as if there was only one slash. They are <em>usually</em> accepted by Windows’ OS functions. However, leading double slashes may have a different meaning.</li>
<li>Windows’ UNC filepaths (such as <code>\\server\dir1\dir2\file</code> and <code>\\?\UNC\server\dir1\dir2\file</code>) are not supported, but they may work in some R functions. POSIX filesystems are allowed to treat a leading double slash specially.</li>
<li>Windows allows filepaths containing drives and relative to the current directory on a drive, e.g.&nbsp;<code>d:foo/bar</code> refers to <code>d:/a/b/c/foo/bar</code> if the current directory <em>on drive <code>d:</code></em> is <code>/a/b/c</code>. It is intended that these work, but the use of absolute paths is safer.</li>
</ul>
<p>Functions <code>basename</code> and <code>dirname</code> select parts of a file path: the recommended way to assemble a file path from components is <code>file.path</code>. Function <code>pathexpand</code> does ‘tilde expansion’, substituting values for home directories (the current user’s, and perhaps those of other users).</p>
<p>On filesystems with links, a single file can be referred to by many filepaths. Function <code>normalizePath</code> will find a canonical filepath.</p>
<p>Windows has the concepts of short (‘8.3’) and long file names: <code>normalizePath</code> will return an absolute path using long file names and <code>shortPathName</code> will return a version using short names. The latter does not contain spaces and uses backslash as the separator, so is sometimes useful for exporting names from R.</p>
<p>File <em>permissions</em> are a related topic. R has support for the POSIX concepts of read/write/execute permission for owner/group/all but this may be only partially supported on the filesystem, so for example on Windows only read-only files (for the account running the R session) are recognized. Access Control Lists (ACLs) are employed on several filesystems, but do not have an agreed standard and R has no facilities to control them. Use <code>Sys.chmod</code> to change permissions.</p>
</section>
<section id="sec-system-commands" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="sec-system-commands"><span class="header-section-number">14.3</span> System commands</h2>
<p>Functions <code>system</code> and <code>system2</code> are used to invoke a system command and optionally collect its output. <code>system2</code> is a little more general but its main advantage is that it is easier to write cross-platform code using it.</p>
<p><code>system</code> behaves differently on Windows from other OSes (because the API C call of that name does). Elsewhere it invokes a shell to run the command: the Windows port of R has a function <code>shell</code> to do that.</p>
<p>To find out if the OS includes a command, use <code>Sys.which</code>, which attempts to do this in a cross-platform way (unfortunately it is not a standard OS service).</p>
<p>Function <code>shQuote</code> will quote filepaths as needed for commands in the current OS.</p>
</section>
<section id="sec-compression-and-archives" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="sec-compression-and-archives"><span class="header-section-number">14.4</span> Compression and Archives</h2>
<p>Recent versions of R have extensive facilities to read and write compressed files, often transparently. Reading of files in R is to a very large extent done by <em>connections</em>, and the <code>file</code> function which is used to open a connection to a file (or a URL) and is able to identify the compression used from the ‘magic’ header of the file.</p>
<p>The type of compression which has been supported for longest is <code>gzip</code> compression, and that remains a good general compromise. Files compressed by the earlier Unix <code>compress</code> utility can also be read, but these are becoming rare. Two other forms of compression, those of the <code>bzip2</code> and <code>xz</code> utilities are also available. These generally achieve higher rates of compression (depending on the file, much higher) at the expense of slower decompression and much slower compression.</p>
<p>There is some confusion between <code>xz</code> and <code>lzma</code> compression (see <a href="https://en.wikipedia.org/wiki/Xz" class="uri">https://en.wikipedia.org/wiki/Xz</a> and <a href="https://en.wikipedia.org/wiki/LZMA" class="uri">https://en.wikipedia.org/wiki/LZMA</a>): R can read files compressed by most versions of either.</p>
<p>File archives are single files which contain a collection of files, the most common ones being ‘tarballs’ and zip files as used to distribute R packages. R can list and unpack both (see functions <code>untar</code> and <code>unzip</code>) and create both (for <code>zip</code> with the help of an external program).</p>
</section>
<section id="sec-b.1-invoking-r-from-the-command-line" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="sec-b.1-invoking-r-from-the-command-line"><span class="header-section-number">14.5</span> B.1 Invoking R from the command line</h2>
<p>When working at a command line on UNIX or Windows, the command ‘<code>R</code>’ can be used both for starting the main R program in the form</p>
<div class="display">
<div class="sourceCode" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a>R [options] [<span class="sc">&lt;</span>infile] [<span class="sc">&gt;</span>outfile],</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or, via the <code>R CMD</code> interface, as a wrapper to various R tools (e.g., for processing files in R documentation format or manipulating add-on packages) which are not intended to be called “directly”.</p>
<p>At the Windows command-line, <code>Rterm.exe</code> is preferred to <code>R</code>.</p>
<p>You need to ensure that either the environment variable <code>TMPDIR</code> is unset or it points to a valid place to create temporary files and directories.</p>
<p>Most options control what happens at the beginning and at the end of an R session. The startup mechanism is as follows (see also the on-line help for topic ‘<code>Startup</code>’ for more information, and the section below for some Windows-specific details).</p>
<ul>
<li>Unless <code>--no-environ</code> was given, R searches for user and site files to process for setting environment variables. The name of the site file is the one pointed to by the environment variable <code>R_ENVIRON</code>; if this is unset, <var>R_HOME</var><code>/etc/Renviron.site</code> is used (if it exists). The user file is the one pointed to by the environment variable <code>R_ENVIRON_USER</code> if this is set; otherwise, files <code>.Renviron</code> in the current or in the user’s home directory (in that order) are searched for. These files should contain lines of the form ‘<var>name</var><var>=``value</var>’. (See <code>help("Startup")</code> for a precise description.) Variables you might want to set include <code>R_PAPERSIZE</code> (the default paper size), <code>R_PRINTCMD</code> (the default print command) and <code>R_LIBS</code> (specifies the list of R library trees searched for add-on packages).</li>
<li>Then R searches for the site-wide startup profile unless the command line option <code>--no-site-file</code> was given. The name of this file is taken from the value of the <code>R_PROFILE</code> environment variable. If that variable is unset, the default <var>R_HOME</var><code>/etc/Rprofile.site</code> is used if this exists.</li>
<li>Then, unless <code>--no-init-file</code> was given, R searches for a user profile and sources it. The name of this file is taken from the environment variable <code>R_PROFILE_USER</code>; if unset, a file called <code>.Rprofile</code> in the current directory or in the user’s home directory (in that order) is searched for.</li>
<li>It also loads a saved workspace from file <code>.RData</code> in the current directory if there is one (unless <code>--no-restore</code> or <code>--no-restore-data</code> was specified).</li>
<li>Finally, if a function <code>.First()</code> exists, it is executed. This function (as well as <code>.Last()</code> which is executed at the end of the R session) can be defined in the appropriate startup profiles, or reside in <code>.RData</code>.</li>
</ul>
<p>In addition, there are options for controlling the memory available to the R process (see the on-line help for topic ‘<code>Memory</code>’ for more information). Users will not normally need to use these unless they are trying to limit the amount of memory used by R.</p>
<p>R accepts the following command-line options.</p>
<p><code>--help</code><br>
<code>-h</code></p>
<p>: Print short help message to standard output and exit successfully.</p>
<dl>
<dt><code>--version</code></dt>
<dd>
<p>Print version information to standard output and exit successfully.</p>
</dd>
<dt><var>--encoding=``enc</var></dt>
<dd>
<p>Specify the encoding to be assumed for input from the console or <code>stdin</code>. This needs to be an encoding known to <code>iconv</code>: see its help page. (<var>--encoding ``enc</var> is also accepted.) The input is re-encoded to the locale R is running in and needs to be representable in the latter’s encoding (so e.g.&nbsp;you cannot re-encode Greek text in a French locale unless that locale uses the UTF-8 encoding).</p>
</dd>
<dt><code>RHOME</code></dt>
<dd>
<p>Print the path to the R “home directory” to standard output and exit successfully. Apart from the front-end shell script and the man page, R installation puts everything (executables, packages, etc.) into this directory.</p>
</dd>
</dl>
<p><code>--save</code><br>
<code>--no-save</code></p>
<p>: Control whether data sets should be saved or not at the end of the R session. If neither is given in an interactive session, the user is asked for the desired behavior when ending the session with <kbd>q()</kbd>; in non-interactive use one of these must be specified or implied by some other option (see below).</p>
<dl>
<dt><code>--no-environ</code></dt>
<dd>
<p>Do not read any user file to set environment variables.</p>
</dd>
<dt><code>--no-site-file</code></dt>
<dd>
<p>Do not read the site-wide profile at startup.</p>
</dd>
<dt><code>--no-init-file</code></dt>
<dd>
<p>Do not read the user’s profile at startup.</p>
</dd>
</dl>
<p><code>--restore</code><br>
<code>--no-restore</code><br>
<code>--no-restore-data</code></p>
<p>: Control whether saved images (file <code>.RData</code> in the directory where R was started) should be restored at startup or not. The default is to restore. (<code>--no-restore</code> implies all the specific <code>--no-restore-*</code> options.)</p>
<dl>
<dt><code>--no-restore-history</code></dt>
<dd>
<p>Control whether the history file (normally file <code>.Rhistory</code> in the directory where R was started, but can be set by the environment variable <code>R_HISTFILE</code>) should be restored at startup or not. The default is to restore.</p>
</dd>
<dt><code>--no-Rconsole</code></dt>
<dd>
<p>(Windows only) Prevent loading the <code>Rconsole</code> file at startup.</p>
</dd>
<dt><code>--vanilla</code></dt>
<dd>
<p>Combine <code>--no-save</code>, <code>--no-environ</code>, <code>--no-site-file</code>, <code>--no-init-file</code> and <code>--no-restore</code>. Under Windows, this also includes <code>--no-Rconsole</code>.</p>
</dd>
</dl>
<p><var>-f ``file</var><br>
<var>--file=``file</var></p>
<p>: (not <code>Rgui.exe</code>) Take input from <var>file</var>: ‘<code>-</code>’ means <code>stdin</code>. Implies <code>--no-save</code> unless <code>--save</code> has been set. On a Unix-alike, shell metacharacters should be avoided in <var>file</var> (but spaces are allowed).</p>
<dl>
<dt><var>-e ``expression</var></dt>
<dd>
<p>(not <code>Rgui.exe</code>) Use <var>expression</var> as an input line. One or more <code>-e</code> options can be used, but not together with <code>-f</code> or <code>--file</code>. Implies <code>--no-save</code> unless <code>--save</code> has been set. (There is a limit of 10,000 bytes on the total length of expressions used in this way. Expressions containing spaces or shell metacharacters will need to be quoted.)</p>
</dd>
<dt><code>--no-readline</code></dt>
<dd>
<p>(UNIX only) Turn off command-line editing via <strong>readline</strong>. This is useful when running R from within Emacs using the ESS (“Emacs Speaks Statistics”) package. See <a href="#sec-appendix-c-the-command-line-editor">Section&nbsp;17</a> , for more information. Command-line editing is enabled for default interactive use (see <code>--interactive</code>). This option also affects tilde-expansion: see the help for <code>path.expand</code>.</p>
</dd>
</dl>
<p><var>--min-vsize=``N</var><br>
<var>--min-nsize=``N</var></p>
<p>: For expert use only: set the initial trigger sizes for garbage collection of vector heap (in bytes) and <em>cons cells</em> (number) respectively. Suffix ‘<code>M</code>’ specifies megabytes or millions of cells respectively. The defaults are 6Mb and 350k respectively and can also be set by environment variables <code>R_NSIZE</code> and <code>R_VSIZE</code>.</p>
<dl>
<dt><var>--max-ppsize=``N</var></dt>
<dd>
<p>Specify the maximum size of the pointer protection stack as <var>N</var> locations. This defaults to 10000, but can be increased to allow large and complicated calculations to be done. Currently the maximum value accepted is 100000.</p>
</dd>
</dl>
<p><code>--quiet</code><br>
<code>--silent</code><br>
<code>-q</code></p>
<p>: Do not print out the initial copyright and welcome messages.</p>
<dl>
<dt><code>--no-echo</code></dt>
<dd>
<p>Make R run as quietly as possible. This option is intended to support programs which use R to compute results for them. It implies <code>--quiet</code> and <code>--no-save</code>.</p>
</dd>
<dt><code>--interactive</code></dt>
<dd>
<p>(UNIX only) Assert that R really is being run interactively even if input has been redirected: use if input is from a FIFO or pipe and fed from an interactive program. (The default is to deduce that R is being run interactively if and only if <code>stdin</code> is connected to a terminal or <code>pty</code>.) Using <code>-e</code>, <code>-f</code> or <code>--file</code> asserts non-interactive use even if <code>--interactive</code> is given.</p>
<p>Note that this does not turn on command-line editing.</p>
</dd>
<dt><code>--ess</code></dt>
<dd>
<p>(Windows only) Set <code>Rterm</code> up for use by <code>R-inferior-mode</code> in ESS, including asserting interactive use (without the command-line editor) and no buffering of <code>stdout</code>.</p>
</dd>
<dt><code>--verbose</code></dt>
<dd>
<p>Print more information about progress, and in particular set R’s option <code>verbose</code> to <code>TRUE</code>. R code uses this option to control the printing of diagnostic messages.</p>
</dd>
</dl>
<p><var>--debugger=``name</var><br>
<var>-d ``name</var></p>
<p>: (UNIX only) Run R through debugger <var>name</var>. For most debuggers (the exceptions are <code>valgrind</code> and recent versions of <code>gdb</code>), further command line options are disregarded, and should instead be given when starting the R executable from inside the debugger.</p>
<p><var>--gui=``type</var><br>
<var>-g ``type</var></p>
<p>: (UNIX only) Use <var>type</var> as graphical user interface (note that this also includes interactive graphics). Currently, possible values for <var>type</var> are ‘<code>X11</code>’ (the default) and, provided that ‘<code>Tcl/Tk</code>’ support is available, ‘<code>Tk</code>’. (For back-compatibility, ‘<code>x11</code>’ and ‘<code>tk</code>’ are accepted.)</p>
<dl>
<dt><var>--arch=``name</var></dt>
<dd>
<p>(UNIX only) Run the specified sub-architecture.</p>
</dd>
<dt><code>--args</code></dt>
<dd>
<p>This flag does nothing except cause the rest of the command line to be skipped: this can be useful to retrieve values from it with <code>commandArgs(TRUE)</code>.</p>
</dd>
</dl>
<p>Note that input and output can be redirected in the usual way (using ‘<code>&lt;</code>’ and ‘<code>&gt;</code>’), but the line length limit of 4095 bytes still applies. Warning and error messages are sent to the error channel (<code>stderr</code>).</p>
<p>The command <code>R CMD</code> allows the invocation of various tools which are useful in conjunction with R, but not intended to be called “directly”. The general form is</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb252-1"><a href="#cb252-1"></a><span class="ex">R</span> CMD command args</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <var>command</var> is the name of the tool and <var>args</var> the arguments passed on to it.</p>
<p>Currently, the following tools are available.</p>
<dl>
<dt><code>BATCH</code></dt>
<dd>
<p>Run R in batch mode. Runs <code>R --restore --save</code> with possibly further options (see <code>?BATCH</code>).</p>
</dd>
<dt><code>COMPILE</code></dt>
<dd>
<p>(UNIX only) Compile C, C++, Fortran … files for use with R.</p>
</dd>
<dt><code>SHLIB</code></dt>
<dd>
<p>Build shared library for dynamic loading.</p>
</dd>
<dt><code>INSTALL</code></dt>
<dd>
<p>Install add-on packages.</p>
</dd>
<dt><code>REMOVE</code></dt>
<dd>
<p>Remove add-on packages.</p>
</dd>
<dt><code>build</code></dt>
<dd>
<p>Build (that is, package) add-on packages.</p>
</dd>
<dt><code>check</code></dt>
<dd>
<p>Check add-on packages.</p>
</dd>
<dt><code>LINK</code></dt>
<dd>
<p>(UNIX only) Front-end for creating executable programs.</p>
</dd>
<dt><code>Rprof</code></dt>
<dd>
<p>Post-process R profiling files.</p>
</dd>
</dl>
<p><code>Rdconv</code><br>
<code>Rd2txt</code></p>
<p>: Convert Rd format to various other formats, including HTML, LaTeX, plain text, and extracting the examples. <code>Rd2txt</code> can be used as shorthand for <code>Rd2conv -t txt</code>.</p>
<dl>
<dt><code>Rd2pdf</code></dt>
<dd>
<p>Convert Rd format to PDF.</p>
</dd>
<dt><code>Stangle</code></dt>
<dd>
<p>Extract S/R code from Sweave or other vignette documentation</p>
</dd>
<dt><code>Sweave</code></dt>
<dd>
<p>Process Sweave or other vignette documentation</p>
</dd>
<dt><code>Rdiff</code></dt>
<dd>
<p>Diff R output ignoring headers etc</p>
</dd>
<dt><code>config</code></dt>
<dd>
<p>Obtain configuration information</p>
</dd>
<dt><code>javareconf</code></dt>
<dd>
<p>(Unix only) Update the Java configuration variables</p>
</dd>
<dt><code>rtags</code></dt>
<dd>
<p>(Unix only) Create Emacs-style tag files from C, R, and Rd files</p>
</dd>
<dt><code>open</code></dt>
<dd>
<p>(Windows only) Open a file via Windows’ file associations</p>
</dd>
<dt><code>texify</code></dt>
<dd>
<p>(Windows only) Process (La)TeX files with R’s style files</p>
</dd>
</dl>
<p>Use</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb253-1"><a href="#cb253-1"></a><span class="ex">R</span> CMD command <span class="at">--help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to obtain usage information for each of the tools accessible via the <code>R CMD</code> interface.</p>
<p>In addition, you can use options <code>--arch=</code>, <code>--no-environ</code>, <code>--no-init-file</code>, <code>--no-site-file</code> and <code>--vanilla</code> between <code>R</code> and <code>CMD</code>: these affect any R processes run by the tools. (Here <code>--vanilla</code> is equivalent to <code>--no-environ --no-site-file --no-init-file</code>.) However, note that <code>R CMD</code> does not of itself use any R startup files (in particular, neither user nor site <code>Renviron</code> files), and all of the R processes run by these tools (except <code>BATCH</code>) use <code>--no-restore</code>. Most use <code>--vanilla</code> and so invoke no R startup files: the current exceptions are <code>INSTALL</code>, <code>REMOVE</code>, <code>Sweave</code> and <code>SHLIB</code> (which uses <code>--no-site-file --no-init-file</code>).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb254-1"><a href="#cb254-1"></a><span class="ex">R</span> CMD cmd args</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>for any other executable <var>cmd</var> on the path or given by an absolute filepath: this is useful to have the same environment as R or the specific commands run under, for example to run <code>ldd</code> or <code>pdflatex</code>. Under Windows <var>cmd</var> can be an executable or a batch file, or if it has extension <code>.sh</code> or <code>.pl</code> the appropriate interpreter (if available) is called to run it.</p>
</section>
<section id="sec-b.2-invoking-r-under-windows" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="sec-b.2-invoking-r-under-windows"><span class="header-section-number">14.6</span> B.2 Invoking R under Windows</h2>
<p>There are two ways to run R under Windows. Within a terminal window (e.g.&nbsp;<code>cmd.exe</code> or a more capable shell), the methods described in the previous section may be used, invoking by <code>R.exe</code> or more directly by <code>Rterm.exe</code>. For interactive use, there is a console-based GUI (<code>Rgui.exe</code>).</p>
<p>The startup procedure under Windows is very similar to that under UNIX, but references to the ‘home directory’ need to be clarified, as this is not always defined on Windows. If the environment variable <code>R_USER</code> is defined, that gives the home directory. Next, if the environment variable <code>HOME</code> is defined, that gives the home directory. After those two user-controllable settings, R tries to find system defined home directories. It first tries to use the Windows "personal" directory (typically <code>My Documents</code> in recent versions of Windows). If that fails, and environment variables <code>HOMEDRIVE</code> and <code>HOMEPATH</code> are defined (and they normally are) these define the home directory. Failing all those, the home directory is taken to be the starting directory.</p>
<p>You need to ensure that either the environment variables <code>TMPDIR</code>, <code>TMP</code> and <code>TEMP</code> are either unset or one of them points to a valid place to create temporary files and directories.</p>
<p>Environment variables can be supplied as ‘<var>name</var><var>=``value</var>’ pairs on the command line.</p>
<p>If there is an argument ending <code>.RData</code> (in any case) it is interpreted as the path to the workspace to be restored: it implies <code>--restore</code> and sets the working directory to the parent of the named file. (This mechanism is used for drag-and-drop and file association with <code>RGui.exe</code>, but also works for <code>Rterm.exe</code>. If the named file does not exist it sets the working directory if the parent directory exists.)</p>
<p>The following additional command-line options are available when invoking <code>RGui.exe</code>.</p>
<p><code>--mdi</code><br>
<code>--sdi</code><br>
<code>--no-mdi</code></p>
<p>: Control whether <code>Rgui</code> will operate as an MDI program (with multiple child windows within one main window) or an SDI application (with multiple top-level windows for the console, graphics and pager). The command-line setting overrides the setting in the user’s <code>Rconsole</code> file.</p>
<dl>
<dt><code>--debug</code></dt>
<dd>
<p>Enable the “Break to debugger” menu item in <code>Rgui</code>, and trigger a break to the debugger during command line processing.</p>
</dd>
</dl>
<p>Under Windows with <code>R CMD</code> you may also specify your own <code>.bat</code>, <code>.exe</code>, <code>.sh</code> or <code>.pl</code> file. It will be run under the appropriate interpreter (Perl for <code>.pl</code>) with several environment variables set appropriately, including <code>R_HOME</code>, <code>R_OSTYPE</code>, <code>PATH</code>, <code>BSTINPUTS</code> and <code>TEXINPUTS</code>. For example, if you already have <code>latex.exe</code> on your path, then</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb255-1"><a href="#cb255-1"></a><span class="ex">R</span> CMD latex.exe mydoc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will run LaTeX on <code>mydoc.tex</code>, with the path to R’s <code>share/texmf</code> macros appended to <code>TEXINPUTS</code>. (Unfortunately, this does not help with the MiKTeX build of LaTeX, but <code>R CMD texify mydoc</code> will work in that case.)</p>
</section>
<section id="sec-b.3-invoking-r-under-macos" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="sec-b.3-invoking-r-under-macos"><span class="header-section-number">14.7</span> B.3 Invoking R under macOS</h2>
<p>There are two ways to run R under macOS. Within a <code>Terminal.app</code> window by invoking <code>R</code>, the methods described in the first subsection apply. There is also console-based GUI (<code>R.app</code>) that by default is installed in the <code>Applications</code> folder on your system. It is a standard double-clickable macOS application.</p>
<p>The startup procedure under macOS is very similar to that under UNIX, but <code>R.app</code> does not make use of command-line arguments. The ‘home directory’ is the one inside the R.framework, but the startup and current working directory are set as the user’s home directory unless a different startup directory is given in the Preferences window accessible from within the GUI.</p>
</section>
<section id="sec-b.4-scripting-with-r" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="sec-b.4-scripting-with-r"><span class="header-section-number">14.8</span> B.4 Scripting with R</h2>
<p>If you just want to run a file <code>foo.R</code> of R commands, the recommended way is to use <code>R CMD BATCH foo.R</code>. If you want to run this in the background or as a batch job use OS-specific facilities to do so: for example in most shells on Unix-alike OSes <code>R CMD BATCH foo.R &amp;</code> runs a background job.</p>
<p>You can pass parameters to scripts via additional arguments on the command line: for example (where the exact quoting needed will depend on the shell in use)</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb256-1"><a href="#cb256-1"></a><span class="ex">R</span> CMD BATCH <span class="st">"--args arg1 arg2"</span> foo.R <span class="kw">&amp;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will pass arguments to a script which can be retrieved as a character vector by</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a>args <span class="ot">&lt;-</span> <span class="fu">commandArgs</span>(<span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is made simpler by the alternative front-end <code>Rscript</code>, which can be invoked by</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1"></a>Rscript foo.R arg1 arg2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and this can also be used to write executable script files like (at least on Unix-alikes, and in some Windows shells)</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a><span class="co">#! /path/to/Rscript</span></span>
<span id="cb259-2"><a href="#cb259-2"></a>args <span class="ot">&lt;-</span> <span class="fu">commandArgs</span>(<span class="cn">TRUE</span>)</span>
<span id="cb259-3"><a href="#cb259-3"></a>...</span>
<span id="cb259-4"><a href="#cb259-4"></a><span class="fu">q</span>(<span class="at">status=</span><span class="sc">&lt;</span>exit status code<span class="sc">&gt;</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If this is entered into a text file <code>runfoo</code> and this is made executable (by <code>chmod 755 runfoo</code>), it can be invoked for different arguments by</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1"></a>runfoo arg1 arg2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For further options see <code>help("Rscript")</code>. This writes R output to <code>stdout</code> and <code>stderr</code>, and this can be redirected in the usual way for the shell running the command.</p>
<p>If you do not wish to hardcode the path to <code>Rscript</code> but have it in your path (which is normally the case for an installed R except on Windows, but e.g.&nbsp;macOS users may need to add <code>/usr/local/bin</code> to their path), use</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a><span class="co">#! /usr/bin/env Rscript</span></span>
<span id="cb261-2"><a href="#cb261-2"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>At least in Bourne and bash shells, the <code>#!</code> mechanism does <strong>not</strong> allow extra arguments like <code>#! /usr/bin/env Rscript --vanilla</code>.</p>
<p>One thing to consider is what <code>stdin()</code> refers to. It is commonplace to write R scripts with segments like</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1"></a>chem <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="at">n=</span><span class="dv">24</span>)</span>
<span id="cb262-2"><a href="#cb262-2"></a><span class="fl">2.90</span> <span class="fl">3.10</span> <span class="fl">3.40</span> <span class="fl">3.40</span> <span class="fl">3.70</span> <span class="fl">3.70</span> <span class="fl">2.80</span> <span class="fl">2.50</span> <span class="fl">2.40</span> <span class="fl">2.40</span> <span class="fl">2.70</span> <span class="fl">2.20</span></span>
<span id="cb262-3"><a href="#cb262-3"></a><span class="fl">5.28</span> <span class="fl">3.37</span> <span class="fl">3.03</span> <span class="fl">3.03</span> <span class="fl">28.95</span> <span class="fl">3.77</span> <span class="fl">3.40</span> <span class="fl">2.20</span> <span class="fl">3.50</span> <span class="fl">3.60</span> <span class="fl">3.70</span> <span class="fl">3.70</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and <code>stdin()</code> refers to the script file to allow such traditional usage. If you want to refer to the process’s <code>stdin</code>, use <code>"stdin"</code> as a <code>file</code> connection, e.g.&nbsp;<code>scan("stdin", ...)</code>.</p>
<p>Another way to write executable script files (suggested by François Pinard) is to use a <em>here document</em> like</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb263-1"><a href="#cb263-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb263-2"><a href="#cb263-2"></a><span class="ex">[environment</span> variables can be set here]</span>
<span id="cb263-3"><a href="#cb263-3"></a><span class="ex">R</span> <span class="at">--no-echo</span> [other options] <span class="op">&lt;&lt;EOF</span></span>
<span id="cb263-4"><a href="#cb263-4"></a></span>
<span id="cb263-5"><a href="#cb263-5"></a><span class="st">   R program goes here...</span></span>
<span id="cb263-6"><a href="#cb263-6"></a></span>
<span id="cb263-7"><a href="#cb263-7"></a><span class="op">EOF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>but here <code>stdin()</code> refers to the program source and <code>"stdin"</code> will not be usable.</p>
<p>Short scripts can be passed to <code>Rscript</code> on the command-line <em>via</em> the <code>-e</code> flag. (Empty scripts are not accepted.)</p>
<p>Note that on a Unix-alike the input filename (such as <code>foo.R</code>) should not contain spaces nor shell metacharacters.</p>
</section>
</section>
<section id="sec-appendix-a-a-sample-session" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> A sample session</h1>
<p>The following session is intended to introduce to you some features of the R environment by using them. Many features of the system will be unfamiliar and puzzling at first, but this puzzlement will soon disappear.</p>
<dl>
<dt><code>Start R appropriately for your platform (see</code><a href="Invoking-R.html"><code>Invoking R</code></a><code>).</code></dt>
<dd>
<p>The R program begins, with a banner.</p>
<p>(Within R code, the prompt on the left hand side will not be shown to avoid confusion.)</p>
</dd>
<dt><code>help.start()</code></dt>
<dd>
<p>Start the HTML interface to on-line help (using a web browser available at your machine). You should briefly explore the features of this facility with the mouse.</p>
<p>Iconify the help window and move on to the next part.</p>
</dd>
</dl>
<p><code>x &lt;- rnorm(50)</code><br>
<code>y &lt;- rnorm(x)</code></p>
<p>: Generate two pseudo-random normal vectors of <em>x</em>- and <em>y</em>-coordinates.</p>
<dl>
<dt><code>plot(x, y)</code></dt>
<dd>
<p>Plot the points in the plane. A graphics window will appear automatically.</p>
</dd>
<dt><code>ls()</code></dt>
<dd>
<p>See which R objects are now in the R workspace.</p>
</dd>
<dt><code>rm(x, y)</code></dt>
<dd>
<p>Remove objects no longer needed. (Clean up).</p>
</dd>
<dt><code>x &lt;- 1:20</code></dt>
<dd>
<p>Make <em>x = (1, 2, …, 20)</em>.</p>
</dd>
<dt><code>w &lt;- 1 + sqrt(x)/2</code></dt>
<dd>
<p>A ‘weight’ vector of standard deviations.</p>
</dd>
</dl>
<p><code>dummy &lt;- data.frame(x=x, y= x + rnorm(x)*w)</code><br>
<code>dummy</code></p>
<p>: Make a <em>data frame</em> of two columns, <em>x</em> and <em>y</em>, and look at it.</p>
<p><code>fm &lt;- lm(y ~ x, data=dummy)</code><br>
<code>summary(fm)</code></p>
<p>: Fit a simple linear regression and look at the analysis. With <code>y</code> to the left of the tilde, we are modelling <em>y</em> dependent on <em>x</em>.</p>
<p><code>fm1 &lt;- lm(y ~ x, data=dummy, weight=1/w^2)</code><br>
<code>summary(fm1)</code></p>
<p>: Since we know the standard deviations, we can do a weighted regression.</p>
<dl>
<dt><code>attach(dummy)</code></dt>
<dd>
<p>Make the columns in the data frame visible as variables.</p>
</dd>
<dt><code>lrf &lt;- lowess(x, y)</code></dt>
<dd>
<p>Make a nonparametric local regression function.</p>
</dd>
<dt><code>plot(x, y)</code></dt>
<dd>
<p>Standard point plot.</p>
</dd>
<dt><code>lines(x, lrf$y)</code></dt>
<dd>
<p>Add in the local regression.</p>
</dd>
<dt><code>abline(0, 1, lty=3)</code></dt>
<dd>
<p>The true regression line: (intercept 0, slope 1).</p>
</dd>
<dt><code>abline(coef(fm))</code></dt>
<dd>
<p>Unweighted regression line.</p>
</dd>
<dt><code>abline(coef(fm1), col = "red")</code></dt>
<dd>
<p>Weighted regression line.</p>
</dd>
<dt><code>detach()</code></dt>
<dd>
<p>Remove data frame from the search path.</p>
</dd>
</dl>
<p><code>plot(fitted(fm), resid(fm),</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab="Fitted&nbsp;values",</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab="Residuals",</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main="Residuals&nbsp;vs&nbsp;Fitted")</code></p>
<p>: A standard regression diagnostic plot to check for heteroscedasticity. Can you see it?</p>
<dl>
<dt><code>qqnorm(resid(fm), main="Residuals Rankit Plot")</code></dt>
<dd>
<p>A normal scores plot to check for skewness, kurtosis and outliers. (Not very useful here.)</p>
</dd>
<dt><code>rm(fm, fm1, lrf, x, dummy)</code></dt>
<dd>
<p>Clean up again.</p>
</dd>
</dl>
<p>The next section will look at data from the classical experiment of Michelson to measure the speed of light. This dataset is available in the <code>morley</code> object, but we will read it to illustrate the <code>read.table</code> function.</p>
<p><code>filepath &lt;- system.file("data", "morley.tab" , package="datasets")</code><br>
<code>filepath</code></p>
<p>: Get the path to the data file.</p>
<dl>
<dt><code>file.show(filepath)</code></dt>
<dd>
<p>Optional. Look at the file.</p>
</dd>
</dl>
<p><code>mm &lt;- read.table(filepath)</code><br>
<code>mm</code></p>
<p>: Read in the Michelson data as a data frame, and look at it. There are five experiments (column <code>Expt</code>) and each has 20 runs (column <code>Run</code>) and <code>sl</code> is the recorded speed of light, suitably coded.</p>
<p><code>mm$Expt &lt;- factor(mm$Expt)</code><br>
<code>mm$Run &lt;- factor(mm$Run)</code></p>
<p>: Change <code>Expt</code> and <code>Run</code> into factors.</p>
<dl>
<dt><code>attach(mm)</code></dt>
<dd>
<p>Make the data frame visible at position 2 (the default).</p>
</dd>
<dt><code>plot(Expt, Speed, main="Speed of Light Data", xlab="Experiment No.")</code></dt>
<dd>
<p>Compare the five experiments with simple boxplots.</p>
</dd>
</dl>
<p><code>fm &lt;- aov(Speed ~ Run + Expt, data=mm)</code><br>
<code>summary(fm)</code></p>
<p>: Analyze as a randomized block, with ‘runs’ and ‘experiments’ as factors.</p>
<p><code>fm0 &lt;- update(fm, . ~ . - Run)</code><br>
<code>anova(fm0, fm)</code></p>
<p>: Fit the sub-model omitting ‘runs’, and compare using a formal analysis of variance.</p>
<p><code>detach()</code><br>
<code>rm(fm, fm0)</code></p>
<p>: Clean up before moving on.</p>
<p>We now look at some more graphical features: contour and image plots.</p>
<p><code>x &lt;- seq(-pi, pi, len=50)</code><br>
<code>y &lt;- x</code></p>
<p>: <em>x</em> is a vector of 50 equally spaced values in the interval [-pi\, pi]. <em>y</em> is the same.</p>
<dl>
<dt><code>f &lt;- outer(x, y, function(x, y) cos(y)/(1 + x^2))</code></dt>
<dd>
<p><em>f</em> is a square matrix, with rows and columns indexed by <em>x</em> and <em>y</em> respectively, of values of the function cos(y)/(1 + x^2).</p>
</dd>
</dl>
<p><code>oldpar &lt;- par(no.readonly = TRUE)</code><br>
<code>par(pty="s")</code></p>
<p>: Save the plotting parameters and set the plotting region to “square”.</p>
<p><code>contour(x, y, f)</code><br>
<code>contour(x, y, f, nlevels=15, add=TRUE)</code></p>
<p>: Make a contour map of <em>f</em>; add in more lines for more detail.</p>
<dl>
<dt><code>fa &lt;- (f-t(f))/2</code></dt>
<dd>
<p><code>fa</code> is the “asymmetric part” of <em>f</em>. (<code>t()</code> is transpose).</p>
</dd>
<dt><code>contour(x, y, fa, nlevels=15)</code></dt>
<dd>
<p>Make a contour plot, …</p>
</dd>
<dt><code>par(oldpar)</code></dt>
<dd>
<p>… and restore the old graphics parameters.</p>
</dd>
</dl>
<p><code>image(x, y, f)</code><br>
<code>image(x, y, fa)</code></p>
<p>: Make some high density image plots, (of which you can get hardcopies if you wish), …</p>
<dl>
<dt><code>objects(); rm(x, y, f, fa)</code></dt>
<dd>
<p>… and clean up before moving on.</p>
</dd>
</dl>
<p>R can do complex arithmetic, also.</p>
<p><code>th &lt;- seq(-pi, pi, len=100)</code><br>
<code>z &lt;- exp(1i*th)</code></p>
<p>: <code>1i</code> is used for the complex number <em>i</em>.</p>
<p><code>par(pty="s")</code><br>
<code>plot(z, type="l")</code></p>
<p>: Plotting complex arguments means plot imaginary versus real parts. This should be a circle.</p>
<dl>
<dt><code>w &lt;- rnorm(100) + rnorm(100)*1i</code></dt>
<dd>
<p>Suppose we want to sample points within the unit circle. One method would be to take complex numbers with standard normal real and imaginary parts …</p>
</dd>
<dt><code>w &lt;- ifelse(Mod(w) &gt; 1, 1/w, w)</code></dt>
<dd>
<p>… and to map any outside the circle onto their reciprocal.</p>
</dd>
</dl>
<p><code>plot(w, xlim=c(-1,1), ylim=c(-1,1), pch="+",xlab="x", ylab="y")</code><br>
<code>lines(z)</code></p>
<p>: All points are inside the unit circle, but the distribution is not uniform.</p>
<p><code>w &lt;- sqrt(runif(100))*exp(2*pi*runif(100)*1i)</code><br>
<code>plot(w, xlim=c(-1,1), ylim=c(-1,1), pch="+", xlab="x", ylab="y")</code><br>
<code>lines(z)</code></p>
<p>: The second method uses the uniform distribution. The points should now look more evenly spaced over the disc.</p>
<dl>
<dt><code>rm(th, w, z)</code></dt>
<dd>
<p>Clean up again.</p>
</dd>
<dt><code>q()</code></dt>
<dd>
<p>Quit the R program. You will be asked if you want to save the R workspace, and for an exploratory session like this, you probably do not want to save it.</p>
</dd>
</dl>
</section>
<section id="sec-appendix-b-invoking-r" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Invoking R</h1>
<p>Users of R on Windows or macOS should read the OS-specific section first, but command-line use is also supported.</p>
</section>
<section id="sec-appendix-c-the-command-line-editor" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> The command-line editor</h1>
<section id="sec-c.1-preliminaries" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sec-c.1-preliminaries"><span class="header-section-number">17.1</span> Preliminaries</h2>
<p>When the GNU <strong>readline</strong> library is available at the time R is configured for compilation under UNIX, an inbuilt command line editor allowing recall, editing and re-submission of prior commands is used. Note that other versions of <strong>readline</strong> exist and may be used by the inbuilt command line editor: this is most common on macOS. You can find out which version (if any) is available by running <code>extSoftVersion()</code> in an R session.</p>
<p>It can be disabled (useful for usage with ESS <a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a>) using the startup option <code>--no-readline</code>.</p>
<p>Windows versions of R have somewhat simpler command-line editing: see ‘<code>Console</code>’ under the ‘<code>Help</code>’ menu of the GUI, and the file <code>README.Rterm</code> for command-line editing under <code>Rterm.exe</code>.</p>
<p>When using R with GNU<a href="#fn26" class="footnote-ref" id="fnref26" role="doc-noteref"><sup>26</sup></a> <strong>readline</strong> capabilities, the functions described below are available, as well as others (probably) documented in <code>man readline</code> or <code>info readline</code> on your system.</p>
<p>Many of these use either Control or Meta characters. Control characters, such as <kbd>Control-m</kbd>, are obtained by holding the CTRL down while you press the m key, and are written as <kbd>C-m</kbd> below. Meta characters, such as <kbd>Meta-b</kbd>, are typed by holding down META<a href="#fn27" class="footnote-ref" id="fnref27" role="doc-noteref"><sup>27</sup></a> and pressing b, and written as <kbd>M-b</kbd> in the following. If your terminal does not have a META key enabled, you can still type Meta characters using two-character sequences starting with <kbd>ESC</kbd>. Thus, to enter <kbd>M-b</kbd>, you could type ESCb. The <kbd>ESC</kbd> character sequences are also allowed on terminals with real Meta keys. Note that case is significant for Meta characters.</p>
<p>Some but not all versions<a href="#fn28" class="footnote-ref" id="fnref28" role="doc-noteref"><sup>28</sup></a> of <strong>readline</strong> will recognize resizing of the terminal window so this is best avoided.</p>
</section>
<section id="sec-c.2-editing-actions" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sec-c.2-editing-actions"><span class="header-section-number">17.2</span> Editing actions</h2>
<p>The R program keeps a history of the command lines you type, including the erroneous lines, and commands in your history may be recalled, changed if necessary, and re-submitted as new commands. In Emacs-style command-line editing any straight typing you do while in this editing phase causes the characters to be inserted in the command you are editing, displacing any characters to the right of the cursor. In <em>vi</em> mode character insertion mode is started by <kbd>M-i</kbd> or <kbd>M-a</kbd>, characters are typed and insertion mode is finished by typing a further ESC. (The default is Emacs-style, and only that is described here: for <em>vi</em> mode see the <strong>readline</strong> documentation.)</p>
<p>Pressing the RET command at any time causes the command to be re-submitted.</p>
<p>Other editing actions are summarized in the following table.</p>
</section>
<section id="sec-c.3-command-line-editor-summary" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="sec-c.3-command-line-editor-summary"><span class="header-section-number">17.3</span> Command-line editor summary</h2>
<section id="sec-command-recall-and-vertical-motion" class="level3">
<h3 class="anchored" data-anchor-id="sec-command-recall-and-vertical-motion">Command recall and vertical motion</h3>
<dl>
<dt><kbd>C-p</kbd></dt>
<dd>
<p>Go to the previous command (backwards in the history).</p>
</dd>
<dt><kbd>C-n</kbd></dt>
<dd>
<p>Go to the next command (forwards in the history).</p>
</dd>
<dt><kbd>C-r <var>text</var></kbd></dt>
<dd>
<p>Find the last command with the <var>text</var> string in it. This can be cancelled by <code>C-g</code> (and on some versions of R by <code>C-c</code>).</p>
</dd>
</dl>
<p>On most terminals, you can also use the up and down arrow keys instead of <kbd>C-p</kbd> and <kbd>C-n</kbd>, respectively.</p>
</section>
<section id="sec-horizontal-motion-of-the-cursor" class="level3">
<h3 class="anchored" data-anchor-id="sec-horizontal-motion-of-the-cursor">Horizontal motion of the cursor</h3>
<dl>
<dt><kbd>C-a</kbd></dt>
<dd>
<p>Go to the beginning of the command.</p>
</dd>
<dt><kbd>C-e</kbd></dt>
<dd>
<p>Go to the end of the line.</p>
</dd>
<dt><kbd>M-b</kbd></dt>
<dd>
<p>Go back one word.</p>
</dd>
<dt><kbd>M-f</kbd></dt>
<dd>
<p>Go forward one word.</p>
</dd>
<dt><kbd>C-b</kbd></dt>
<dd>
<p>Go back one character.</p>
</dd>
<dt><kbd>C-f</kbd></dt>
<dd>
<p>Go forward one character.</p>
</dd>
</dl>
<p>On most terminals, you can also use the left and right arrow keys instead of <kbd>C-b</kbd> and <kbd>C-f</kbd>, respectively.</p>
</section>
<section id="sec-editing-and-re-submission" class="level3">
<h3 class="anchored" data-anchor-id="sec-editing-and-re-submission">Editing and re-submission</h3>
<dl>
<dt><kbd><var>text</var></kbd></dt>
<dd>
<p>Insert <var>text</var> at the cursor.</p>
</dd>
<dt><kbd>C-f <var>text</var></kbd></dt>
<dd>
<p>Append <var>text</var> after the cursor.</p>
</dd>
<dt><kbd><span class="key">DEL</span></kbd></dt>
<dd>
<p>Delete the previous character (left of the cursor).</p>
</dd>
<dt><kbd>C-d</kbd></dt>
<dd>
<p>Delete the character under the cursor.</p>
</dd>
<dt><kbd>M-d</kbd></dt>
<dd>
<p>Delete the rest of the word under the cursor, and “save” it.</p>
</dd>
<dt><kbd>C-k</kbd></dt>
<dd>
<p>Delete from cursor to end of command, and “save” it.</p>
</dd>
<dt><kbd>C-y</kbd></dt>
<dd>
<p>Insert (yank) the last “saved” text here.</p>
</dd>
<dt><kbd>C-t</kbd></dt>
<dd>
<p>Transpose the character under the cursor with the next.</p>
</dd>
<dt><kbd>M-l</kbd></dt>
<dd>
<p>Change the rest of the word to lower case.</p>
</dd>
<dt><kbd>M-c</kbd></dt>
<dd>
<p>Change the rest of the word to upper case.</p>
</dd>
<dt><kbd><span class="key">RET</span></kbd></dt>
<dd>
<p>Re-submit the command to R.</p>
</dd>
</dl>
<p>The final RET terminates the command line editing sequence.</p>
<p>The <strong>readline</strong> key bindings can be customized in the usual way <em>via</em> a <code>~/.inputrc</code> file. These customizations can be conditioned on application <code>R</code>, that is by including a section like</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a><span class="sc">$</span><span class="cf">if</span> R</span>
<span id="cb264-2"><a href="#cb264-2"></a>  <span class="st">"\C-xd"</span><span class="sc">:</span> <span class="st">"q('no')</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb264-3"><a href="#cb264-3"></a><span class="sc">$</span>endif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="sec-appendix-d-function-and-variable-index" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Function and variable index</h1>
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Jump to: &nbsp;</td>
<td style="text-align: left;"><a href="#function-and-variable-index_vr_symbol-1" class="summary-letter"><strong>!</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-2" class="summary-letter"><strong>%</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-3" class="summary-letter"><strong>&amp;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-4" class="summary-letter"><strong>*</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-5" class="summary-letter"><strong>+</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-6" class="summary-letter"><strong>-</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-7" class="summary-letter"><strong>.</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-8" class="summary-letter"><strong>/</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-9" class="summary-letter"><strong>:</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-10" class="summary-letter"><strong>&lt;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-11" class="summary-letter"><strong>=</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-12" class="summary-letter"><strong>&gt;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-13" class="summary-letter"><strong>?</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-14" class="summary-letter"><strong>^</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-15" class="summary-letter"><strong>|</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-16" class="summary-letter"><strong>~</strong></a> &nbsp;<br>
<a href="#function-and-variable-index_vr_letter-a" class="summary-letter"><strong>A</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-b" class="summary-letter"><strong>B</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-c" class="summary-letter"><strong>C</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-d" class="summary-letter"><strong>D</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-e" class="summary-letter"><strong>E</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-f" class="summary-letter"><strong>F</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-g" class="summary-letter"><strong>G</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-h" class="summary-letter"><strong>H</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-i" class="summary-letter"><strong>I</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-j" class="summary-letter"><strong>J</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-k" class="summary-letter"><strong>K</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-l" class="summary-letter"><strong>L</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-m" class="summary-letter"><strong>M</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-n" class="summary-letter"><strong>N</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-o" class="summary-letter"><strong>O</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-p" class="summary-letter"><strong>P</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-q" class="summary-letter"><strong>Q</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-r" class="summary-letter"><strong>R</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-s" class="summary-letter"><strong>S</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-t" class="summary-letter"><strong>T</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-u" class="summary-letter"><strong>U</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-v" class="summary-letter"><strong>V</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-w" class="summary-letter"><strong>W</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-x" class="summary-letter"><strong>X</strong></a> &nbsp;</td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: left;">Index Entry</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">Section</td>
</tr>
<tr class="even">
<td>!</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_0021"><code>!</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_0021_003d"><code>!=</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td>%</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Multiplication.html#index-_0025_002a_0025"><code>%*%</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiplication.html">Multiplication</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html#index-_0025o_0025"><code>%o%</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html">The outer product of two arrays</a></td>
</tr>
<tr class="even">
<td>&amp;</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_0026"><code>&amp;</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-_0026_0026"><code>&amp;&amp;</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="odd">
<td>*</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-_002a"><code>*</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>+</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-"><code>+</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>-</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index--"><code>-</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-."><code>.</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Customizing-the-environment.html#index-.first"><code>.First</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Customizing-the-environment.html">Customizing the environment</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Customizing-the-environment.html#index-.last"><code>.Last</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Customizing-the-environment.html">Customizing the environment</a></td>
</tr>
<tr class="odd">
<td>/</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-_002f"><code>/</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>:</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html#index-_003a"><code>:</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html">Generating regular sequences</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Namespaces.html#index-_003a_003a"><code>::</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Namespaces.html">Namespaces</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Namespaces.html#index-_003a_003a_003a"><code>:::</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Namespaces.html">Namespaces</a></td>
</tr>
<tr class="odd">
<td>&lt;</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_003c"><code>&lt;</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Scope.html#index-_003c_003c-"><code>&lt;&lt;-</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Scope.html">Scope</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_003c_003d"><code>&lt;=</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td>=</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_003d_003d"><code>==</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td>&gt;</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_003e"><code>&gt;</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_003e_003d"><code>&gt;=</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="even">
<td>?</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-_003f"><code>?</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-_003f_003f"><code>??</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="odd">
<td>^</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-_005e"><code>^</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>|</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-_007c"><code>|</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-_007c_007c"><code>||</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="even">
<td>~</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Formulae-for-statistical-models.html#index-_007e"><code>~</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Formulae-for-statistical-models.html">Formulae for statistical models</a></td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-abline"><code>abline</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-ace"><code>ace</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-add1"><code>add1</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-anova"><code>anova</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="ANOVA-tables.html#index-anova-1"><code>anova</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="ANOVA-tables.html">ANOVA tables</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html#index-aov"><code>aov</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html">Analysis of variance and model comparison</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html#index-aperm"><code>aperm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html">Generalized transpose of an array</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-array_0028_0029-function.html#index-array"><code>array</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-array_0028_0029-function.html">The array() function</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Making-data-frames.html#index-as.data.frame"><code>as.data.frame</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Making-data-frames.html">Making data frames</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-concatenation-function-c_0028_0029-with-arrays.html#index-as.vector"><code>as.vector</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-concatenation-function-c_0028_0029-with-arrays.html">The concatenation function c() with arrays</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="attach_0028_0029-and-detach_0028_0029.html#index-attach"><code>attach</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="attach_0028_0029-and-detach_0028_0029.html">attach() and detach()</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html#index-attr"><code>attr</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html">Getting and setting attributes</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html#index-attr-1"><code>attr</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html">Getting and setting attributes</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html#index-attributes"><code>attributes</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html">Getting and setting attributes</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html#index-attributes-1"><code>attributes</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-and-setting-attributes.html">Getting and setting attributes</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-avas"><code>avas</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-axis"><code>axis</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-boxplot"><code>boxplot</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-break"><code>break</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-bruto"><code>bruto</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html#index-c"><code>c</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html">Vectors and assignment</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Character-vectors.html#index-c-1"><code>c</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Character-vectors.html">Character vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-concatenation-function-c_0028_0029-with-arrays.html#index-c-2"><code>c</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-concatenation-function-c_0028_0029-with-arrays.html">The concatenation function c() with arrays</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Concatenating-lists.html#index-c-3"><code>c</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Concatenating-lists.html">Concatenating lists</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Contrasts.html#index-c"><code>C</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contrasts.html">Contrasts</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Forming-partitioned-matrices.html#index-cbind"><code>cbind</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Forming-partitioned-matrices.html">Forming partitioned matrices</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-coef"><code>coef</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-coefficients"><code>coefficients</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-contour"><code>contour</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Contrasts.html#index-contrasts"><code>contrasts</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contrasts.html">Contrasts</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Displaying-multivariate-data.html#index-coplot"><code>coplot</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Displaying-multivariate-data.html">Displaying multivariate data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-cos"><code>cos</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Index-matrices.html#index-crossprod"><code>crossprod</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Index-matrices.html">Index matrices</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Multiplication.html#index-crossprod-1"><code>crossprod</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiplication.html">Multiplication</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html#index-cut"><code>cut</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html">Frequency tables from factors</a></td>
</tr>
<tr class="even">
<td>D</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Accessing-builtin-datasets.html#index-data"><code>data</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Accessing-builtin-datasets.html">Accessing builtin datasets</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Making-data-frames.html#index-data.frame"><code>data.frame</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Making-data-frames.html">Making data frames</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-density"><code>density</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html#index-det"><code>det</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html">Singular value decomposition and determinants</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="attach_0028_0029-and-detach_0028_0029.html#index-detach"><code>detach</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="attach_0028_0029-and-detach_0028_0029.html">attach() and detach()</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html#index-determinant"><code>determinant</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html">Singular value decomposition and determinants</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html#index-dev.list"><code>dev.list</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html">Multiple graphics devices</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html#index-dev.next"><code>dev.next</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html">Multiple graphics devices</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html#index-dev.off"><code>dev.off</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html">Multiple graphics devices</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html#index-dev.prev"><code>dev.prev</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html">Multiple graphics devices</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html#index-dev.set"><code>dev.set</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiple-graphics-devices.html">Multiple graphics devices</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-deviance"><code>deviance</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Multiplication.html#index-diag"><code>diag</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiplication.html">Multiplication</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Arrays.html#index-dim"><code>dim</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Arrays.html">Arrays</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-dotchart"><code>dotchart</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-drop1"><code>drop1</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="odd">
<td>E</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-ecdf"><code>ecdf</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Editing-data.html#index-edit"><code>edit</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Editing-data.html">Editing data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Eigenvalues-and-eigenvectors.html#index-eigen"><code>eigen</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Eigenvalues-and-eigenvectors.html">Eigenvalues and eigenvectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-else"><code>else</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html#index-error"><code>Error</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html">Analysis of variance and model comparison</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-example"><code>example</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-exp"><code>exp</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td>F</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-f"><code>F</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Factors.html#index-factor"><code>factor</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-false"><code>FALSE</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-fivenum"><code>fivenum</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-for"><code>for</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-formula"><code>formula</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Writing-your-own-functions.html#index-function"><code>function</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-writing-your-own-functions">Section&nbsp;10</a></td>
</tr>
<tr class="odd">
<td>G</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-getanywhere"><code>getAnywhere</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-gets3method"><code>getS3method</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-glm_0028_0029-function.html#index-glm"><code>glm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-glm_0028_0029-function.html">The glm() function</a></td>
</tr>
<tr class="odd">
<td>H</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-help"><code>help</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-help-1"><code>help</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-help.search"><code>help.search</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Getting-help.html#index-help.start"><code>help.start</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Getting-help.html">Getting help</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-hist"><code>hist</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-hist-1"><code>hist</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="even">
<td>I</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Interacting-with-graphics.html#index-identify"><code>identify</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Interacting-with-graphics.html">Interacting with graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-if"><code>if</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-if-1"><code>if</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Conditional-execution.html#index-ifelse"><code>ifelse</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Conditional-execution.html">Conditional execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-image"><code>image</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Missing-values.html#index-is.na"><code>is.na</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Missing-values.html">Missing values</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Missing-values.html#index-is.nan"><code>is.nan</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Missing-values.html">Missing values</a></td>
</tr>
<tr class="even">
<td>J</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-jpeg"><code>jpeg</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="even">
<td>K</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-ks.test"><code>ks.test</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td>L</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-legend"><code>legend</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-length"><code>length</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-intrinsic-attributes-mode-and-length.html#index-length-1"><code>length</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-intrinsic-attributes-mode-and-length.html">The intrinsic attributes mode and length</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Factors.html#index-levels"><code>levels</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-lines"><code>lines</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Lists.html#index-list"><code>list</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-lists">Section&nbsp;6.1</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Linear-models.html#index-lm"><code>lm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Linear-models.html">Linear models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-lme"><code>lme</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Interacting-with-graphics.html#index-locator"><code>locator</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Interacting-with-graphics.html">Interacting with graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-loess"><code>loess</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-loess-1"><code>loess</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-log"><code>log</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-lqs"><code>lqs</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html#index-lsfit"><code>lsfit</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html">Least squares fitting and the QR decomposition</a></td>
</tr>
<tr class="odd">
<td>M</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-mars"><code>mars</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-max"><code>max</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-mean"><code>mean</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-methods"><code>methods</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-min"><code>min</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-intrinsic-attributes-mode-and-length.html#index-mode"><code>mode</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-intrinsic-attributes-mode-and-length.html">The intrinsic attributes mode and length</a></td>
</tr>
<tr class="even">
<td>N</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Missing-values.html#index-na"><code>NA</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Missing-values.html">Missing values</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Missing-values.html#index-nan"><code>NaN</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Missing-values.html">Missing values</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Matrix-facilities.html#index-ncol"><code>ncol</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Matrix-facilities.html">Matrix facilities</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-next"><code>next</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html#index-nlm"><code>nlm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html">Nonlinear least squares and maximum likelihood models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Least-squares.html#index-nlm-1"><code>nlm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Least-squares.html">Least squares</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Maximum-likelihood.html#index-nlm-2"><code>nlm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Maximum-likelihood.html">Maximum likelihood</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-nlme"><code>nlme</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html#index-nlminb"><code>nlminb</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html">Nonlinear least squares and maximum likelihood models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Matrix-facilities.html#index-nrow"><code>nrow</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Matrix-facilities.html">Matrix facilities</a></td>
</tr>
<tr class="odd">
<td>O</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html#index-optim"><code>optim</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html">Nonlinear least squares and maximum likelihood models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-order"><code>order</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Ordered-factors.html#index-ordered"><code>ordered</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Ordered-factors.html">Ordered factors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Ordered-factors.html#index-ordered-1"><code>ordered</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Ordered-factors.html">Ordered factors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html#index-outer"><code>outer</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html">The outer product of two arrays</a></td>
</tr>
<tr class="odd">
<td>P</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Displaying-multivariate-data.html#index-pairs"><code>pairs</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Displaying-multivariate-data.html">Displaying multivariate data</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-par_0028_0029-function.html#index-par"><code>par</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-par_0028_0029-function.html">The par() function</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Character-vectors.html#index-paste"><code>paste</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Character-vectors.html">Character vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-pdf"><code>pdf</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-persp"><code>persp</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-plot"><code>plot</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-plot_0028_0029-function.html#index-plot-1"><code>plot</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-plot_0028_0029-function.html">The plot() function</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-pmax"><code>pmax</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-pmin"><code>pmin</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-png"><code>png</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-points"><code>points</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-polygon"><code>polygon</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-postscript"><code>postscript</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-predict"><code>predict</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-print"><code>print</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-prod"><code>prod</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td>Q</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-qqline"><code>qqline</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-qqline-1"><code>qqline</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-qqnorm"><code>qqnorm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-qqnorm-1"><code>qqnorm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Display-graphics.html#index-qqplot"><code>qqplot</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Display-graphics.html">Display graphics</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html#index-qr"><code>qr</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html">Least squares fitting and the QR decomposition</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-quartz"><code>quartz</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="even">
<td>R</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-range"><code>range</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Forming-partitioned-matrices.html#index-rbind"><code>rbind</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Forming-partitioned-matrices.html">Forming partitioned matrices</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-read.table_0028_0029-function.html#index-read.table"><code>read.table</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-read_002etable_0028_0029-function.html">The read.table() function</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html#index-rep"><code>rep</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html">Generating regular sequences</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-repeat"><code>repeat</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-resid"><code>resid</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-residuals"><code>residuals</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-rlm"><code>rlm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html#index-rm"><code>rm</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html">Data permanency and removing objects</a></td>
</tr>
<tr class="even">
<td>S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-scan_0028_0029-function.html#index-scan"><code>scan</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-scan_0028_0029-function.html">The scan() function</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html#index-sd"><code>sd</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html">The function tapply() and ragged arrays</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Managing-the-search-path.html#index-search"><code>search</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Managing-the-search-path.html">Managing the search path</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html#index-seq"><code>seq</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html">Generating regular sequences</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-shapiro.test"><code>shapiro.test</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-sin"><code>sin</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html#index-sink"><code>sink</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html">Executing commands from or diverting output to a file</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Linear-equations-and-inversion.html#index-solve"><code>solve</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Linear-equations-and-inversion.html">Linear equations and inversion</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-sort"><code>sort</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html#index-source"><code>source</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html">Executing commands from or diverting output to a file</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-split"><code>split</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-sqrt"><code>sqrt</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-stem"><code>stem</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-step"><code>step</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-step-1"><code>step</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-sum"><code>sum</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-summary"><code>summary</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-summary-1"><code>summary</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html#index-svd"><code>svd</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html">Singular value decomposition and determinants</a></td>
</tr>
<tr class="even">
<td>T</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-t"><code>T</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html#index-t"><code>t</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html">Generalized transpose of an array</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-t.test"><code>t.test</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Index-matrices.html#index-table"><code>table</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Index-matrices.html">Index matrices</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html#index-table-1"><code>table</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html">Frequency tables from factors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-tan"><code>tan</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html#index-tapply"><code>tapply</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html">The function tapply() and ragged arrays</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-text"><code>text</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Low-level-plotting-commands.html#index-title"><code>title</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Low_002dlevel-plotting-commands.html">Low-level plotting commands</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-tree"><code>tree</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Logical-vectors.html#index-true"><code>TRUE</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Logical-vectors.html">Logical vectors</a></td>
</tr>
<tr class="even">
<td>U</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-class-of-an-object.html#index-unclass"><code>unclass</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-class-of-an-object.html">The class of an object</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-update"><code>update</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="odd">
<td>V</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-var"><code>var</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html#index-var-1"><code>var</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-function-tapply_0028_0029-and-ragged-arrays.html">The function tapply() and ragged arrays</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-var.test"><code>var.test</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html#index-vcov"><code>vcov</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generic-functions-for-extracting-model-information.html">Generic functions for extracting model information</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html#index-vector"><code>vector</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html">Vectors and assignment</a></td>
</tr>
<tr class="odd">
<td>W</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Repetitive-execution.html#index-while"><code>while</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Repetitive-execution.html">Repetitive execution</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-wilcox.test"><code>wilcox.test</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-windows"><code>windows</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="odd">
<td>X</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-x11"><code>X11</code></a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Jump to: &nbsp;</td>
<td style="text-align: left;"><a href="#function-and-variable-index_vr_symbol-1" class="summary-letter"><strong>!</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-2" class="summary-letter"><strong>%</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-3" class="summary-letter"><strong>&amp;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-4" class="summary-letter"><strong>*</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-5" class="summary-letter"><strong>+</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-6" class="summary-letter"><strong>-</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-7" class="summary-letter"><strong>.</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-8" class="summary-letter"><strong>/</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-9" class="summary-letter"><strong>:</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-10" class="summary-letter"><strong>&lt;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-11" class="summary-letter"><strong>=</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-12" class="summary-letter"><strong>&gt;</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-13" class="summary-letter"><strong>?</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-14" class="summary-letter"><strong>^</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-15" class="summary-letter"><strong>|</strong></a> &nbsp; <a href="#function-and-variable-index_vr_symbol-16" class="summary-letter"><strong>~</strong></a> &nbsp;<br>
<a href="#function-and-variable-index_vr_letter-a" class="summary-letter"><strong>A</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-b" class="summary-letter"><strong>B</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-c" class="summary-letter"><strong>C</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-d" class="summary-letter"><strong>D</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-e" class="summary-letter"><strong>E</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-f" class="summary-letter"><strong>F</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-g" class="summary-letter"><strong>G</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-h" class="summary-letter"><strong>H</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-i" class="summary-letter"><strong>I</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-j" class="summary-letter"><strong>J</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-k" class="summary-letter"><strong>K</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-l" class="summary-letter"><strong>L</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-m" class="summary-letter"><strong>M</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-n" class="summary-letter"><strong>N</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-o" class="summary-letter"><strong>O</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-p" class="summary-letter"><strong>P</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-q" class="summary-letter"><strong>Q</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-r" class="summary-letter"><strong>R</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-s" class="summary-letter"><strong>S</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-t" class="summary-letter"><strong>T</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-u" class="summary-letter"><strong>U</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-v" class="summary-letter"><strong>V</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-w" class="summary-letter"><strong>W</strong></a> &nbsp; <a href="#function-and-variable-index_vr_letter-x" class="summary-letter"><strong>X</strong></a> &nbsp;</td>
</tr>
</tbody>
</table>
</section>
<section id="sec-appendix-e-concept-index" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Concept index</h1>
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Jump to: &nbsp;</td>
<td style="text-align: left;"><a href="#concept-index_cp_letter-a" class="summary-letter"><strong>A</strong></a> &nbsp; <a href="#concept-index_cp_letter-b" class="summary-letter"><strong>B</strong></a> &nbsp; <a href="#concept-index_cp_letter-c" class="summary-letter"><strong>C</strong></a> &nbsp; <a href="#concept-index_cp_letter-d" class="summary-letter"><strong>D</strong></a> &nbsp; <a href="#concept-index_cp_letter-e" class="summary-letter"><strong>E</strong></a> &nbsp; <a href="#concept-index_cp_letter-f" class="summary-letter"><strong>F</strong></a> &nbsp; <a href="#concept-index_cp_letter-g" class="summary-letter"><strong>G</strong></a> &nbsp; <a href="#concept-index_cp_letter-i" class="summary-letter"><strong>I</strong></a> &nbsp; <a href="#concept-index_cp_letter-k" class="summary-letter"><strong>K</strong></a> &nbsp; <a href="#concept-index_cp_letter-l" class="summary-letter"><strong>L</strong></a> &nbsp; <a href="#concept-index_cp_letter-m" class="summary-letter"><strong>M</strong></a> &nbsp; <a href="#concept-index_cp_letter-n" class="summary-letter"><strong>N</strong></a> &nbsp; <a href="#concept-index_cp_letter-o" class="summary-letter"><strong>O</strong></a> &nbsp; <a href="#concept-index_cp_letter-p" class="summary-letter"><strong>P</strong></a> &nbsp; <a href="#concept-index_cp_letter-q" class="summary-letter"><strong>Q</strong></a> &nbsp; <a href="#concept-index_cp_letter-r" class="summary-letter"><strong>R</strong></a> &nbsp; <a href="#concept-index_cp_letter-s" class="summary-letter"><strong>S</strong></a> &nbsp; <a href="#concept-index_cp_letter-t" class="summary-letter"><strong>T</strong></a> &nbsp; <a href="#concept-index_cp_letter-u" class="summary-letter"><strong>U</strong></a> &nbsp; <a href="#concept-index_cp_letter-v" class="summary-letter"><strong>V</strong></a> &nbsp; <a href="#concept-index_cp_letter-w" class="summary-letter"><strong>W</strong></a> &nbsp;</td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: left;">Index Entry</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">Section</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Accessing-builtin-datasets.html#index-accessing-builtin-datasets">Accessing builtin datasets</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Accessing-builtin-datasets.html">Accessing builtin datasets</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-additive-models">Additive models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html#index-analysis-of-variance">Analysis of variance</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Analysis-of-variance-and-model-comparison.html">Analysis of variance and model comparison</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-arithmetic-functions-and-operators">Arithmetic functions and operators</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Arrays.html#index-arrays">Arrays</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Arrays.html">Arrays</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html#index-assignment">Assignment</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vectors-and-assignment.html">Vectors and assignment</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Objects.html#index-attributes">Attributes</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Objects.html">Objects</a></td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Defining-new-binary-operators.html#index-binary-operators">Binary operators</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Defining-new-binary-operators.html">Defining new binary operators</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-box-plots">Box plots</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Character-vectors.html#index-character-vectors">Character vectors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Character-vectors.html">Character vectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-class-of-an-object.html#index-classes">Classes</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-class-of-an-object.html">The class of an object</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-classes-1">Classes</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Concatenating-lists.html#index-concatenating-lists">Concatenating lists</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Concatenating-lists.html">Concatenating lists</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Contrasts.html#index-contrasts">Contrasts</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contrasts.html">Contrasts</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Control-statements.html#index-control-statements">Control statements</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Control-statements.html">Control statements</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Contributed-packages-and-CRAN.html#index-cran">CRAN</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contributed-packages-and-CRAN.html">Contributed packages and CRAN</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Customizing-the-environment.html#index-customizing-the-environment">Customizing the environment</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Customizing-the-environment.html">Customizing the environment</a></td>
</tr>
<tr class="even">
<td>D</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Data-frames.html#index-data-frames">Data frames</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-data-frames">Section&nbsp;6.3</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Named-arguments-and-defaults.html#index-default-values">Default values</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Named-arguments-and-defaults.html">Named arguments and defaults</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-density-estimation">Density estimation</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html#index-determinants">Determinants</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html">Singular value decomposition and determinants</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html#index-diverting-input-and-output">Diverting input and output</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Executing-commands-from-or-diverting-output-to-a-file.html">Executing commands from or diverting output to a file</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Dynamic-graphics.html#index-dynamic-graphics">Dynamic graphics</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Dynamic-graphics.html">Dynamic graphics</a></td>
</tr>
<tr class="odd">
<td>E</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Eigenvalues-and-eigenvectors.html#index-eigenvalues-and-eigenvectors">Eigenvalues and eigenvectors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Eigenvalues-and-eigenvectors.html">Eigenvalues and eigenvectors</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-empirical-cdfs">Empirical CDFs</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td>F</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Factors.html#index-factors">Factors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Contrasts.html#index-factors-1">Factors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contrasts.html">Contrasts</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Families.html#index-families">Families</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Families.html">Families</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Formulae-for-statistical-models.html#index-formulae">Formulae</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Formulae-for-statistical-models.html">Formulae for statistical models</a></td>
</tr>
<tr class="odd">
<td>G</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generalized-linear-models.html#index-generalized-linear-models">Generalized linear models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generalized-linear-models.html">Generalized linear models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html#index-generalized-transpose-of-an-array">Generalized transpose of an array</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generalized-transpose-of-an-array.html">Generalized transpose of an array</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-generic-functions">Generic functions</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Device-drivers.html#index-graphics-device-drivers">Graphics device drivers</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Device-drivers.html">Device drivers</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-par_0028_0029-function.html#index-graphics-parameters">Graphics parameters</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-par_0028_0029-function.html">The par() function</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Grouped-expressions.html#index-grouped-expressions">Grouped expressions</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Grouped-expressions.html">Grouped expressions</a></td>
</tr>
<tr class="even">
<td>I</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Array-indexing.html#index-indexing-of-and-by-arrays">Indexing of and by arrays</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Array-indexing.html">Array indexing</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Index-vectors.html#index-indexing-vectors">Indexing vectors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Index-vectors.html">Index vectors</a></td>
</tr>
<tr class="odd">
<td>K</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-kolmogorov-smirnov-test">Kolmogorov-Smirnov test</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="odd">
<td>L</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html#index-least-squares-fitting">Least squares fitting</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html">Least squares fitting and the QR decomposition</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Linear-equations-and-inversion.html#index-linear-equations">Linear equations</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Linear-equations-and-inversion.html">Linear equations and inversion</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Linear-models.html#index-linear-models">Linear models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Linear-models.html">Linear models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Lists.html#index-lists">Lists</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-lists">Section&nbsp;6.1</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-local-approximating-regressions">Local approximating regressions</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Loops-and-conditional-execution.html#index-loops-and-conditional-execution">Loops and conditional execution</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Loops-and-conditional-execution.html">Loops and conditional execution</a></td>
</tr>
<tr class="even">
<td>M</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Arrays.html#index-matrices">Matrices</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Arrays.html">Arrays</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Multiplication.html#index-matrix-multiplication">Matrix multiplication</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Multiplication.html">Multiplication</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Maximum-likelihood.html#index-maximum-likelihood">Maximum likelihood</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Maximum-likelihood.html">Maximum likelihood</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Missing-values.html#index-missing-values">Missing values</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Missing-values.html">Missing values</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-mixed-models">Mixed models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="even">
<td>N</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Named-arguments-and-defaults.html#index-named-arguments">Named arguments</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Named-arguments-and-defaults.html">Named arguments and defaults</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Namespaces.html#index-namespace">Namespace</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Namespaces.html">Namespaces</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html#index-nonlinear-least-squares">Nonlinear least squares</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Nonlinear-least-squares-and-maximum-likelihood-models.html">Nonlinear least squares and maximum likelihood models</a></td>
</tr>
<tr class="even">
<td>O</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Object-orientation.html#index-object-orientation">Object orientation</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Object-orientation.html">Object orientation</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Objects.html#index-objects">Objects</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Objects.html">Objects</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-one--and-two-sample-tests">One- and two-sample tests</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Factors.html#index-ordered-factors">Ordered factors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Contrasts.html#index-ordered-factors-1">Ordered factors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Contrasts.html">Contrasts</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html#index-outer-products-of-arrays">Outer products of arrays</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-outer-product-of-two-arrays.html">The outer product of two arrays</a></td>
</tr>
<tr class="odd">
<td>P</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="R-and-statistics.html#index-packages">Packages</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="R-and-statistics.html">R and statistics</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Packages.html#index-packages-1">Packages</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-packages">Section&nbsp;13</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Probability-distributions.html#index-probability-distributions">Probability distributions</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Probability-distributions.html">Probability distributions</a></td>
</tr>
<tr class="odd">
<td>Q</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html#index-qr-decomposition">QR decomposition</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Least-squares-fitting-and-the-QR-decomposition.html">Least squares fitting and the QR decomposition</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-quantile-quantile-plots">Quantile-quantile plots</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="even">
<td>R</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Reading-data-from-files.html#index-reading-data-from-files">Reading data from files</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Reading-data-from-files.html">Reading data from files</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Vector-arithmetic.html#index-recycling-rule">Recycling rule</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Vector-arithmetic.html">Vector arithmetic</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="The-recycling-rule.html#index-recycling-rule-1">Recycling rule</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="The-recycling-rule.html">The recycling rule</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html#index-regular-sequences">Regular sequences</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Generating-regular-sequences.html">Generating regular sequences</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html#index-removing-objects">Removing objects</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html">Data permanency and removing objects</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-robust-regression">Robust regression</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td>S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Scope.html#index-scope">Scope</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Scope.html">Scope</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Managing-the-search-path.html#index-search-path">Search path</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Managing-the-search-path.html">Managing the search path</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html#index-shapiro-wilk-test">Shapiro-Wilk test</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Examining-the-distribution-of-a-set-of-data.html">Examining the distribution of a set of data</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html#index-singular-value-decomposition">Singular value decomposition</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Singular-value-decomposition-and-determinants.html">Singular value decomposition and determinants</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Statistical-models-in-R.html#index-statistical-models">Statistical models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Statistical-models-in-R.html">Statistical models in R</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-student_0027s-t-test">Student’s <em>t</em> test</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="even">
<td>T</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html#index-tabulation">Tabulation</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Frequency-tables-from-factors.html">Frequency tables from factors</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Some-non-standard-models.html#index-tree-based-models">Tree-based models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Some-non_002dstandard-models.html">Some non-standard models</a></td>
</tr>
<tr class="odd">
<td>U</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Updating-fitted-models.html#index-updating-fitted-models">Updating fitted models</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Updating-fitted-models.html">Updating fitted models</a></td>
</tr>
<tr class="odd">
<td>V</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Simple-manipulations-numbers-and-vectors.html#index-vectors">Vectors</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Simple-manipulations-numbers-and-vectors.html">Simple manipulations numbers and vectors</a></td>
</tr>
<tr class="odd">
<td>W</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="One--and-two-sample-tests.html#index-wilcoxon-test">Wilcoxon test</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="One_002d-and-two_002dsample-tests.html">One- and two-sample tests</a></td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html#index-workspace">Workspace</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="Data-permanency-and-removing-objects.html">Data permanency and removing objects</a></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><a href="Writing-your-own-functions.html#index-writing-functions">Writing functions</a>:</td>
<td style="text-align: left;">&nbsp;</td>
<td style="text-align: left;"><a href="#sec-writing-your-own-functions">Section&nbsp;10</a></td>
</tr>
</tbody>
</table>
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Jump to: &nbsp;</td>
<td style="text-align: left;"><a href="#concept-index_cp_letter-a" class="summary-letter"><strong>A</strong></a> &nbsp; <a href="#concept-index_cp_letter-b" class="summary-letter"><strong>B</strong></a> &nbsp; <a href="#concept-index_cp_letter-c" class="summary-letter"><strong>C</strong></a> &nbsp; <a href="#concept-index_cp_letter-d" class="summary-letter"><strong>D</strong></a> &nbsp; <a href="#concept-index_cp_letter-e" class="summary-letter"><strong>E</strong></a> &nbsp; <a href="#concept-index_cp_letter-f" class="summary-letter"><strong>F</strong></a> &nbsp; <a href="#concept-index_cp_letter-g" class="summary-letter"><strong>G</strong></a> &nbsp; <a href="#concept-index_cp_letter-i" class="summary-letter"><strong>I</strong></a> &nbsp; <a href="#concept-index_cp_letter-k" class="summary-letter"><strong>K</strong></a> &nbsp; <a href="#concept-index_cp_letter-l" class="summary-letter"><strong>L</strong></a> &nbsp; <a href="#concept-index_cp_letter-m" class="summary-letter"><strong>M</strong></a> &nbsp; <a href="#concept-index_cp_letter-n" class="summary-letter"><strong>N</strong></a> &nbsp; <a href="#concept-index_cp_letter-o" class="summary-letter"><strong>O</strong></a> &nbsp; <a href="#concept-index_cp_letter-p" class="summary-letter"><strong>P</strong></a> &nbsp; <a href="#concept-index_cp_letter-q" class="summary-letter"><strong>Q</strong></a> &nbsp; <a href="#concept-index_cp_letter-r" class="summary-letter"><strong>R</strong></a> &nbsp; <a href="#concept-index_cp_letter-s" class="summary-letter"><strong>S</strong></a> &nbsp; <a href="#concept-index_cp_letter-t" class="summary-letter"><strong>T</strong></a> &nbsp; <a href="#concept-index_cp_letter-u" class="summary-letter"><strong>U</strong></a> &nbsp; <a href="#concept-index_cp_letter-v" class="summary-letter"><strong>V</strong></a> &nbsp; <a href="#concept-index_cp_letter-w" class="summary-letter"><strong>W</strong></a> &nbsp;</td>
</tr>
</tbody>
</table>
</section>
<section id="sec-appendix-f-references" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> References</h1>
<p>D. M. Bates and D. G. Watts (1988), <em>Nonlinear Regression Analysis and Its Applications.</em> John Wiley &amp; Sons, New York.</p>
<p>Richard A. Becker, John M. Chambers and Allan R. Wilks (1988), <em>The New S Language.</em> Chapman &amp; Hall, New York. This book is often called the “<em>Blue Book</em>”.</p>
<p>John M. Chambers and Trevor J. Hastie eds.&nbsp;(1992), <em>Statistical Models in S.</em> Chapman &amp; Hall, New York. This is also called the “<em>White Book</em>”.</p>
<p>John M. Chambers (1998) <em>Programming with Data</em>. Springer, New York. This is also called the “<em>Green Book</em>”.</p>
<p>A. C. Davison and D. V. Hinkley (1997), <em>Bootstrap Methods and Their Applications</em>, Cambridge University Press.</p>
<p>Annette J. Dobson (1990), <em>An Introduction to Generalized Linear Models</em>, Chapman and Hall, London.</p>
<p>Peter McCullagh and John A. Nelder (1989), <em>Generalized Linear Models.</em> Second edition, Chapman and Hall, London.</p>
<p>John A.&nbsp;Rice (1995), <em>Mathematical Statistics and Data Analysis.</em> Second edition. Duxbury Press, Belmont, CA.</p>
<p>S. D. Silvey (1970), <em>Statistical Inference.</em> Penguin, London.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>ACM Software Systems award, 1998: <a href="https://awards.acm.org/award_winners/chambers_6640862.cfm" class="uri">https://awards.acm.org/award_winners/chambers_6640862.cfm</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For portable R code (including that to be used in R packages) only A–Za–z0–9 should be used.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><strong>not</strong> inside strings, nor within the argument list of a function definition<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>some of the consoles will not allow you to enter more, and amongst those which do some will silently discard the excess and some will use it as the start of the next line.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>of unlimited length.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The leading “dot” in this file name makes it <em>invisible</em> in normal file listings in UNIX, and in default GUI file listings on macOS and Windows.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>With other than vector types of argument, such as <code>list</code> mode arguments, the action of <code>c()</code> is rather different. See <a href="Concatenating-lists.html">Concatenating lists</a>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Actually, it is still available as <code>.Last.value</code> before any other statements are executed.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><var>paste(..., collapse=``ss</var><code>)</code> joins the arguments into a single character string putting <var>ss</var> in between, e.g., <code>ss &lt;- "|"</code>. There are more tools for character manipulation, see the help for <code>sub</code> and <code>substring</code>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><em>numeric</em> mode is actually an amalgam of two distinct modes, namely <em>integer</em> and <em>double</em> precision, as explained in the manual.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Note however that <var>length(``object</var><code>)</code> does not always contain intrinsic useful information, e.g., when <var>object</var> is a function.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>In general, coercion from numeric to character and back again will not be exactly reversible, because of roundoff errors in the character representation.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>A different style using ‘formal’ or ‘S4’ classes is provided in package <code>methods</code>.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>Readers should note that there are eight states and territories in Australia, namely the Australian Capital Territory, New South Wales, the Northern Territory, Queensland, South Australia, Tasmania, Victoria and Western Australia.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>Note that <code>tapply()</code> also works in this case when its second argument is not a factor, e.g., <code>tapply(incomes, state)</code>, and this is true for quite a few other functions, since arguments are <em>coerced</em> to factors when necessary (using <code>as.factor()</code>).<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>Note that <code>x %*% x</code> is ambiguous, as it could mean either x’x or x x’, where x is the column form. In such cases the smaller matrix seems implicitly to be the interpretation adopted, so the scalar x’x is in this case the result. The matrix x x’ may be calculated either by <code>cbind(x) %*% x</code> or <code>x %*% rbind(x)</code> since the result of <code>rbind()</code> or <code>cbind()</code> is always a matrix. However, the best way to compute x’x or x x’ is <code>crossprod(x)</code> or <code>x %o% x</code> respectively.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>Even better would be to form a matrix square root B with A = BB’ and find the squared length of the solution of By = x , perhaps using the Cholesky or eigen decomposition of A.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>See the on-line help for <code>autoload</code> for the meaning of the second term.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>Under UNIX, the utilities <code>sed</code> or<code>awk</code> can be used.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>to be discussed later, or use <code>xyplot</code> from package <a href="https://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a>.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>See also the methods described in <a href="Statistical-models-in-R.html">Statistical models in R</a><a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>In some sense this mimics the behavior in <span class="small">S-PLUS</span> since in <span class="small">S-PLUS</span> this operator always creates or assigns to a global variable.<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>So it is hidden under UNIX.<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>Some graphics parameters such as the size of the current device are for information only.<a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn25"><p>The ‘Emacs Speaks Statistics’ package; see the URL <a href="https://ESS.R-project.org/" class="uri">https://ESS.R-project.org/</a><a href="#fnref25" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn26"><p>It is possible to build R using an emulation of GNU <strong>readline</strong>, such as one based on NetBSD’s <strong>editline</strong> (also known as <strong>libedit</strong>), in which case only a subset of the capabilities may be provided.<a href="#fnref26" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn27"><p>On a PC keyboard this is usually the Alt key, occasionally the ‘Windows’ key. On a Mac keyboard normally no meta key is available.<a href="#fnref27" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn28"><p>In particular, not versions 6.3 or later: this is worked around as from R 3.4.0.<a href="#fnref28" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Content 2022 by <a href="https://www.startupengineer.io/authors/schwarz/">Joschka Schwarz</a> <br> All content licensed under a <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Made with and <a href="https://quarto.org/">Quarto</a><br> <a href="https://www.github.com/jwarz/jwarz.github.io">View the source at GitHub</a></div>
  </div>
</footer>



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>